
/* Ammina JS file original /bitrix/js/main/jquery/jquery-1.8.3.min.js */
(function(y,C){function e(e){var n=de[e]={};return ge.each(e.split(ee),function(e,t){n[t]=!0}),n}function c(e,t,n){if(n===C&&e.nodeType===1){var r="data-"+t.replace(me,"-$1").toLowerCase();n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:he.test(n)?ge.parseJSON(n):n}catch(e){}ge.data(e,t,n)}else n=C}return n}function u(e){var t;for(t in e){if(t==="data"&&ge.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function s(){return!1}function n(){return!0}function i(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function t(e,t){do{e=e[t]}while(e&&e.nodeType!==1);return e}function r(e,r,i){r=r||0;if(ge.isFunction(r))return ge.grep(e,function(e,t){var n=!!r.call(e,t,e);return n===i});if(r.nodeType)return ge.grep(e,function(e,t){return e===r===i});if(typeof r=="string"){var t=ge.grep(e,function(e){return e.nodeType===1});if(_e.test(r))return ge.filter(r,t,!i);r=ge.filter(r,t)}return ge.grep(e,function(e,t){return ge.inArray(e,r)>=0===i})}function v(e){var t=We.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function f(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function l(e,t){if(t.nodeType!==1||!ge.hasData(e))return;var n,r,i,o=ge._data(e),a=ge._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;r<i;r++)ge.event.add(t,n,s[n][r])}a.data&&(a.data=ge.extend({},a.data))}function p(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),ge.support.html5Clone&&e.innerHTML&&!ge.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Je.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(ge.expando)}function d(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function b(e){Je.test(e.type)&&(e.defaultChecked=e.checked)}function h(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=yt.length;while(i--){t=yt[i]+n;if(t in e)return t}return r}function x(e,t){return e=t||e,ge.css(e,"display")==="none"||!ge.contains(e.ownerDocument,e)}function o(e,t){var n,r,i=[],o=0,a=e.length;for(;o<a;o++){n=e[o];if(!n.style)continue;i[o]=ge._data(n,"olddisplay"),t?(!i[o]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&x(n)&&(i[o]=ge._data(n,"olddisplay",w(n.nodeName)))):(r=nt(n,"display"),!i[o]&&r!=="none"&&ge._data(n,"olddisplay",r))}for(o=0;o<a;o++){n=e[o];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[o]||"":"none"}return e}function a(e,t,n){var r=ct.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function g(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;i<4;i+=2)n==="margin"&&(o+=ge.css(e,n+mt[i],!0)),r?(n==="content"&&(o-=parseFloat(nt(e,"padding"+mt[i]))||0),n!=="margin"&&(o-=parseFloat(nt(e,"border"+mt[i]+"Width"))||0)):(o+=parseFloat(nt(e,"padding"+mt[i]))||0,n!=="padding"&&(o+=parseFloat(nt(e,"border"+mt[i]+"Width"))||0));return o}function m(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,o=ge.support.boxSizing&&ge.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=nt(e,t);if(r<0||r==null)r=e.style[t];if(ft.test(r))return r;i=o&&(ge.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+g(e,t,n||(o?"border":"content"),i)+"px"}function w(e){if(dt[e])return dt[e];var t=ge("<"+e+">").appendTo(R.body),n=t.css("display");t.remove();if(n==="none"||n===""){rt=R.body.appendChild(rt||ge.extend(R.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!it||!rt.createElement)it=(rt.contentWindow||rt.contentDocument).document,it.write("<!doctype html><html><body>"),it.close();t=it.body.appendChild(it.createElement(e)),n=nt(t,"display"),R.body.removeChild(rt)}return dt[e]=n,n}function T(n,e,r,i){var t;if(ge.isArray(e))ge.each(e,function(e,t){r||xt.test(n)?i(n,t):T(n+"["+(typeof t=="object"?e:"")+"]",t,r,i)});else if(!r&&ge.type(e)==="object")for(t in e)T(n+"["+t+"]",e[t],r,i);else i(n,e)}function N(l){return function(e,t){typeof e!="string"&&(t=e,e="*");var n,r,i,o=e.toLowerCase().split(ee),a=0,s=o.length;if(ge.isFunction(t))for(;a<s;a++)n=o[a],i=/^\+/.test(n),i&&(n=n.substr(1)||"*"),r=l[n]=l[n]||[],r[i?"unshift":"push"](t)}}function k(e,t,n,r,i,o){i=i||t.dataTypes[0],o=o||{},o[i]=!0;var a,s=e[i],l=0,u=s?s.length:0,c=e===_t;for(;l<u&&(c||!a);l++)a=s[l](t,n,r),typeof a=="string"&&(!c||o[a]?a=C:(t.dataTypes.unshift(a),a=k(e,t,n,r,a,o)));return(c||!a)&&!o["*"]&&(a=k(e,t,n,r,"*",o)),a}function E(e,t){var n,r,i=ge.ajaxSettings.flatOptions||{};for(n in t)t[n]!==C&&((i[n]?e:r||(r={}))[n]=t[n]);r&&ge.extend(!0,e,r)}function S(e,t,n){var r,i,o,a,s=e.contents,l=e.dataTypes,u=e.responseFields;for(i in u)i in n&&(t[u[i]]=n[i]);while(l[0]==="*")l.shift(),r===C&&(r=e.mimeType||t.getResponseHeader("content-type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){l.unshift(i);break}if(l[0]in n)o=l[0];else{for(i in n){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),n[o]}function A(e,t){var n,r,i,o,a=e.dataTypes.slice(),s=a[0],l={},u=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(a[1])for(n in e.converters)l[n.toLowerCase()]=e.converters[n];for(;i=a[++u];)if(i!=="*"){if(s!=="*"&&s!==i){n=l[s+" "+i]||l["* "+i];if(!n)for(r in l){o=r.split(" ");if(o[1]===i){n=l[s+" "+o[0]]||l["* "+o[0]];if(n){n===!0?n=l[r]:l[r]!==!0&&(i=o[0],a.splice(u--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(e){return{state:"parsererror",error:n?e:"No conversion from "+s+" to "+i}}}s=i}return{state:"success",data:t}}function j(){try{return new y.XMLHttpRequest}catch(e){}}function D(){try{return new y.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function L(){return setTimeout(function(){Ut=C},0),Ut=ge.now()}function H(o,e){ge.each(e,function(e,t){var n=(Kt[e]||[]).concat(Kt["*"]),r=0,i=n.length;for(;r<i;r++)if(n[r].call(o,e,t))return})}function F(a,e,t){var n,r=0,i=0,o=Qt.length,s=ge.Deferred().always(function(){delete l.elem}),l=function(){var e=Ut||L(),t=Math.max(0,u.startTime+u.duration-e),n=t/u.duration||0,r=1-n,i=0,o=u.tweens.length;for(;i<o;i++)u.tweens[i].run(r);return s.notifyWith(a,[u,r,t]),r<1&&o?t:(s.resolveWith(a,[u]),!1)},u=s.promise({elem:a,props:ge.extend({},e),opts:ge.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:Ut||L(),duration:t.duration,tweens:[],createTween:function(e,t,n){var r=ge.Tween(a,u.opts,e,t,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(r),r},stop:function(e){var t=0,n=e?u.tweens.length:0;for(;t<n;t++)u.tweens[t].run(1);return e?s.resolveWith(a,[u,e]):s.rejectWith(a,[u,e]),this}}),c=u.props;M(c,u.opts.specialEasing);for(;r<o;r++){n=Qt[r].call(u,a,c,u.opts);if(n)return n}return H(u,c),ge.isFunction(u.opts.start)&&u.opts.start.call(a,u),ge.fx.timer(ge.extend(l,{anim:u,queue:u.opts.queue,elem:a})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function M(e,t){var n,r,i,o,a;for(n in e){r=ge.camelCase(n),i=t[r],o=e[n],ge.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=ge.cssHooks[r];if(a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}}function O(t,e,n){var r,i,o,a,s,l,u,c,f,p=this,d=t.style,h={},g=[],m=t.nodeType&&x(t);n.queue||(c=ge._queueHooks(t,"fx"),c.unqueued==null&&(c.unqueued=0,f=c.empty.fire,c.empty.fire=function(){c.unqueued||f()}),c.unqueued++,p.always(function(){p.always(function(){c.unqueued--,ge.queue(t,"fx").length||c.empty.fire()})})),t.nodeType===1&&("height"in e||"width"in e)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],ge.css(t,"display")==="inline"&&ge.css(t,"float")==="none"&&(!ge.support.inlineBlockNeedsLayout||w(t.nodeName)==="inline"?d.display="inline-block":d.zoom=1)),n.overflow&&(d.overflow="hidden",ge.support.shrinkWrapBlocks||p.done(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(r in e){o=e[r];if(Vt.exec(o)){delete e[r],l=l||o==="toggle";if(o===(m?"hide":"show"))continue;g.push(r)}}a=g.length;if(a){s=ge._data(t,"fxshow")||ge._data(t,"fxshow",{}),"hidden"in s&&(m=s.hidden),l&&(s.hidden=!m),m?ge(t).show():p.done(function(){ge(t).hide()}),p.done(function(){var e;ge.removeData(t,"fxshow",!0);for(e in h)ge.style(t,e,h[e])});for(r=0;r<a;r++)i=g[r],u=p.createTween(i,m?s[i]:0),h[i]=s[i]||ge.style(t,i),i in s||(s[i]=u.start,m&&(u.end=u.start,u.start=i==="width"||i==="height"?1:0))}}function _(e,t,n,r,i){return new _.prototype.init(e,t,n,r,i)}function q(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=mt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function B(e){return ge.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var W,P,R=y.document,$=y.location,I=y.navigator,z=y.jQuery,X=y.$,U=Array.prototype.push,Y=Array.prototype.slice,V=Array.prototype.indexOf,J=Object.prototype.toString,G=Object.prototype.hasOwnProperty,Q=String.prototype.trim,ge=function(e,t){return new ge.fn.init(e,t,W)},K=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,Z=/\S/,ee=/\s+/,te=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ne=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,re=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ie=/^[\],:{}\s]*$/,oe=/(?:^|:|,)(?:\s*\[)+/g,ae=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,se=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,le=/^-ms-/,ue=/-([\da-z])/gi,ce=function(e,t){return(t+"").toUpperCase()},fe=function(){R.addEventListener?(R.removeEventListener("DOMContentLoaded",fe,!1),ge.ready()):R.readyState==="complete"&&(R.detachEvent("onreadystatechange",fe),ge.ready())},pe={};ge.fn=ge.prototype={constructor:ge,init:function(e,t,n){var r,i,o,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?r=[null,e,null]:r=ne.exec(e);if(r&&(r[1]||!t)){if(r[1])return t=t instanceof ge?t[0]:t,a=t&&t.nodeType?t.ownerDocument||t:R,e=ge.parseHTML(r[1],a,!0),re.test(r[1])&&ge.isPlainObject(t)&&this.attr.call(e,t,!0),ge.merge(this,e);i=R.getElementById(r[2]);if(i&&i.parentNode){if(i.id!==r[2])return n.find(e);this.length=1,this[0]=i}return this.context=R,this.selector=e,this}return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e)}return ge.isFunction(e)?n.ready(e):(e.selector!==C&&(this.selector=e.selector,this.context=e.context),ge.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return Y.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=ge.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return ge.each(this,e,t)},ready:function(e){return ge.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Y.apply(this,arguments),"slice",Y.call(arguments).join(","))},map:function(n){return this.pushStack(ge.map(this,function(e,t){return n.call(e,t,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:U,sort:[].sort,splice:[].splice},ge.fn.init.prototype=ge.fn,ge.extend=ge.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,l=arguments.length,u=!1;typeof a=="boolean"&&(u=a,a=arguments[1]||{},s=2),typeof a!="object"&&!ge.isFunction(a)&&(a={}),l===s&&(a=this,--s);for(;s<l;s++)if((e=arguments[s])!=null)for(t in e){n=a[t],r=e[t];if(a===r)continue;u&&r&&(ge.isPlainObject(r)||(i=ge.isArray(r)))?(i?(i=!1,o=n&&ge.isArray(n)?n:[]):o=n&&ge.isPlainObject(n)?n:{},a[t]=ge.extend(u,o,r)):r!==C&&(a[t]=r)}return a},ge.extend({noConflict:function(e){return y.$===ge&&(y.$=X),e&&y.jQuery===ge&&(y.jQuery=z),ge},isReady:!1,readyWait:1,holdReady:function(e){e?ge.readyWait++:ge.ready(!0)},ready:function(e){if(e===!0?--ge.readyWait:ge.isReady)return;if(!R.body)return setTimeout(ge.ready,1);ge.isReady=!0;if(e!==!0&&--ge.readyWait>0)return;P.resolveWith(R,[ge]),ge.fn.trigger&&ge(R).trigger("ready").off("ready")},isFunction:function(e){return ge.type(e)==="function"},isArray:Array.isArray||function(e){return ge.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):pe[J.call(e)]||"object"},isPlainObject:function(e){if(!e||ge.type(e)!=="object"||e.nodeType||ge.isWindow(e))return!1;try{if(e.constructor&&!G.call(e,"constructor")&&!G.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var t;for(t in e);return t===C||G.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||R,(r=re.exec(e))?[t.createElement(r[1])]:(r=ge.buildFragment([e],t,n?null:[]),ge.merge([],(r.cacheable?ge.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(e){if(!e||typeof e!="string")return null;e=ge.trim(e);if(y.JSON&&y.JSON.parse)return y.JSON.parse(e);if(ie.test(e.replace(ae,"@").replace(se,"]").replace(oe,"")))return new Function("return "+e)();ge.error("Invalid JSON: "+e)},parseXML:function(e){var t,n;if(!e||typeof e!="string")return null;try{y.DOMParser?(n=new DOMParser,t=n.parseFromString(e,"text/xml")):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e))}catch(e){t=C}return(!t||!t.documentElement||t.getElementsByTagName("parsererror").length)&&ge.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){e&&Z.test(e)&&(y.execScript||function(e){y.eval.call(y,e)})(e)},camelCase:function(e){return e.replace(le,"ms-").replace(ue,ce)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=o===C||ge.isFunction(e);if(n){if(a){for(r in e)if(t.apply(e[r],n)===!1)break}else for(;i<o;)if(t.apply(e[i++],n)===!1)break}else if(a){for(r in e)if(t.call(e[r],r,e[r])===!1)break}else for(;i<o;)if(t.call(e[i],i,e[i++])===!1)break;return e},trim:Q&&!Q.call("\ufeff ")?function(e){return e==null?"":Q.call(e)}:function(e){return e==null?"":(e+"").replace(te,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=ge.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||ge.isWindow(e)?U.call(r,e):ge.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(V)return V.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=t.length,r=e.length,i=0;if(typeof n=="number")for(;i<n;i++)e[r++]=t[i];else while(t[i]!==C)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;n=!!n;for(;o<a;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i,o=[],a=0,s=e.length,l=e instanceof ge||s!==C&&typeof s=="number"&&(s>0&&e[0]&&e[s-1]||s===0||ge.isArray(e));if(l)for(;a<s;a++)r=t(e[a],a,n),r!=null&&(o[o.length]=r);else for(i in e)r=t(e[i],i,n),r!=null&&(o[o.length]=r);return o.concat.apply([],o)},guid:1,proxy:function(e,t){var n,r,i;return typeof t=="string"&&(n=e[t],t=e,e=n),ge.isFunction(e)?(r=Y.call(arguments,2),i=function(){return e.apply(t,r.concat(Y.call(arguments)))},i.guid=e.guid=e.guid||ge.guid++,i):C},access:function(e,t,n,r,i,o,a){var s,l=n==null,u=0,c=e.length;if(n&&typeof n=="object"){for(u in n)ge.access(e,t,u,n[u],1,o,r);i=1}else if(r!==C){s=a===C&&ge.isFunction(r),l&&(s?(s=t,t=function(e,t,n){return s.call(ge(e),n)}):(t.call(e,r),t=null));if(t)for(;u<c;u++)t(e[u],n,s?r.call(e[u],u,t(e[u],n)):r,a);i=1}return i?e:l?t.call(e):c?t(e[0],n):o},now:function(){return(new Date).getTime()}}),ge.ready.promise=function(e){if(!P){P=ge.Deferred();if(R.readyState==="complete")setTimeout(ge.ready,1);else if(R.addEventListener)R.addEventListener("DOMContentLoaded",fe,!1),y.addEventListener("load",ge.ready,!1);else{R.attachEvent("onreadystatechange",fe),y.attachEvent("onload",ge.ready);var n=!1;try{n=y.frameElement==null&&R.documentElement}catch(e){}n&&n.doScroll&&function t(){if(!ge.isReady){try{n.doScroll("left")}catch(e){return setTimeout(t,50)}ge.ready()}}()}}return P.promise(e)},ge.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){pe["[object "+t+"]"]=t.toLowerCase()}),W=ge(R);var de={};ge.Callbacks=function(i){i=typeof i=="string"?de[i]||e(i):ge.extend({},i);var t,n,r,o,a,s,l=[],u=!i.once&&[],c=function(e){t=i.memory&&e,n=!0,s=o||0,o=0,a=l.length,r=!0;for(;l&&s<a;s++)if(l[s].apply(e[0],e[1])===!1&&i.stopOnFalse){t=!1;break}r=!1,l&&(u?u.length&&c(u.shift()):t?l=[]:f.disable())},f={add:function(){if(l){var e=l.length;(function r(e){ge.each(e,function(e,t){var n=ge.type(t);n==="function"?(!i.unique||!f.has(t))&&l.push(t):t&&t.length&&n!=="string"&&r(t)})})(arguments),r?a=l.length:t&&(o=e,c(t))}return this},remove:function(){return l&&ge.each(arguments,function(e,t){var n;while((n=ge.inArray(t,l,n))>-1)l.splice(n,1),r&&(n<=a&&a--,n<=s&&s--)}),this},has:function(e){return ge.inArray(e,l)>-1},empty:function(){return l=[],this},disable:function(){return l=u=t=C,this},disabled:function(){return!l},lock:function(){return u=C,t||f.disable(),this},locked:function(){return!u},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],l&&(!n||u)&&(r?u.push(t):c(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!n}};return f},ge.extend({Deferred:function(e){var a=[["resolve","done",ge.Callbacks("once memory"),"resolved"],["reject","fail",ge.Callbacks("once memory"),"rejected"],["notify","progress",ge.Callbacks("memory")]],i="pending",o={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var o=arguments;return ge.Deferred(function(i){ge.each(a,function(e,t){var n=t[0],r=o[e];s[t[1]](ge.isFunction(r)?function(){var e=r.apply(this,arguments);e&&ge.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[n+"With"](this===s?i:this,[e])}:i[n])}),o=null}).promise()},promise:function(e){return e!=null?ge.extend(e,o):o}},s={};return o.pipe=o.then,ge.each(a,function(e,t){var n=t[2],r=t[3];o[t[1]]=n.add,r&&n.add(function(){i=r},a[e^1][2].disable,a[2][2].lock),s[t[0]]=n.fire,s[t[0]+"With"]=n.fireWith}),o.promise(s),e&&e.call(s,s),s},when:function(e){var t=0,n=Y.call(arguments),r=n.length,i=r!==1||e&&ge.isFunction(e.promise)?r:0,o=i===1?e:ge.Deferred(),a=function(t,n,r){return function(e){n[t]=this,r[t]=arguments.length>1?Y.call(arguments):e,r===s?o.notifyWith(n,r):--i||o.resolveWith(n,r)}},s,l,u;if(r>1){s=new Array(r),l=new Array(r),u=new Array(r);for(;t<r;t++)n[t]&&ge.isFunction(n[t].promise)?n[t].promise().done(a(t,u,n)).fail(o.reject).progress(a(t,l,s)):--i}return i||o.resolveWith(u,n),o.promise()}}),ge.support=function(){var a,e,t,n,r,i,o,s,l,u,c,f=R.createElement("div");f.setAttribute("className","t"),f.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=f.getElementsByTagName("*"),t=f.getElementsByTagName("a")[0];if(!e||!t||!e.length)return{};n=R.createElement("select"),r=n.appendChild(R.createElement("option")),i=f.getElementsByTagName("input")[0],t.style.cssText="top:1px;float:left;opacity:.5",a={leadingWhitespace:f.firstChild.nodeType===3,tbody:!f.getElementsByTagName("tbody").length,htmlSerialize:!!f.getElementsByTagName("link").length,style:/top/.test(t.getAttribute("style")),hrefNormalized:t.getAttribute("href")==="/a",opacity:/^0.5/.test(t.style.opacity),cssFloat:!!t.style.cssFloat,checkOn:i.value==="on",optSelected:r.selected,getSetAttribute:f.className!=="t",enctype:!!R.createElement("form").enctype,html5Clone:R.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:R.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},i.checked=!0,a.noCloneChecked=i.cloneNode(!0).checked,n.disabled=!0,a.optDisabled=!r.disabled;try{delete f.test}catch(e){a.deleteExpando=!1}!f.addEventListener&&f.attachEvent&&f.fireEvent&&(f.attachEvent("onclick",c=function(){a.noCloneEvent=!1}),f.cloneNode(!0).fireEvent("onclick"),f.detachEvent("onclick",c)),i=R.createElement("input"),i.value="t",i.setAttribute("type","radio"),a.radioValue=i.value==="t",i.setAttribute("checked","checked"),i.setAttribute("name","t"),f.appendChild(i),o=R.createDocumentFragment(),o.appendChild(f.lastChild),a.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,a.appendChecked=i.checked,o.removeChild(i),o.appendChild(f);if(f.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})s="on"+l,u=s in f,u||(f.setAttribute(s,"return;"),u=typeof f[s]=="function"),a[l+"Bubbles"]=u;return ge(function(){var e,t,n,r,i="padding:0;margin:0;border:0;display:block;overflow:hidden;",o=R.getElementsByTagName("body")[0];if(!o)return;e=R.createElement("div"),e.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",o.insertBefore(e,o.firstChild),t=R.createElement("div"),e.appendChild(t),t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n=t.getElementsByTagName("td"),n[0].style.cssText="padding:0;margin:0;border:0;display:none",u=n[0].offsetHeight===0,n[0].style.display="",n[1].style.display="none",a.reliableHiddenOffsets=u&&n[0].offsetHeight===0,t.innerHTML="",t.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",a.boxSizing=t.offsetWidth===4,a.doesNotIncludeMarginInBodyOffset=o.offsetTop!==1,y.getComputedStyle&&(a.pixelPosition=(y.getComputedStyle(t,null)||{}).top!=="1%",a.boxSizingReliable=(y.getComputedStyle(t,null)||{width:"4px"}).width==="4px",r=R.createElement("div"),r.style.cssText=t.style.cssText=i,r.style.marginRight=r.style.width="0",t.style.width="1px",t.appendChild(r),a.reliableMarginRight=!parseFloat((y.getComputedStyle(r,null)||{}).marginRight)),typeof t.style.zoom!="undefined"&&(t.innerHTML="",t.style.cssText=i+"width:1px;padding:1px;display:inline;zoom:1",a.inlineBlockNeedsLayout=t.offsetWidth===3,t.style.display="block",t.style.overflow="visible",t.innerHTML="<div></div>",t.firstChild.style.width="5px",a.shrinkWrapBlocks=t.offsetWidth!==3,e.style.zoom=1),o.removeChild(e),e=t=n=r=null}),o.removeChild(f),e=t=n=r=i=o=f=null,a}();var he=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,me=/([A-Z])/g;ge.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(ge.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?ge.cache[e[ge.expando]]:e[ge.expando],!!e&&!u(e)},data:function(e,t,n,r){if(!ge.acceptData(e))return;var i,o,a=ge.expando,s=typeof t=="string",l=e.nodeType,u=l?ge.cache:e,c=l?e[a]:e[a]&&a;if((!c||!u[c]||!r&&!u[c].data)&&s&&n===C)return;c||(l?e[a]=c=ge.deletedIds.pop()||ge.guid++:c=a),u[c]||(u[c]={},l||(u[c].toJSON=ge.noop));if(typeof t=="object"||typeof t=="function")r?u[c]=ge.extend(u[c],t):u[c].data=ge.extend(u[c].data,t);return i=u[c],r||(i.data||(i.data={}),i=i.data),n!==C&&(i[ge.camelCase(t)]=n),s?(o=i[t],o==null&&(o=i[ge.camelCase(t)])):o=i,o},removeData:function(e,t,n){if(!ge.acceptData(e))return;var r,i,o,a=e.nodeType,s=a?ge.cache:e,l=a?e[ge.expando]:ge.expando;if(!s[l])return;if(t){r=n?s[l]:s[l].data;if(r){ge.isArray(t)||(t in r?t=[t]:(t=ge.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,o=t.length;i<o;i++)delete r[t[i]];if(!(n?u:ge.isEmptyObject)(r))return}}if(!n){delete s[l].data;if(!u(s[l]))return}a?ge.cleanData([e],!0):ge.support.deleteExpando||s!=s.window?delete s[l]:s[l]=null},_data:function(e,t,n){return ge.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&ge.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),ge.fn.extend({data:function(n,e){var r,i,t,o,a,s=this[0],l=0,u=null;if(n===C){if(this.length){u=ge.data(s);if(s.nodeType===1&&!ge._data(s,"parsedAttrs")){t=s.attributes;for(a=t.length;l<a;l++)o=t[l].name,o.indexOf("data-")||(o=ge.camelCase(o.substring(5)),c(s,o,u[o]));ge._data(s,"parsedAttrs",!0)}}return u}return typeof n=="object"?this.each(function(){ge.data(this,n)}):(r=n.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",ge.access(this,function(t){if(t===C)return u=this.triggerHandler("getData"+i,[r[0]]),u===C&&s&&(u=ge.data(s,n),u=c(s,n,u)),u===C&&r[1]?this.data(r[0]):u;r[1]=t,this.each(function(){var e=ge(this);e.triggerHandler("setData"+i,r),ge.data(this,n,t),e.triggerHandler("changeData"+i,r)})},null,e,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){ge.removeData(this,e)})}}),ge.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ge._data(e,t),n&&(!r||ge.isArray(n)?r=ge._data(e,t,ge.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=ge.queue(e,t),r=n.length,i=n.shift(),o=ge._queueHooks(e,t),a=function(){ge.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ge._data(e,n)||ge._data(e,n,{empty:ge.Callbacks("once memory").add(function(){ge.removeData(e,t+"queue",!0),ge.removeData(e,n,!0)})})}}),ge.fn.extend({queue:function(t,n){var e=2;return typeof t!="string"&&(n=t,t="fx",e--),arguments.length<e?ge.queue(this[0],t):n===C?this:this.each(function(){var e=ge.queue(this,t,n);ge._queueHooks(this,t),t==="fx"&&e[0]!=="inprogress"&&ge.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ge.dequeue(this,e)})},delay:function(r,e){return r=ge.fx?ge.fx.speeds[r]||r:r,e=e||"fx",this.queue(e,function(e,t){var n=setTimeout(e,r);t.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=ge.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};typeof e!="string"&&(t=e,e=C),e=e||"fx";while(a--)n=ge._data(o[a],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ye,ve,be,xe=/[\t\r\n]/g,we=/\r/g,Te=/^(?:button|input)$/i,Ne=/^(?:button|input|object|select|textarea)$/i,Ce=/^a(?:rea|)$/i,ke=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Ee=ge.support.getSetAttribute;ge.fn.extend({attr:function(e,t){return ge.access(this,ge.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ge.removeAttr(this,e)})},prop:function(e,t){return ge.access(this,ge.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ge.propFix[e]||e,this.each(function(){try{this[e]=C,delete this[e]}catch(e){}})},addClass:function(t){var e,n,r,i,o,a,s;if(ge.isFunction(t))return this.each(function(e){ge(this).addClass(t.call(this,e,this.className))});if(t&&typeof t=="string"){e=t.split(ee);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&e.length===1)i.className=t;else{o=" "+i.className+" ";for(a=0,s=e.length;a<s;a++)o.indexOf(" "+e[a]+" ")<0&&(o+=e[a]+" ");i.className=ge.trim(o)}}}return this},removeClass:function(t){var e,n,r,i,o,a,s;if(ge.isFunction(t))return this.each(function(e){ge(this).removeClass(t.call(this,e,this.className))});if(t&&typeof t=="string"||t===C){e=(t||"").split(ee);for(a=0,s=this.length;a<s;a++){r=this[a];if(r.nodeType===1&&r.className){n=(" "+r.className+" ").replace(xe," ");for(i=0,o=e.length;i<o;i++)while(n.indexOf(" "+e[i]+" ")>=0)n=n.replace(" "+e[i]+" "," ");r.className=t?ge.trim(n):""}}}return this},toggleClass:function(o,a){var s=typeof o,l=typeof a=="boolean";return ge.isFunction(o)?this.each(function(e){ge(this).toggleClass(o.call(this,e,this.className,a),a)}):this.each(function(){if(s==="string"){var e,t=0,n=ge(this),r=a,i=o.split(ee);while(e=i[t++])r=l?r:!n.hasClass(e),n[r?"addClass":"removeClass"](e)}else if(s==="undefined"||s==="boolean")this.className&&ge._data(this,"__className__",this.className),this.className=this.className||o===!1?"":ge._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(xe," ").indexOf(t)>=0)return!0;return!1},val:function(r){var i,e,o,t=this[0];if(!arguments.length){if(t)return i=ge.valHooks[t.type]||ge.valHooks[t.nodeName.toLowerCase()],i&&"get"in i&&(e=i.get(t,"value"))!==C?e:(e=t.value,typeof e=="string"?e.replace(we,""):e==null?"":e);return}return o=ge.isFunction(r),this.each(function(e){var t,n=ge(this);if(this.nodeType!==1)return;o?t=r.call(this,e,n.val()):t=r,t==null?t="":typeof t=="number"?t+="":ge.isArray(t)&&(t=ge.map(t,function(e){return e==null?"":e+""})),i=ge.valHooks[this.type]||ge.valHooks[this.nodeName.toLowerCase()];if(!i||!("set"in i)||i.set(this,t,"value")===C)this.value=t})}}),ge.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o=e.type==="select-one"||i<0,a=o?null:[],s=o?i+1:r.length,l=i<0?s:o?i:0;for(;l<s;l++){n=r[l];if((n.selected||l===i)&&(ge.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!ge.nodeName(n.parentNode,"optgroup"))){t=ge(n).val();if(o)return t;a.push(t)}}return a},set:function(e,t){var n=ge.makeArray(t);return ge(e).find("option").each(function(){this.selected=ge.inArray(ge(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,t,n,r){var i,o,a,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(r&&ge.isFunction(ge.fn[t]))return ge(e)[t](n);if(typeof e.getAttribute=="undefined")return ge.prop(e,t,n);a=s!==1||!ge.isXMLDoc(e),a&&(t=t.toLowerCase(),o=ge.attrHooks[t]||(ke.test(t)?ve:ye));if(n!==C){if(n===null){ge.removeAttr(e,t);return}return o&&"set"in o&&a&&(i=o.set(e,n,t))!==C?i:(e.setAttribute(t,n+""),n)}return o&&"get"in o&&a&&(i=o.get(e,t))!==null?i:(i=e.getAttribute(t),i===null?C:i)},removeAttr:function(e,t){var n,r,i,o,a=0;if(t&&e.nodeType===1){r=t.split(ee);for(;a<r.length;a++)i=r[a],i&&(n=ge.propFix[i]||i,o=ke.test(i),o||ge.attr(e,i,""),e.removeAttribute(Ee?i:n),o&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(Te.test(e.nodeName)&&e.parentNode)ge.error("type property can't be changed");else if(!ge.support.radioValue&&t==="radio"&&ge.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return ye&&ge.nodeName(e,"button")?ye.get(e,t):t in e?e.value:null},set:function(e,t,n){if(ye&&ge.nodeName(e,"button"))return ye.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,t,n){var r,i,o,a=e.nodeType;if(!e||a===3||a===8||a===2)return;return o=a!==1||!ge.isXMLDoc(e),o&&(t=ge.propFix[t]||t,i=ge.propHooks[t]),n!==C?i&&"set"in i&&(r=i.set(e,n,t))!==C?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):Ne.test(e.nodeName)||Ce.test(e.nodeName)&&e.href?0:C}}}}),ve={get:function(e,t){var n,r=ge.prop(e,t);return r===!0||typeof r!="boolean"&&(n=e.getAttributeNode(t))&&n.nodeValue!==!1?t.toLowerCase():C},set:function(e,t,n){var r;return t===!1?ge.removeAttr(e,n):(r=ge.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},Ee||(be={name:!0,id:!0,coords:!0},ye=ge.valHooks.button={get:function(e,t){var n;return n=e.getAttributeNode(t),n&&(be[t]?n.value!=="":n.specified)?n.value:C},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=R.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},ge.each(["width","height"],function(e,n){ge.attrHooks[n]=ge.extend(ge.attrHooks[n],{set:function(e,t){if(t==="")return e.setAttribute(n,"auto"),t}})}),ge.attrHooks.contenteditable={get:ye.get,set:function(e,t,n){t===""&&(t="false"),ye.set(e,t,n)}}),ge.support.hrefNormalized||ge.each(["href","src","width","height"],function(e,n){ge.attrHooks[n]=ge.extend(ge.attrHooks[n],{get:function(e){var t=e.getAttribute(n,2);return t===null?C:t}})}),ge.support.style||(ge.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||C},set:function(e,t){return e.style.cssText=t+""}}),ge.support.optSelected||(ge.propHooks.selected=ge.extend(ge.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),ge.support.enctype||(ge.propFix.enctype="encoding"),ge.support.checkOn||ge.each(["radio","checkbox"],function(){ge.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),ge.each(["radio","checkbox"],function(){ge.valHooks[this]=ge.extend(ge.valHooks[this],{set:function(e,t){if(ge.isArray(t))return e.checked=ge.inArray(ge(e).val(),t)>=0}})});var Se=/^(?:textarea|input|select)$/i,Ae=/^([^\.]*|)(?:\.(.+)|)$/,je=/(?:^|\s)hover(\.\S+|)\b/,De=/^key/,Le=/^(?:mouse|contextmenu)|click/,He=/^(?:focusinfocus|focusoutblur)$/,Fe=function(e){return ge.event.special.hover?e:e.replace(je,"mouseenter$1 mouseleave$1")};ge.event={add:function(e,t,n,r,i){var o,a,s,l,u,c,f,p,d,h,g;if(e.nodeType===3||e.nodeType===8||!t||!n||!(o=ge._data(e)))return;n.handler&&(d=n,n=d.handler,i=d.selector),n.guid||(n.guid=ge.guid++),s=o.events,s||(o.events=s={}),a=o.handle,a||(o.handle=a=function(e){return typeof ge=="undefined"||!!e&&ge.event.triggered===e.type?C:ge.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=ge.trim(Fe(t)).split(" ");for(l=0;l<t.length;l++){u=Ae.exec(t[l])||[],c=u[1],f=(u[2]||"").split(".").sort(),g=ge.event.special[c]||{},c=(i?g.delegateType:g.bindType)||c,g=ge.event.special[c]||{},p=ge.extend({type:c,origType:u[1],data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&ge.expr.match.needsContext.test(i),namespace:f.join(".")},d),h=s[c];if(!h){h=s[c]=[],h.delegateCount=0;if(!g.setup||g.setup.call(e,r,f,a)===!1)e.addEventListener?e.addEventListener(c,a,!1):e.attachEvent&&e.attachEvent("on"+c,a)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,p):h.push(p),ge.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var o,a,s,l,u,c,f,p,d,h,g,m=ge.hasData(e)&&ge._data(e);if(!m||!(p=m.events))return;t=ge.trim(Fe(t||"")).split(" ");for(o=0;o<t.length;o++){a=Ae.exec(t[o])||[],s=l=a[1],u=a[2];if(!s){for(s in p)ge.event.remove(e,s+t[o],n,r,!0);continue}d=ge.event.special[s]||{},s=(r?d.delegateType:d.bindType)||s,h=p[s]||[],c=h.length,u=u?new RegExp("(^|\\.)"+u.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(f=0;f<h.length;f++)g=h[f],(i||l===g.origType)&&(!n||n.guid===g.guid)&&(!u||u.test(g.namespace))&&(!r||r===g.selector||r==="**"&&g.selector)&&(h.splice(f--,1),g.selector&&h.delegateCount--,d.remove&&d.remove.call(e,g));h.length===0&&c!==h.length&&((!d.teardown||d.teardown.call(e,u,m.handle)===!1)&&ge.removeEvent(e,s,m.handle),delete p[s])}ge.isEmptyObject(p)&&(delete m.handle,ge.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(e,t,n,r){if(!n||n.nodeType!==3&&n.nodeType!==8){var i,o,a,s,l,u,c,f,p,d,h=e.type||e,g=[];if(He.test(h+ge.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),o=!0),h.indexOf(".")>=0&&(g=h.split("."),h=g.shift(),g.sort());if((!n||ge.event.customEvent[h])&&!ge.event.global[h])return;e=typeof e=="object"?e[ge.expando]?e:new ge.Event(h,e):new ge.Event(h),e.type=h,e.isTrigger=!0,e.exclusive=o,e.namespace=g.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,u=h.indexOf(":")<0?"on"+h:"";if(!n){i=ge.cache;for(a in i)i[a].events&&i[a].events[h]&&ge.event.trigger(e,t,i[a].handle.elem,!0);return}e.result=C,e.target||(e.target=n),t=t!=null?ge.makeArray(t):[],t.unshift(e),c=ge.event.special[h]||{};if(c.trigger&&c.trigger.apply(n,t)===!1)return;p=[[n,c.bindType||h]];if(!r&&!c.noBubble&&!ge.isWindow(n)){d=c.delegateType||h,s=He.test(d+h)?n:n.parentNode;for(l=n;s;s=s.parentNode)p.push([s,d]),l=s;l===(n.ownerDocument||R)&&p.push([l.defaultView||l.parentWindow||y,d])}for(a=0;a<p.length&&!e.isPropagationStopped();a++)s=p[a][0],e.type=p[a][1],f=(ge._data(s,"events")||{})[e.type]&&ge._data(s,"handle"),f&&f.apply(s,t),f=u&&s[u],f&&ge.acceptData(s)&&f.apply&&f.apply(s,t)===!1&&e.preventDefault();return e.type=h,!r&&!e.isDefaultPrevented()&&(!c._default||c._default.apply(n.ownerDocument,t)===!1)&&(h!=="click"||!ge.nodeName(n,"a"))&&ge.acceptData(n)&&u&&n[h]&&(h!=="focus"&&h!=="blur"||e.target.offsetWidth!==0)&&!ge.isWindow(n)&&(l=n[u],l&&(n[u]=null),ge.event.triggered=h,n[h](),ge.event.triggered=C,l&&(n[u]=l)),e.result}return},dispatch:function(e){e=ge.event.fix(e||y.event);var t,n,r,i,o,a,s,l,u,c,f=(ge._data(this,"events")||{})[e.type]||[],p=f.delegateCount,d=Y.call(arguments),h=!e.exclusive&&!e.namespace,g=ge.event.special[e.type]||{},m=[];d[0]=e,e.delegateTarget=this;if(g.preDispatch&&g.preDispatch.call(this,e)===!1)return;if(p&&(!e.button||e.type!=="click"))for(r=e.target;r!=this;r=r.parentNode||this)if(r.disabled!==!0||e.type!=="click"){o={},s=[];for(t=0;t<p;t++)l=f[t],u=l.selector,o[u]===C&&(o[u]=l.needsContext?ge(u,this).index(r)>=0:ge.find(u,this,null,[r]).length),o[u]&&s.push(l);s.length&&m.push({elem:r,matches:s})}f.length>p&&m.push({elem:this,matches:f.slice(p)});for(t=0;t<m.length&&!e.isPropagationStopped();t++){a=m[t],e.currentTarget=a.elem;for(n=0;n<a.matches.length&&!e.isImmediatePropagationStopped();n++){l=a.matches[n];if(h||!e.namespace&&!l.namespace||e.namespace_re&&e.namespace_re.test(l.namespace))e.data=l.data,e.handleObj=l,i=((ge.event.special[l.origType]||{}).handle||l.handler).apply(a.elem,d),i!==C&&(e.result=i,i===!1&&(e.preventDefault(),e.stopPropagation()))}}return g.postDispatch&&g.postDispatch.call(this,e),e.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,o=t.button,a=t.fromElement;return e.pageX==null&&t.clientX!=null&&(n=e.target.ownerDocument||R,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),!e.which&&o!==C&&(e.which=o&1?1:o&2?3:o&4?2:0),e}},fix:function(e){if(e[ge.expando])return e;var t,n,r=e,i=ge.event.fixHooks[e.type]||{},o=i.props?this.props.concat(i.props):this.props;e=ge.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||R),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){ge.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=ge.extend(new ge.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?ge.event.trigger(i,null,t):ge.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},ge.event.handle=ge.event.dispatch,ge.removeEvent=R.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},ge.Event=function(e,t){if(!(this instanceof ge.Event))return new ge.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?n:s):this.type=e,t&&ge.extend(this,t),this.timeStamp=e&&e.timeStamp||ge.now(),this[ge.expando]=!0},ge.Event.prototype={preventDefault:function(){this.isDefaultPrevented=n;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=n;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=n,this.stopPropagation()},isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s},ge.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,a){ge.event.special[e]={delegateType:a,bindType:a,handle:function(e){var t,n=this,r=e.relatedTarget,i=e.handleObj,o=i.selector;if(!r||r!==n&&!ge.contains(n,r))e.type=i.origType,t=i.handler.apply(this,arguments),e.type=a;return t}}}),ge.support.submitBubbles||(ge.event.special.submit={setup:function(){if(ge.nodeName(this,"form"))return!1;ge.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=ge.nodeName(t,"input")||ge.nodeName(t,"button")?t.form:C;n&&!ge._data(n,"_submit_attached")&&(ge.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),ge._data(n,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ge.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(ge.nodeName(this,"form"))return!1;ge.event.remove(this,"._submit")}}),ge.support.changeBubbles||(ge.event.special.change={setup:function(){if(Se.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")ge.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),ge.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ge.event.simulate("change",this,e,!0)});return!1}ge.event.add(this,"beforeactivate._change",function(e){var t=e.target;Se.test(t.nodeName)&&!ge._data(t,"_change_attached")&&(ge.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&ge.event.simulate("change",this.parentNode,e,!0)}),ge._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return ge.event.remove(this,"._change"),!Se.test(this.nodeName)}}),ge.support.focusinBubbles||ge.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){ge.event.simulate(t,e.target,ge.event.fix(e),!0)};ge.event.special[t]={setup:function(){n++===0&&R.addEventListener(e,r,!0)},teardown:function(){--n===0&&R.removeEventListener(e,r,!0)}}}),ge.fn.extend({on:function(e,t,n,r,i){var o,a;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=C);for(a in e)this.on(a,t,n,e[a],i);return this}n==null&&r==null?(r=t,n=t=C):r==null&&(typeof t=="string"?(r=n,n=C):(r=n,n=t,t=C));if(r===!1)r=s;else if(!r)return this;return i===1&&(o=r,r=function(e){return ge().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=ge.guid++)),this.each(function(){ge.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ge(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=C;return n===!1&&(n=s),this.each(function(){ge.event.remove(this,e,n,t)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return ge(this.context).on(e,this.selector,t,n),this},die:function(e,t){return ge(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){ge.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return ge.event.trigger(e,t,this[0],!0)},toggle:function(n){var r=arguments,e=n.guid||ge.guid++,i=0,t=function(e){var t=(ge._data(this,"lastToggle"+n.guid)||0)%i;return ge._data(this,"lastToggle"+n.guid,t+1),e.preventDefault(),r[t].apply(this,arguments)||!1};t.guid=e;while(i<r.length)r[i++].guid=e;return this.click(t)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ge.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){ge.fn[n]=function(e,t){return t==null&&(t=e,e=null),arguments.length>0?this.on(n,null,e,t):this.trigger(n)},De.test(n)&&(ge.event.fixHooks[n]=ge.event.keyHooks),Le.test(n)&&(ge.event.fixHooks[n]=ge.event.mouseHooks)}),function(e,i){function w(e,t,n,r){n=n||[],t=t||L;var i,o,a,s,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=g(t);if(!a&&!r)if(i=te.exec(e))if(s=i[1]){if(l===9){o=t.getElementById(s);if(!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&m(t,o)&&o.id===s)return n.push(o),n}else{if(i[2])return _.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((s=i[3])&&de&&t.getElementsByClassName)return _.apply(n,q.call(t.getElementsByClassName(s),0)),n}return u(e.replace(Q,"$1"),t,n,r,a)}function t(n){return function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type===n}}function n(n){return function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&e.type===n}}function r(a){return W(function(o){return o=+o,W(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function c(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function h(e,t){var n,r,i,o,a,s,l,u=$[j][e+" "];if(u)return t?0:u.slice(0);a=e,s=[],l=C.preFilter;while(a){if(!n||(r=K.exec(a)))r&&(a=a.slice(r[0].length)||a),s.push(i=[]);n=!1;if(r=Z.exec(a))i.push(n=new D(r.shift())),a=a.slice(n.length),n.type=r[0].replace(Q," ");for(o in C.filter)(r=le[o].exec(a))&&(!l[o]||(r=l[o](r)))&&(i.push(n=new D(r.shift())),a=a.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?a.length:a?w.error(e):$(e,s).slice(0)}function f(a,e,t){var s=e.dir,l=t&&e.dir==="parentNode",u=M++;return e.first?function(e,t,n){while(e=e[s])if(l||e.nodeType===1)return a(e,t,n)}:function(e,t,n){if(!n){var r,i=F+" "+u+" ",o=i+N;while(e=e[s])if(l||e.nodeType===1){if((r=e[j])===o)return e.sizset;if(typeof r=="string"&&r.indexOf(i)===0){if(e.sizset)return e}else{e[j]=o;if(a(e,t,n))return e.sizset=!0,e;e.sizset=!1}}}else while(e=e[s])if(l||e.nodeType===1)if(a(e,t,n))return e}}function p(i){return i.length>1?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function T(e,t,n,r,i){var o,a=[],s=0,l=e.length,u=t!=null;for(;s<l;s++)if(o=e[s])if(!n||n(o,r,i))a.push(o),u&&t.push(s);return a}function v(d,h,g,m,y,e){return m&&!m[j]&&(m=v(m)),y&&!y[j]&&(y=v(y,e)),W(function(e,t,n,r){var i,o,a,s=[],l=[],u=t.length,c=e||b(h||"*",n.nodeType?[n]:n,[]),f=d&&(e||!h)?T(c,s,d,n,r):c,p=g?y||(e?d:u||m)?[]:t:f;g&&g(f,p,n,r);if(m){i=T(p,l),m(i,[],n,r),o=i.length;while(o--)if(a=i[o])p[l[o]]=!(f[l[o]]=a)}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&(i=y?B.call(e,a):s[o])>-1&&(e[i]=!(t[i]=a))}}else p=T(p===t?p.splice(u,p.length):p),y?y(null,t,p,r):_.apply(t,p)})}function d(e){var r,t,n,i=e.length,o=C.relative[e[0].type],a=o||C.relative[" "],s=o?1:0,l=f(function(e){return e===r},a,!0),u=f(function(e){return B.call(r,e)>-1},a,!0),c=[function(e,t,n){return!o&&(n||t!==E)||((r=t).nodeType?l(e,t,n):u(e,t,n))}];for(;s<i;s++)if(t=C.relative[e[s].type])c=[f(p(c),t)];else{t=C.filter[e[s].type].apply(null,e[s].matches);if(t[j]){n=++s;for(;n<i;n++)if(C.relative[e[n].type])break;return v(s>1&&p(c),s>1&&e.slice(0,s-1).join("").replace(Q,"$1"),t,s<n&&d(e.slice(s,n)),n<i&&d(e=e.slice(n)),n<i&&e.join(""))}c.push(t)}return p(c)}function a(m,y){var v=y.length>0,b=m.length>0,x=function(e,t,n,r,i){var o,a,s,l=[],u=0,c="0",f=e&&[],p=i!=null,d=E,h=e||b&&C.find.TAG("*",i&&t.parentNode||t),g=F+=d==null?1:Math.E;p&&(E=t!==L&&t,N=x.el);for(;(o=h[c])!=null;c++){if(b&&o){for(a=0;s=m[a];a++)if(s(o,t,n)){r.push(o);break}p&&(F=g,N=++x.el)}v&&((o=!s&&o)&&u--,e&&f.push(o))}u+=c;if(v&&c!==u){for(a=0;s=y[a];a++)s(f,l,t,n);if(e){if(u>0)while(c--)!f[c]&&!l[c]&&(l[c]=O.call(r));l=T(l)}_.apply(r,l),p&&!e&&l.length>0&&u+y.length>1&&w.uniqueSort(r)}return p&&(F=g,E=d),f};return x.el=0,v?W(x):x}function b(e,t,n){var r=0,i=t.length;for(;r<i;r++)w(e,t[r],n);return n}function u(e,t,n,r,i){var o,a,s,l,u,c=h(e),f=c.length;if(!r&&c.length===1){a=c[0]=c[0].slice(0);if(a.length>2&&(s=a[0]).type==="ID"&&t.nodeType===9&&!i&&C.relative[a[1].type]){t=C.find.ID(s.matches[0].replace(se,""),t,i)[0];if(!t)return n;e=e.slice(a.shift().length)}for(o=le.POS.test(e)?-1:a.length-1;o>=0;o--){s=a[o];if(C.relative[l=s.type])break;if(u=C.find[l])if(r=u(s.matches[0].replace(se,""),re.test(a[0].type)&&t.parentNode||t,i)){a.splice(o,1),e=r.length&&a.join("");if(!e)return _.apply(n,q.call(r,0)),n;break}}}return y(e,c)(r,t,i,n,re.test(e)),n}function o(){}var N,s,C,l,g,m,y,x,k,E,S=!0,A="undefined",j=("sizcache"+Math.random()).replace(".",""),D=String,L=e.document,H=L.documentElement,F=0,M=0,O=[].pop,_=[].push,q=[].slice,B=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},W=function(e,t){return e[j]=t==null||t,e},P=function(){var n={},r=[];return W(function(e,t){return r.push(e)>C.cacheLength&&delete n[r.shift()],n[e+" "]=t},n)},R=P(),$=P(),I=P(),z="[\\x20\\t\\r\\n\\f]",X="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",U=X.replace("w","w#"),Y="([*^$|!~]?=)",V="\\["+z+"*("+X+")"+z+"*(?:"+Y+z+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+U+")|)|)"+z+"*\\]",J=":("+X+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+V+")|[^:]|\\\\.)*|.*))\\)|)",G=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+z+"*((?:-\\d)?\\d*)"+z+"*\\)|)(?=[^-]|$)",Q=new RegExp("^"+z+"+|((?:^|[^\\\\])(?:\\\\.)*)"+z+"+$","g"),K=new RegExp("^"+z+"*,"+z+"*"),Z=new RegExp("^"+z+"*([\\x20\\t\\r\\n\\f>+~])"+z+"*"),ee=new RegExp(J),te=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,ne=/^:not/,re=/[\x20\t\r\n\f]*[+~]/,ie=/:not\($/,oe=/h\d/i,ae=/input|select|textarea|button/i,se=/\\(?!\\)/g,le={ID:new RegExp("^#("+X+")"),CLASS:new RegExp("^\\.("+X+")"),NAME:new RegExp("^\\[name=['\"]?("+X+")['\"]?\\]"),TAG:new RegExp("^("+X.replace("w","w*")+")"),ATTR:new RegExp("^"+V),PSEUDO:new RegExp("^"+J),POS:new RegExp(G,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+z+"*(even|odd|(([+-]|)(\\d*)n|)"+z+"*(?:([+-]|)"+z+"*(\\d+)|))"+z+"*\\)|)","i"),needsContext:new RegExp("^"+z+"*[>+~]|"+G,"i")},ue=function(e){var t=L.createElement("div");try{return e(t)}catch(e){return!1}finally{t=null}},ce=ue(function(e){return e.appendChild(L.createComment("")),!e.getElementsByTagName("*").length}),fe=ue(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==A&&e.firstChild.getAttribute("href")==="#"}),pe=ue(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),de=ue(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),he=ue(function(e){e.id=j+0,e.innerHTML="<a name='"+j+"'></a><div name='"+j+"'></div>",H.insertBefore(e,H.firstChild);var t=L.getElementsByName&&L.getElementsByName(j).length===2+L.getElementsByName(j+0).length;return s=!L.getElementById(j),H.removeChild(e),t});try{q.call(H.childNodes,0)[0].nodeType}catch(e){q=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}w.matches=function(e,t){return w(e,null,null,t)},w.matchesSelector=function(e,t){return w(t,null,null,[e]).length>0},l=w.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=l(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=l(t);return n},g=w.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},m=w.contains=H.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:H.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},w.attr=function(e,t){var n,r=g(e);return r||(t=t.toLowerCase()),(n=C.attrHandle[t])?n(e):r||pe?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},C=w.selectors={cacheLength:50,createPseudo:W,match:le,attrHandle:fe?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:s?function(e,t,n){if(typeof t.getElementById!==A&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,t,n){if(typeof t.getElementById!==A&&!n){var r=t.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode("id").value===e?[r]:i:[]}},TAG:ce?function(e,t){if(typeof t.getElementsByTagName!==A)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],o=0;for(;r=n[o];o++)r.nodeType===1&&i.push(r);return i}return n},NAME:he&&function(e,t){if(typeof t.getElementsByName!==A)return t.getElementsByName(name)},CLASS:de&&function(e,t,n){if(typeof t.getElementsByClassName!==A&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(se,""),e[3]=(e[4]||e[5]||"").replace(se,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||w.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&w.error(e[0]),e},PSEUDO:function(e){var t,n;if(le.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])ee.test(t)&&(n=h(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:s?function(t){return t=t.replace(se,""),function(e){return e.getAttribute("id")===t}}:function(n){return n=n.replace(se,""),function(e){var t=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return t&&t.value===n}},TAG:function(t){return t==="*"?function(){return!0}:(t=t.replace(se,"").toLowerCase(),function(e){return e.nodeName&&e.nodeName.toLowerCase()===t})},CLASS:function(e){var t=R[j][e+" "];return t||(t=new RegExp("(^|"+z+")"+e+"("+z+"|$)"))&&R(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(r,i,o){return function(e,t){var n=w.attr(e,r);return n==null?i==="!=":i?(n+="",i==="="?n===o:i==="!="?n!==o:i==="^="?o&&n.indexOf(o)===0:i==="*="?o&&n.indexOf(o)>-1:i==="$="?o&&n.substr(n.length-o.length)===o:i==="~="?(" "+n+" ").indexOf(o)>-1:i==="|="?n===o||n.substr(0,o.length+1)===o+"-":!1):!0}},CHILD:function(n,e,i,o){return n==="nth"?function(e){var t,n,r=e.parentNode;if(i===1&&o===0)return!0;if(r){n=0;for(t=r.firstChild;t;t=t.nextSibling)if(t.nodeType===1){n++;if(e===t)break}}return n-=o,n===i||n%i===0&&n/i>=0}:function(e){var t=e;switch(n){case"only":case"first":while(t=t.previousSibling)if(t.nodeType===1)return!1;if(n==="first")return!0;t=e;case"last":while(t=t.nextSibling)if(t.nodeType===1)return!1;return!0}}},PSEUDO:function(e,o){var t,a=C.pseudos[e]||C.setFilters[e.toLowerCase()]||w.error("unsupported pseudo: "+e);return a[j]?a(o):a.length>1?(t=[e,e,"",o],C.setFilters.hasOwnProperty(e.toLowerCase())?W(function(e,t){var n,r=a(e,o),i=r.length;while(i--)n=B.call(e,r[i]),e[n]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:W(function(e){var r=[],i=[],s=y(e.replace(Q,"$1"));return s[j]?W(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)if(i=o[a])e[a]=!(t[a]=i)}):function(e,t,n){return r[0]=e,s(r,null,n,i),!i.pop()}}),has:W(function(t){return function(e){return w(t,e).length>0}}),contains:W(function(t){return function(e){return(e.textContent||e.innerText||l(e)).indexOf(t)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!C.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return oe.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:t("radio"),checkbox:t("checkbox"),file:t("file"),password:t("password"),image:t("image"),submit:n("submit"),reset:n("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return ae.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:r(function(){return[0]}),last:r(function(e,t){return[t-1]}),eq:r(function(e,t,n){return[n<0?n+t:n]}),even:r(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:r(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:r(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:r(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},x=H.compareDocumentPosition?function(e,t){return e===t?(k=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return k=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],o=[],a=e.parentNode,s=t.parentNode,l=a;if(a===s)return c(e,t);if(!a)return-1;if(!s)return 1;while(l)i.unshift(l),l=l.parentNode;l=s;while(l)o.unshift(l),l=l.parentNode;n=i.length,r=o.length;for(var u=0;u<n&&u<r;u++)if(i[u]!==o[u])return c(i[u],o[u]);return u===n?c(e,o[u],-1):c(i[u],t,1)},[0,0].sort(x),S=!k,w.uniqueSort=function(e){var t,n=[],r=1,i=0;k=S,e.sort(x);if(k){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},w.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},y=w.compile=function(e,t){var n,r=[],i=[],o=I[j][e+" "];if(!o){t||(t=h(e)),n=t.length;while(n--)o=d(t[n]),o[j]?r.push(o):i.push(o);o=I(e,a(i,r))}return o},L.querySelectorAll&&function(){var r,f=u,p=/'|\\/g,i=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,d=[":focus"],o=[":active"],a=H.matchesSelector||H.mozMatchesSelector||H.webkitMatchesSelector||H.oMatchesSelector||H.msMatchesSelector;ue(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+z+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||d.push(":checked")}),ue(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&d.push("[*^$]="+z+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled")}),d=new RegExp(d.join("|")),u=function(e,t,n,r,i){if(!r&&!i&&!d.test(e)){var o,a,s=!0,l=j,u=t,c=t.nodeType===9&&e;if(t.nodeType===1&&t.nodeName.toLowerCase()!=="object"){o=h(e),(s=t.getAttribute("id"))?l=s.replace(p,"\\$&"):t.setAttribute("id",l),l="[id='"+l+"'] ",a=o.length;while(a--)o[a]=l+o[a].join("");u=re.test(e)&&t.parentNode||t,c=o.join(",")}if(c)try{return _.apply(n,q.call(u.querySelectorAll(c),0)),n}catch(e){}finally{s||t.removeAttribute("id")}}return f(e,t,n,r,i)},a&&(ue(function(e){r=a.call(e,"div");try{a.call(e,"[test!='']:sizzle"),o.push("!=",J)}catch(e){}}),o=new RegExp(o.join("|")),w.matchesSelector=function(e,t){t=t.replace(i,"='$1']");if(!g(e)&&!o.test(t)&&!d.test(t))try{var n=a.call(e,t);if(n||r||e.document&&e.document.nodeType!==11)return n}catch(e){}return w(t,null,null,[e]).length>0})}(),C.pseudos.nth=C.pseudos.eq,C.filters=o.prototype=C.pseudos,C.setFilters=new o,w.attr=ge.attr,ge.find=w,ge.expr=w.selectors,ge.expr[":"]=ge.expr.pseudos,ge.unique=w.uniqueSort,ge.text=w.getText,ge.isXMLDoc=w.isXML,ge.contains=w.contains}(y);var Me=/Until$/,Oe=/^(?:parents|prev(?:Until|All))/,_e=/^.[^:#\[\.,]*$/,qe=ge.expr.match.needsContext,Be={children:!0,contents:!0,next:!0,prev:!0};ge.fn.extend({find:function(e){var t,n,r,i,o,a,s=this;if(typeof e!="string")return ge(e).filter(function(){for(t=0,n=s.length;t<n;t++)if(ge.contains(s[t],this))return!0});a=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=a.length,ge.find(e,this[t],a);if(t>0)for(i=r;i<a.length;i++)for(o=0;o<r;o++)if(a[o]===a[i]){a.splice(i--,1);break}}return a},has:function(e){var t,n=ge(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(ge.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(r(this,e,!1),"not",e)},filter:function(e){return this.pushStack(r(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?qe.test(e)?ge(e,this.context).index(this[0])>=0:ge.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=qe.test(e)||typeof e!="string"?ge(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(a?a.index(n)>-1:ge.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return o=o.length>1?ge.unique(o):o,this.pushStack(o,"closest",e)},index:function(e){return e?typeof e=="string"?ge.inArray(this[0],ge(e)):ge.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?ge(e,t):ge.makeArray(e&&e.nodeType?[e]:e),r=ge.merge(this.get(),n);return this.pushStack(i(n[0])||i(r[0])?r:ge.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),ge.fn.andSelf=ge.fn.addBack,ge.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return ge.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ge.dir(e,"parentNode",n)},next:function(e){return t(e,"nextSibling")},prev:function(e){return t(e,"previousSibling")},nextAll:function(e){return ge.dir(e,"nextSibling")},prevAll:function(e){return ge.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ge.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ge.dir(e,"previousSibling",n)},siblings:function(e){return ge.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ge.sibling(e.firstChild)},contents:function(e){return ge.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ge.merge([],e.childNodes)}},function(r,i){ge.fn[r]=function(e,t){var n=ge.map(this,i,e);return Me.test(r)||(t=e),t&&typeof t=="string"&&(n=ge.filter(t,n)),n=this.length>1&&!Be[r]?ge.unique(n):n,this.length>1&&Oe.test(r)&&(n=n.reverse()),this.pushStack(n,r,Y.call(arguments).join(","))}}),ge.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?ge.find.matchesSelector(t[0],e)?[t[0]]:[]:ge.find.matches(e,t)},dir:function(e,t,n){var r=[],i=e[t];while(i&&i.nodeType!==9&&(n===C||i.nodeType!==1||!ge(i).is(n)))i.nodeType===1&&r.push(i),i=i[t];return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var We="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Pe=/ jQuery\d+="(?:null|\d+)"/g,Re=/^\s+/,$e=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ie=/<([\w:]+)/,ze=/<tbody/i,Xe=/<|&#?\w+;/,Ue=/<(?:script|style|link)/i,Ye=/<(?:script|object|embed|option|style)/i,Ve=new RegExp("<(?:"+We+")[\\s/>]","i"),Je=/^(?:checkbox|radio)$/,Ge=/checked\s*(?:[^=]|=\s*.checked.)/i,Qe=/\/(java|ecma)script/i,Ke=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Ze={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},et=v(R),tt=et.appendChild(R.createElement("div"));Ze.optgroup=Ze.option,Ze.tbody=Ze.tfoot=Ze.colgroup=Ze.caption=Ze.thead,Ze.th=Ze.td,ge.support.htmlSerialize||(Ze._default=[1,"X<div>","</div>"]),ge.fn.extend({text:function(e){return ge.access(this,function(e){return e===C?ge.text(this):this.empty().append((this[0]&&this[0].ownerDocument||R).createTextNode(e))},null,e,arguments.length)},wrapAll:function(t){if(ge.isFunction(t))return this.each(function(e){ge(this).wrapAll(t.call(this,e))});if(this[0]){var e=ge(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(n){return ge.isFunction(n)?this.each(function(e){ge(this).wrapInner(n.call(this,e))}):this.each(function(){var e=ge(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=ge.isFunction(t);return this.each(function(e){ge(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){ge.nodeName(this,"body")||ge(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!i(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=ge.clean(arguments);return this.pushStack(ge.merge(e,this),"before",this.selector)}},after:function(){if(!i(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=ge.clean(arguments);return this.pushStack(ge.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||ge.filter(e,[n]).length)!t&&n.nodeType===1&&(ge.cleanData(n.getElementsByTagName("*")),ge.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&ge.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return ge.clone(this,e,t)})},html:function(e){return ge.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===C)return t.nodeType===1?t.innerHTML.replace(Pe,""):C;if(typeof e=="string"&&!Ue.test(e)&&(ge.support.htmlSerialize||!Ve.test(e))&&(ge.support.leadingWhitespace||!Re.test(e))&&!Ze[(Ie.exec(e)||["",""])[1].toLowerCase()]){e=e.replace($e,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(ge.cleanData(t.getElementsByTagName("*")),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(r){return i(this[0])?this.length?this.pushStack(ge(ge.isFunction(r)?r():r),"replaceWith",r):this:ge.isFunction(r)?this.each(function(e){var t=ge(this),n=t.html();t.replaceWith(r.call(this,e,n))}):(typeof r!="string"&&(r=ge(r).detach()),this.each(function(){var e=this.nextSibling,t=this.parentNode;ge(this).remove(),e?ge(e).before(r):ge(t).append(r)}))},detach:function(e){return this.remove(e,!0)},domManip:function(n,r,i){n=[].concat.apply([],n);var e,t,o,a,s=0,l=n[0],u=[],c=this.length;if(!ge.support.checkClone&&c>1&&typeof l=="string"&&Ge.test(l))return this.each(function(){ge(this).domManip(n,r,i)});if(ge.isFunction(l))return this.each(function(e){var t=ge(this);n[0]=l.call(this,e,r?t.html():C),t.domManip(n,r,i)});if(this[0]){e=ge.buildFragment(n,this,u),o=e.fragment,t=o.firstChild,o.childNodes.length===1&&(o=t);if(t){r=r&&ge.nodeName(t,"tr");for(a=e.cacheable||c-1;s<c;s++)i.call(r&&ge.nodeName(this[s],"table")?f(this[s],"tbody"):this[s],s===a?o:ge.clone(o,!0,!0))}o=t=null,u.length&&ge.each(u,function(e,t){t.src?ge.ajax?ge.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):ge.error("no ajax"):ge.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Ke,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),ge.buildFragment=function(e,t,n){var r,i,o,a=e[0];return t=t||R,t=!t.nodeType&&t[0]||t,t=t.ownerDocument||t,e.length===1&&typeof a=="string"&&a.length<512&&t===R&&a.charAt(0)==="<"&&!Ye.test(a)&&(ge.support.checkClone||!Ge.test(a))&&(ge.support.html5Clone||!Ve.test(a))&&(i=!0,r=ge.fragments[a],o=r!==C),r||(r=t.createDocumentFragment(),ge.clean(e,t,r,n),i&&(ge.fragments[a]=o&&r)),{fragment:r,cacheable:i}},ge.fragments={},ge.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(s,l){ge.fn[s]=function(e){var t,n=0,r=[],i=ge(e),o=i.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&o===1)return i[l](this[0]),this;for(;n<o;n++)t=(n>0?this.clone(!0):this).get(),ge(i[n])[l](t),r=r.concat(t);return this.pushStack(r,s,i.selector)}}),ge.extend({clone:function(e,t,n){var r,i,o,a;ge.support.html5Clone||ge.isXMLDoc(e)||!Ve.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(tt.innerHTML=e.outerHTML,tt.removeChild(a=tt.firstChild));if((!ge.support.noCloneEvent||!ge.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!ge.isXMLDoc(e)){p(e,a),r=d(e),i=d(a);for(o=0;r[o];++o)i[o]&&p(r[o],i[o])}if(t){l(e,a);if(n){r=d(e),i=d(a);for(o=0;r[o];++o)l(r[o],i[o])}}return r=i=null,a},clean:function(e,t,n,r){var i,o,a,s,l,u,c,f,p,d,h,g,m=t===R&&et,y=[];if(!t||typeof t.createDocumentFragment=="undefined")t=R;for(i=0;(a=e[i])!=null;i++){typeof a=="number"&&(a+="");if(!a)continue;if(typeof a=="string")if(!Xe.test(a))a=t.createTextNode(a);else{m=m||v(t),c=t.createElement("div"),m.appendChild(c),a=a.replace($e,"<$1></$2>"),s=(Ie.exec(a)||["",""])[1].toLowerCase(),l=Ze[s]||Ze._default,u=l[0],c.innerHTML=l[1]+a+l[2];while(u--)c=c.lastChild;if(!ge.support.tbody){f=ze.test(a),p=s==="table"&&!f?c.firstChild&&c.firstChild.childNodes:l[1]==="<table>"&&!f?c.childNodes:[];for(o=p.length-1;o>=0;--o)ge.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!ge.support.leadingWhitespace&&Re.test(a)&&c.insertBefore(t.createTextNode(Re.exec(a)[0]),c.firstChild),a=c.childNodes,c.parentNode.removeChild(c)}a.nodeType?y.push(a):ge.merge(y,a)}c&&(a=c=m=null);if(!ge.support.appendChecked)for(i=0;(a=y[i])!=null;i++)ge.nodeName(a,"input")?b(a):typeof a.getElementsByTagName!="undefined"&&ge.grep(a.getElementsByTagName("input"),b);if(n){h=function(e){if(!e.type||Qe.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(i=0;(a=y[i])!=null;i++)if(!ge.nodeName(a,"script")||!h(a))n.appendChild(a),typeof a.getElementsByTagName!="undefined"&&(g=ge.grep(ge.merge([],a.getElementsByTagName("script")),h),y.splice.apply(y,[i+1,0].concat(g)),i+=g.length)}return y},cleanData:function(e,t){var n,r,i,o,a=0,s=ge.expando,l=ge.cache,u=ge.support.deleteExpando,c=ge.event.special;for(;(i=e[a])!=null;a++)if(t||ge.acceptData(i)){r=i[s],n=r&&l[r];if(n){if(n.events)for(o in n.events)c[o]?ge.event.remove(i,o):ge.removeEvent(i,o,n.handle);l[r]&&(delete l[r],u?delete i[s]:i.removeAttribute?i.removeAttribute(s):i[s]=null,ge.deletedIds.push(r))}}}}),function(){var e,t;ge.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=ge.uaMatch(I.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),ge.browser=t,ge.sub=function(){function n(e,t){return new n.fn.init(e,t)}ge.extend(!0,n,this),n.superclass=this,n.fn=n.prototype=this(),n.fn.constructor=n,n.sub=this.sub,n.fn.init=function(e,t){return t&&t instanceof ge&&!(t instanceof n)&&(t=n(t)),ge.fn.init.call(this,e,t,r)},n.fn.init.prototype=n.fn;var r=n(R);return n}}();var nt,rt,it,ot=/alpha\([^)]*\)/i,at=/opacity=([^)]*)/,st=/^(top|right|bottom|left)$/,lt=/^(none|table(?!-c[ea]).+)/,ut=/^margin/,ct=new RegExp("^("+K+")(.*)$","i"),ft=new RegExp("^("+K+")(?!px)[a-z%]+$","i"),pt=new RegExp("^([-+])=("+K+")","i"),dt={BODY:"block"},ht={position:"absolute",visibility:"hidden",display:"block"},gt={letterSpacing:0,fontWeight:400},mt=["Top","Right","Bottom","Left"],yt=["Webkit","O","Moz","ms"],vt=ge.fn.toggle;ge.fn.extend({css:function(e,t){return ge.access(this,function(e,t,n){return n!==C?ge.style(e,t,n):ge.css(e,t)},e,t,arguments.length>1)},show:function(){return o(this,!0)},hide:function(){return o(this)},toggle:function(e,t){var n=typeof e=="boolean";return ge.isFunction(e)&&ge.isFunction(t)?vt.apply(this,arguments):this.each(function(){(n?e:x(this))?ge(this).show():ge(this).hide()})}}),ge.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:ge.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,o,a,s=ge.camelCase(t),l=e.style;t=ge.cssProps[s]||(ge.cssProps[s]=h(l,s)),a=ge.cssHooks[t]||ge.cssHooks[s];if(n===C)return a&&"get"in a&&(i=a.get(e,!1,r))!==C?i:l[t];o=typeof n,o==="string"&&(i=pt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(ge.css(e,t)),o="number");if(n==null||o==="number"&&isNaN(n))return;o==="number"&&!ge.cssNumber[s]&&(n+="px");if(!a||!("set"in a)||(n=a.set(e,n,r))!==C)try{l[t]=n}catch(e){}},css:function(e,t,n,r){var i,o,a,s=ge.camelCase(t);return t=ge.cssProps[s]||(ge.cssProps[s]=h(e.style,s)),a=ge.cssHooks[t]||ge.cssHooks[s],a&&"get"in a&&(i=a.get(e,!0,r)),i===C&&(i=nt(e,t)),i==="normal"&&t in gt&&(i=gt[t]),n||r!==C?(o=parseFloat(i),n||ge.isNumeric(o)?o||0:i):i},swap:function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=o[i];return r}}),y.getComputedStyle?nt=function(e,t){var n,r,i,o,a=y.getComputedStyle(e,null),s=e.style;return a&&(n=a.getPropertyValue(t)||a[t],n===""&&!ge.contains(e.ownerDocument,e)&&(n=ge.style(e,t)),ft.test(n)&&ut.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=n,n=a.width,s.width=r,s.minWidth=i,s.maxWidth=o)),n}:R.documentElement.currentStyle&&(nt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],o=e.style;return i==null&&o&&o[t]&&(i=o[t]),ft.test(i)&&!st.test(t)&&(n=o.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),o.left=t==="fontSize"?"1em":i,i=o.pixelLeft+"px",o.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),ge.each(["height","width"],function(e,r){ge.cssHooks[r]={get:function(e,t,n){if(t)return e.offsetWidth===0&&lt.test(nt(e,"display"))?ge.swap(e,ht,function(){return m(e,r,n)}):m(e,r,n)},set:function(e,t,n){return a(e,t,n?g(e,r,n,ge.support.boxSizing&&ge.css(e,"boxSizing")==="border-box"):0)}}}),ge.support.opacity||(ge.cssHooks.opacity={get:function(e,t){return at.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=ge.isNumeric(t)?"alpha(opacity="+t*100+")":"",o=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&ge.trim(o.replace(ot,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=ot.test(o)?o.replace(ot,i):o+" "+i}}),ge(function(){ge.support.reliableMarginRight||(ge.cssHooks.marginRight={get:function(e,t){return ge.swap(e,{display:"inline-block"},function(){if(t)return nt(e,"marginRight")})}}),!ge.support.pixelPosition&&ge.fn.position&&ge.each(["top","left"],function(e,r){ge.cssHooks[r]={get:function(e,t){if(t){var n=nt(e,r);return ft.test(n)?ge(e).position()[r]+"px":n}}}})}),ge.expr&&ge.expr.filters&&(ge.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!ge.support.reliableHiddenOffsets&&(e.style&&e.style.display||nt(e,"display"))==="none"},ge.expr.filters.visible=function(e){return!ge.expr.filters.hidden(e)}),ge.each({margin:"",padding:"",border:"Width"},function(i,o){ge.cssHooks[i+o]={expand:function(e){var t,n=typeof e=="string"?e.split(" "):[e],r={};for(t=0;t<4;t++)r[i+mt[t]+o]=n[t]||n[t-2]||n[0];return r}},ut.test(i)||(ge.cssHooks[i+o].set=a)});var bt=/%20/g,xt=/\[\]$/,wt=/\r?\n/g,Tt=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Nt=/^(?:select|textarea)/i;ge.fn.extend({serialize:function(){return ge.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?ge.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Nt.test(this.nodeName)||Tt.test(this.type))}).map(function(e,n){var t=ge(this).val();return t==null?null:ge.isArray(t)?ge.map(t,function(e,t){return{name:n.name,value:e.replace(wt,"\r\n")}}):{name:n.name,value:t.replace(wt,"\r\n")}}).get()}}),ge.param=function(e,t){var n,r=[],i=function(e,t){t=ge.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===C&&(t=ge.ajaxSettings&&ge.ajaxSettings.traditional);if(ge.isArray(e)||e.jquery&&!ge.isPlainObject(e))ge.each(e,function(){i(this.name,this.value)});else for(n in e)T(n,e[n],t,i);return r.join("&").replace(bt,"+")};var Ct,kt,Et=/#.*$/,St=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,At=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,jt=/^(?:GET|HEAD)$/,Dt=/^\/\//,Lt=/\?/,Ht=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ft=/([?&])_=[^&]*/,Mt=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ot=ge.fn.load,_t={},qt={},Bt=["*/"]+["*"];try{kt=$.href}catch(e){kt=R.createElement("a"),kt.href="",kt=kt.href}Ct=Mt.exec(kt.toLowerCase())||[],ge.fn.load=function(e,t,n){if(typeof e!="string"&&Ot)return Ot.apply(this,arguments);if(!this.length)return this;var r,i,o,a=this,s=e.indexOf(" ");return s>=0&&(r=e.slice(s,e.length),e=e.slice(0,s)),ge.isFunction(t)?(n=t,t=C):t&&typeof t=="object"&&(i="POST"),ge.ajax({url:e,type:i,dataType:"html",data:t,complete:function(e,t){n&&a.each(n,o||[e.responseText,t,e])}}).done(function(e){o=arguments,a.html(r?ge("<div>").append(e.replace(Ht,"")).find(r):e)}),this},ge.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){ge.fn[t]=function(e){return this.on(t,e)}}),ge.each(["get","post"],function(e,i){ge[i]=function(e,t,n,r){return ge.isFunction(t)&&(r=r||n,n=t,t=C),ge.ajax({type:i,url:e,data:t,success:n,dataType:r})}}),ge.extend({getScript:function(e,t){return ge.get(e,C,t,"script")},getJSON:function(e,t,n){return ge.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?E(e,ge.ajaxSettings):(t=e,e=ge.ajaxSettings),E(e,t),e},ajaxSettings:{url:kt,isLocal:At.test(Ct[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Bt},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":y.String,"text html":!0,"text json":ge.parseJSON,"text xml":ge.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:N(_t),ajaxTransport:N(qt),ajax:function(e,t){function n(e,t,n,r){var i,o,a,s,l,u=t;if(w===2)return;w=2,d&&clearTimeout(d),p=C,f=r||"",T.readyState=e>0?4:0,n&&(s=S(g,T,n));if(e>=200&&e<300||e===304)g.ifModified&&(l=T.getResponseHeader("Last-Modified"),l&&(ge.lastModified[c]=l),l=T.getResponseHeader("Etag"),l&&(ge.etag[c]=l)),e===304?(u="notmodified",i=!0):(i=A(g,s),u=i.state,o=i.data,a=i.error,i=!a);else{a=u;if(!u||e)u="error",e<0&&(e=0)}T.status=e,T.statusText=(t||u)+"",i?v.resolveWith(m,[o,u,T]):v.rejectWith(m,[T,u,a]),T.statusCode(x),x=C,h&&y.trigger("ajax"+(i?"Success":"Error"),[T,g,i?o:a]),b.fireWith(m,[T,u]),h&&(y.trigger("ajaxComplete",[T,g]),--ge.active||ge.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=C),t=t||{};var c,f,r,p,d,i,h,o,g=ge.ajaxSetup({},t),m=g.context||g,y=m!==g&&(m.nodeType||m instanceof ge)?ge(m):ge.event,v=ge.Deferred(),b=ge.Callbacks("once memory"),x=g.statusCode||{},a={},s={},w=0,l="canceled",T={readyState:0,setRequestHeader:function(e,t){if(!w){var n=e.toLowerCase();e=s[n]=s[n]||e,a[e]=t}return this},getAllResponseHeaders:function(){return w===2?f:null},getResponseHeader:function(e){var t;if(w===2){if(!r){r={};while(t=St.exec(f))r[t[1].toLowerCase()]=t[2]}t=r[e.toLowerCase()]}return t===C?null:t},overrideMimeType:function(e){return w||(g.mimeType=e),this},abort:function(e){return e=e||l,p&&p.abort(e),n(0,e),this}};v.promise(T),T.success=T.done,T.error=T.fail,T.complete=b.add,T.statusCode=function(e){if(e){var t;if(w<2)for(t in e)x[t]=[x[t],e[t]];else t=e[T.status],T.always(t)}return this},g.url=((e||g.url)+"").replace(Et,"").replace(Dt,Ct[1]+"//"),g.dataTypes=ge.trim(g.dataType||"*").toLowerCase().split(ee),g.crossDomain==null&&(i=Mt.exec(g.url.toLowerCase()),g.crossDomain=!(!i||i[1]===Ct[1]&&i[2]===Ct[2]&&(i[3]||(i[1]==="http:"?80:443))==(Ct[3]||(Ct[1]==="http:"?80:443)))),g.data&&g.processData&&typeof g.data!="string"&&(g.data=ge.param(g.data,g.traditional)),k(_t,g,t,T);if(w===2)return T;h=g.global,g.type=g.type.toUpperCase(),g.hasContent=!jt.test(g.type),h&&ge.active++===0&&ge.event.trigger("ajaxStart");if(!g.hasContent){g.data&&(g.url+=(Lt.test(g.url)?"&":"?")+g.data,delete g.data),c=g.url;if(g.cache===!1){var u=ge.now(),N=g.url.replace(Ft,"$1_="+u);g.url=N+(N===g.url?(Lt.test(g.url)?"&":"?")+"_="+u:"")}}(g.data&&g.hasContent&&g.contentType!==!1||t.contentType)&&T.setRequestHeader("Content-Type",g.contentType),g.ifModified&&(c=c||g.url,ge.lastModified[c]&&T.setRequestHeader("If-Modified-Since",ge.lastModified[c]),ge.etag[c]&&T.setRequestHeader("If-None-Match",ge.etag[c])),T.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+(g.dataTypes[0]!=="*"?", "+Bt+"; q=0.01":""):g.accepts["*"]);for(o in g.headers)T.setRequestHeader(o,g.headers[o]);if(!g.beforeSend||g.beforeSend.call(m,T,g)!==!1&&w!==2){l="abort";for(o in{success:1,error:1,complete:1})T[o](g[o]);p=k(qt,g,t,T);if(!p)n(-1,"No Transport");else{T.readyState=1,h&&y.trigger("ajaxSend",[T,g]),g.async&&g.timeout>0&&(d=setTimeout(function(){T.abort("timeout")},g.timeout));try{w=1,p.send(a,n)}catch(e){if(!(w<2))throw e;n(-1,e)}}return T}return T.abort()},active:0,lastModified:{},etag:{}});var Wt=[],Pt=/\?/,Rt=/(=)\?(?=&|$)|\?\?/,$t=ge.now();ge.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Wt.pop()||ge.expando+"_"+$t++;return this[e]=!0,e}}),ge.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=e.data,s=e.url,l=e.jsonp!==!1,u=l&&Rt.test(s),c=l&&!u&&typeof a=="string"&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Rt.test(a);if(e.dataTypes[0]==="jsonp"||u||c)return r=e.jsonpCallback=ge.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,i=y[r],u?e.url=s.replace(Rt,"$1"+r):c?e.data=a.replace(Rt,"$1"+r):l&&(e.url+=(Pt.test(s)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||ge.error(r+" was not called"),o[0]},e.dataTypes[0]="json",y[r]=function(){o=arguments},n.always(function(){y[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Wt.push(r)),o&&ge.isFunction(i)&&i(o[0]),o=i=C}),"script"}),ge.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return ge.globalEval(e),e}}}),ge.ajaxPrefilter("script",function(e){e.cache===C&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ge.ajaxTransport("script",function(t){if(t.crossDomain){var r,i=R.head||R.getElementsByTagName("head")[0]||R.documentElement;return{send:function(e,n){r=R.createElement("script"),r.async="async",t.scriptCharset&&(r.charset=t.scriptCharset),r.src=t.url,r.onload=r.onreadystatechange=function(e,t){if(t||!r.readyState||/loaded|complete/.test(r.readyState))r.onload=r.onreadystatechange=null,i&&r.parentNode&&i.removeChild(r),r=C,t||n(200,"success")},i.insertBefore(r,i.firstChild)},abort:function(){r&&r.onload(0,1)}}}});var It,zt=y.ActiveXObject?function(){for(var e in It)It[e](0,1)}:!1,Xt=0;ge.ajaxSettings.xhr=y.ActiveXObject?function(){return!this.isLocal&&j()||D()}:j,function(e){ge.extend(ge.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(ge.ajaxSettings.xhr()),ge.support.ajax&&ge.ajaxTransport(function(c){if(!c.crossDomain||ge.support.cors){var f;return{send:function(e,s){var l,t,u=c.xhr();c.username?u.open(c.type,c.url,c.async,c.username,c.password):u.open(c.type,c.url,c.async);if(c.xhrFields)for(t in c.xhrFields)u[t]=c.xhrFields[t];c.mimeType&&u.overrideMimeType&&u.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(t in e)u.setRequestHeader(t,e[t])}catch(e){}u.send(c.hasContent&&c.data||null),f=function(e,t){var n,r,i,o,a;try{if(f&&(t||u.readyState===4)){f=C,l&&(u.onreadystatechange=ge.noop,zt&&delete It[l]);if(t)u.readyState!==4&&u.abort();else{n=u.status,i=u.getAllResponseHeaders(),o={},a=u.responseXML,a&&a.documentElement&&(o.xml=a);try{o.text=u.responseText}catch(e){}try{r=u.statusText}catch(e){r=""}!n&&c.isLocal&&!c.crossDomain?n=o.text?200:404:n===1223&&(n=204)}}}catch(e){t||s(-1,e)}o&&s(n,r,o,i)},c.async?u.readyState===4?setTimeout(f,0):(l=++Xt,zt&&(It||(It={},ge(y).unload(zt)),It[l]=f),u.onreadystatechange=f):f()},abort:function(){f&&f(0,1)}}}});var Ut,Yt,Vt=/^(?:toggle|show|hide)$/,Jt=new RegExp("^(?:([-+])=|)("+K+")([a-z%]*)$","i"),Gt=/queueHooks$/,Qt=[O],Kt={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Jt.exec(t),a=i.cur(),s=+a||0,l=1,u=20;if(o){n=+o[2],r=o[3]||(ge.cssNumber[e]?"":"px");if(r!=="px"&&s){s=ge.css(i.elem,e,!0)||n||1;do{l=l||".5",s/=l,ge.style(i.elem,e,s+r)}while(l!==(l=i.cur()/a)&&l!==1&&--u)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};ge.Animation=ge.extend(F,{tweener:function(e,t){ge.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Kt[n]=Kt[n]||[],Kt[n].unshift(t)},prefilter:function(e,t){t?Qt.unshift(e):Qt.push(e)}}),ge.Tween=_,_.prototype={constructor:_,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ge.cssNumber[n]?"":"px")},cur:function(){var e=_.propHooks[this.prop];return e&&e.get?e.get(this):_.propHooks._default.get(this)},run:function(e){var t,n=_.propHooks[this.prop];return this.options.duration?this.pos=t=ge.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):_.propHooks._default.set(this),this}},_.prototype.init.prototype=_.prototype,_.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=ge.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){ge.fx.step[e.prop]?ge.fx.step[e.prop](e):e.elem.style&&(e.elem.style[ge.cssProps[e.prop]]!=null||ge.cssHooks[e.prop])?ge.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},_.propHooks.scrollTop=_.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ge.each(["toggle","show","hide"],function(r,i){var o=ge.fn[i];ge.fn[i]=function(e,t,n){return e==null||typeof e=="boolean"||!r&&ge.isFunction(e)&&ge.isFunction(t)?o.apply(this,arguments):this.animate(q(i,!0),e,t,n)}}),ge.fn.extend({fadeTo:function(e,t,n,r){return this.filter(x).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=ge.isEmptyObject(t),o=ge.speed(e,n,r),a=function(){var e=F(this,ge.extend({},t),o);i&&e.stop(!0)};return i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return typeof i!="string"&&(o=e,e=i,i=C),e&&i!==!1&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=i!=null&&i+"queueHooks",n=ge.timers,r=ge._data(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&Gt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem===this&&(i==null||n[t].queue===i)&&(n[t].anim.stop(o),e=!1,n.splice(t,1));(e||!o)&&ge.dequeue(this,i)})}}),ge.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){ge.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),ge.speed=function(e,t,n){var r=e&&typeof e=="object"?ge.extend({},e):{complete:n||!n&&t||ge.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ge.isFunction(t)&&t};r.duration=ge.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in ge.fx.speeds?ge.fx.speeds[r.duration]:ge.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){ge.isFunction(r.old)&&r.old.call(this),r.queue&&ge.dequeue(this,r.queue)},r},ge.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ge.timers=[],ge.fx=_.prototype.init,ge.fx.tick=function(){var e,t=ge.timers,n=0;Ut=ge.now();for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||ge.fx.stop(),Ut=C},ge.fx.timer=function(e){e()&&ge.timers.push(e)&&!Yt&&(Yt=setInterval(ge.fx.tick,ge.fx.interval))},ge.fx.interval=13,ge.fx.stop=function(){clearInterval(Yt),Yt=null},ge.fx.speeds={slow:600,fast:200,_default:400},ge.fx.step={},ge.expr&&ge.expr.filters&&(ge.expr.filters.animated=function(t){return ge.grep(ge.timers,function(e){return t===e.elem}).length});var Zt=/^(?:body|html)$/i;ge.fn.offset=function(t){if(arguments.length)return t===C?this:this.each(function(e){ge.offset.setOffset(this,t,e)});var e,n,r,i,o,a,s,l={top:0,left:0},u=this[0],c=u&&u.ownerDocument;if(!c)return;return(n=c.body)===u?ge.offset.bodyOffset(u):(e=c.documentElement,ge.contains(e,u)?(typeof u.getBoundingClientRect!="undefined"&&(l=u.getBoundingClientRect()),r=B(c),i=e.clientTop||n.clientTop||0,o=e.clientLeft||n.clientLeft||0,a=r.pageYOffset||e.scrollTop,s=r.pageXOffset||e.scrollLeft,{top:l.top+a-i,left:l.left+s-o}):l)},ge.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return ge.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(ge.css(e,"marginTop"))||0,n+=parseFloat(ge.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=ge.css(e,"position");r==="static"&&(e.style.position="relative");var i=ge(e),o=i.offset(),a=ge.css(e,"top"),s=ge.css(e,"left"),l=(r==="absolute"||r==="fixed")&&ge.inArray("auto",[a,s])>-1,u={},c={},f,p;l?(c=i.position(),f=c.top,p=c.left):(f=parseFloat(a)||0,p=parseFloat(s)||0),ge.isFunction(t)&&(t=t.call(e,n,o)),t.top!=null&&(u.top=t.top-o.top+f),t.left!=null&&(u.left=t.left-o.left+p),"using"in t?t.using.call(e,u):i.css(u)}},ge.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=Zt.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(ge.css(e,"marginTop"))||0,n.left-=parseFloat(ge.css(e,"marginLeft"))||0,r.top+=parseFloat(ge.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(ge.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||R.body;while(e&&!Zt.test(e.nodeName)&&ge.css(e,"position")==="static")e=e.offsetParent;return e||R.body})}}),ge.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o=/Y/.test(i);ge.fn[t]=function(e){return ge.access(this,function(e,t,n){var r=B(e);if(n===C)return r?i in r?r[i]:r.document.documentElement[t]:e[t];r?r.scrollTo(o?ge(r).scrollLeft():n,o?n:ge(r).scrollTop()):e[t]=n},t,e,arguments.length,null)}}),ge.each({Height:"height",Width:"width"},function(o,a){ge.each({padding:"inner"+o,content:a,"":"outer"+o},function(r,e){ge.fn[e]=function(e,t){var n=arguments.length&&(r||typeof e!="boolean"),i=r||(e===!0||t===!0?"margin":"border");return ge.access(this,function(e,t,n){var r;return ge.isWindow(e)?e.document.documentElement["client"+o]:e.nodeType===9?(r=e.documentElement,Math.max(e.body["scroll"+o],r["scroll"+o],e.body["offset"+o],r["offset"+o],r["client"+o])):n===C?ge.css(e,t,n,i):ge.style(e,t,n,i)},a,n?e:C,n,null)}})}),y.jQuery=y.$=ge,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return ge})})(window);
/* Ammina JS file original /bitrix/js/main/popup/dist/main.popup.bundle.js */
this.BX=this.BX||{};(function(e,u,d){"use strict";var a=function(){function n(e){babelHelpers.classCallCheck(this,n);this.popupWindow=null;this.params=e||{};this.text=this.params.text||"";this.id=this.params.id||"";this.className=this.params.className||"";this.events=this.params.events||{};this.contextEvents={};for(var t in this.events){if(d.Type.isFunction(this.events[t])){this.contextEvents[t]=this.events[t].bind(this)}}this.buttonNode=d.Dom.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},events:this.contextEvents,text:this.text})}babelHelpers.createClass(n,[{key:"render",value:function e(){return this.buttonNode}},{key:"getId",value:function e(){return this.id}},{key:"getContainer",value:function e(){return this.buttonNode}},{key:"getName",value:function e(){return this.text}},{key:"setName",value:function e(t){this.text=t||"";if(this.buttonNode){d.Dom.clean(this.buttonNode);d.Dom.adjust(this.buttonNode,{text:this.text})}}},{key:"setClassName",value:function e(t){if(this.buttonNode){if(d.Type.isString(this.className)&&this.className!==""){d.Dom.removeClass(this.buttonNode,this.className)}d.Dom.addClass(this.buttonNode,t)}this.className=t}},{key:"addClassName",value:function e(t){if(this.buttonNode){d.Dom.addClass(this.buttonNode,t);this.className=this.buttonNode.className}}},{key:"removeClassName",value:function e(t){if(this.buttonNode){d.Dom.removeClass(this.buttonNode,t);this.className=this.buttonNode.className}}}]);return n}();function n(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="popup-window-overlay" id="popup-window-overlay-','"></div>\n\t\t\t\t']);n=function e(){return t};return t}function i(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="popup-window-resize" onmousedown="','"></div>\n\t\t\t\t']);i=function e(){return t};return t}function h(){var t=babelHelpers.taggedTemplateLiteral(['<div class="'," ","-",'"></div>']);h=function e(){return t};return t}function l(){var t=babelHelpers.taggedTemplateLiteral(['<div class="popup-window-buttons">',"</div>"]);l=function e(){return t};return t}function r(){var t=babelHelpers.taggedTemplateLiteral(['<div \n\t\t\t\tclass="','" \n\t\t\t\tid="','"\n\t\t\t\tstyle="display: none; position: absolute; left: 0; top: 0; z-index: ','"\n\t\t\t>',"</div>"]);r=function e(){return t};return t}function c(){var t=babelHelpers.taggedTemplateLiteral(['<div id="popup-window-content-','" class="popup-window-content"></div>']);c=function e(){return t};return t}function f(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="','" onclick="','"></span>\n\t\t\t']);f=function e(){return t};return t}function m(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="popup-window-titlebar" id="popup-window-titlebar-','"></div>\n\t\t\t']);m=function e(){return t};return t}var s={onPopupWindowInit:{namespace:"BX.Main.Popup",eventName:"onInit"},onPopupWindowIsInitialized:{namespace:"BX.Main.Popup",eventName:"onAfterInit"},onPopupFirstShow:{namespace:"BX.Main.Popup",eventName:"onFirstShow"},onPopupShow:{namespace:"BX.Main.Popup",eventName:"onShow"},onAfterPopupShow:{namespace:"BX.Main.Popup",eventName:"onAfterShow"},onPopupClose:{namespace:"BX.Main.Popup",eventName:"onClose"},onPopupAfterClose:{namespace:"BX.Main.Popup",eventName:"onAfterClose"},onPopupDestroy:{namespace:"BX.Main.Popup",eventName:"onDestroy"},onPopupFullscreenLeave:{namespace:"BX.Main.Popup",eventName:"onFullscreenLeave"},onPopupFullscreenEnter:{namespace:"BX.Main.Popup",eventName:"onFullscreenEnter"},onPopupDragStart:{namespace:"BX.Main.Popup",eventName:"onDragStart"},onPopupDrag:{namespace:"BX.Main.Popup",eventName:"onDrag"},onPopupDragEnd:{namespace:"BX.Main.Popup",eventName:"onDragEnd"},onPopupResizeStart:{namespace:"BX.Main.Popup",eventName:"onResizeStart"},onPopupResize:{namespace:"BX.Main.Popup",eventName:"onResize"},onPopupResizeEnd:{namespace:"BX.Main.Popup",eventName:"onResizeEnd"}};u.EventEmitter.registerAliases(s);var p=function(e){babelHelpers.inherits(p,e);babelHelpers.createClass(p,null,[{key:"setOptions",value:function e(t){if(!d.Type.isPlainObject(t)){return}for(var n in t){this.options[n]=t[n]}}},{key:"getOption",value:function e(t,n){if(!d.Type.isUndefined(this.options[t])){return this.options[t]}else if(!d.Type.isUndefined(n)){return n}else{return this.defaultOptions[t]}}}]);function p(e){var t;babelHelpers.classCallCheck(this,p);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(p).call(this));t.setEventNamespace("BX.Main.Popup");var n=Array.prototype.slice.call(arguments),i=n[0],s=n[1],o=n[2];t.compatibleMode=o&&d.Type.isBoolean(o.compatibleMode)?o.compatibleMode:true;if(d.Type.isPlainObject(e)&&!s&&!o){o=e;i=e.id;s=e.bindElement;t.compatibleMode=false}o=o||{};t.params=o;if(!d.Type.isStringFilled(i)){i="popup-window-"+d.Text.getRandom().toLowerCase()}t.emit("onInit",new u.BaseEvent({compatData:[i,s,o]}));t.uniquePopupId=i;t.params.zIndex=d.Type.isNumber(o.zIndex)?parseInt(o.zIndex):0;t.params.zIndexAbsolute=d.Type.isNumber(o.zIndexAbsolute)?parseInt(o.zIndexAbsolute):0;t.buttons=o.buttons&&d.Type.isArray(o.buttons)?o.buttons:[];t.offsetTop=p.getOption("offsetTop");t.offsetLeft=p.getOption("offsetLeft");t.firstShow=false;t.bordersWidth=20;t.bindElementPos=null;t.closeIcon=null;t.resizeIcon=null;t.angle=null;t.overlay=null;t.titleBar=null;t.bindOptions=babelHelpers.typeof(o.bindOptions)==="object"?o.bindOptions:{};t.autoHide=o.autoHide===true;t.autoHideHandler=d.Type.isFunction(o.autoHideHandler)?o.autoHideHandler:null;t.handleAutoHide=t.handleAutoHide.bind(babelHelpers.assertThisInitialized(t));t.handleOverlayClick=t.handleOverlayClick.bind(babelHelpers.assertThisInitialized(t));t.isAutoHideBinded=false;t.closeByEsc=o.closeByEsc===true;t.isCloseByEscBinded=false;t.cacheable=true;t.destroyed=false;t.width=null;t.height=null;t.minWidth=null;t.minHeight=null;t.maxWidth=null;t.maxHeight=null;t.padding=null;t.contentPadding=null;t.background=null;t.contentBackground=null;t.appendContainer=document.body;t.dragOptions={cursor:"",callback:function e(){},eventName:""};t.dragged=false;t.dragPageX=0;t.dragPageY=0;t.animationShowClassName=null;t.animationCloseClassName=null;t.animationCloseEventType=null;t.handleDocumentMouseMove=t.handleDocumentMouseMove.bind(babelHelpers.assertThisInitialized(t));t.handleDocumentMouseUp=t.handleDocumentMouseUp.bind(babelHelpers.assertThisInitialized(t));t.handleDocumentKeyUp=t.handleDocumentKeyUp.bind(babelHelpers.assertThisInitialized(t));t.handleResizeWindow=t.handleResizeWindow.bind(babelHelpers.assertThisInitialized(t));t.handleResize=t.handleResize.bind(babelHelpers.assertThisInitialized(t));t.handleMove=t.handleMove.bind(babelHelpers.assertThisInitialized(t));t.onTitleMouseDown=t.onTitleMouseDown.bind(babelHelpers.assertThisInitialized(t));t.handleFullScreen=t.handleFullScreen.bind(babelHelpers.assertThisInitialized(t));t.subscribeFromOptions(o.events);var a="popup-window";if(o.contentColor&&d.Type.isStringFilled(o.contentColor)){a+=" popup-window-content-"+o.contentColor}if(o.titleBar){a+=" popup-window-with-titlebar"}if(o.className&&d.Type.isStringFilled(o.className)){a+=" "+o.className}if(o.darkMode){a+=" popup-window-dark"}if(o.titleBar){t.titleBar=d.Tag.render(m(),i)}if(o.closeIcon){var l="popup-window-close-icon"+(o.titleBar?" popup-window-titlebar-close-icon":"");t.closeIcon=d.Tag.render(f(),l,t.handleCloseIconClick.bind(babelHelpers.assertThisInitialized(t)));if(d.Type.isPlainObject(o.closeIcon)){d.Dom.style(t.closeIcon,o.closeIcon)}}t.contentContainer=d.Tag.render(c(),i);t.popupContainer=d.Tag.render(r(),a,i,t.getZindex(),[t.titleBar,t.contentContainer,t.closeIcon]);t.appendContainer.appendChild(t.popupContainer);t.buttonsContainer=null;if(o.angle){t.setAngle(o.angle)}if(o.overlay){t.setOverlay(o.overlay)}t.setOffset(o);t.setBindElement(s);t.setTitleBar(o.titleBar);t.setContent(o.content);t.setButtons(o.buttons);t.setWidth(o.width);t.setHeight(o.height);t.setMinWidth(o.minWidth);t.setMinHeight(o.minHeight);t.setMaxWidth(o.maxWidth);t.setMaxHeight(o.maxHeight);t.setResizeMode(o.resizable);t.setPadding(o.padding);t.setContentPadding(o.contentPadding);t.setBackground(o.background);t.setContentBackground(o.contentBackground);t.setAnimation(o.animation);t.setCacheable(o.cacheable);if(o.contentNoPaddings){t.setContentPadding(0)}if(o.noAllPaddings){t.setPadding(0);t.setContentPadding(0)}if(o.bindOnResize!==false){d.Event.bind(window,"resize",t.handleResizeWindow)}t.emit("onAfterInit",new u.BaseEvent({compatData:[i,babelHelpers.assertThisInitialized(t)]}));return t}babelHelpers.createClass(p,[{key:"subscribeFromOptions",value:function e(t){babelHelpers.get(babelHelpers.getPrototypeOf(p.prototype),"subscribeFromOptions",this).call(this,t,s)}},{key:"getId",value:function e(){return this.uniquePopupId}},{key:"isCompatibleMode",value:function e(){return this.compatibleMode}},{key:"setContent",value:function e(t){if(!this.contentContainer||!t){return}if(d.Type.isElementNode(t)){d.Dom.clean(this.contentContainer);var n=d.Type.isDomNode(t.parentNode);this.contentContainer.appendChild(t);if(this.isCompatibleMode()||n){t.style.display="block"}}else if(d.Type.isString(t)){this.contentContainer.innerHTML=t}else{this.contentContainer.innerHTML="&nbsp;"}}},{key:"setButtons",value:function e(t){this.buttons=t&&d.Type.isArray(t)?t:[];if(this.buttonsContainer){d.Dom.remove(this.buttonsContainer)}var n=d.Reflection.getClass("BX.UI.Button");if(this.buttons.length>0&&this.contentContainer){var i=[];for(var s=0;s<this.buttons.length;s++){var o=this.buttons[s];if(o instanceof a){o.popupWindow=this;i.push(o.render())}else if(n&&o instanceof n){o.setContext(this);i.push(o.render())}}this.buttonsContainer=this.contentContainer.parentNode.appendChild(d.Tag.render(l(),i))}}},{key:"getButtons",value:function e(){return this.buttons}},{key:"getButton",value:function e(t){for(var n=0;n<this.buttons.length;n++){var i=this.buttons[n];if(i.getId()===t){return i}}return null}},{key:"setBindElement",value:function e(t){if(t===null){this.bindElement=null}else if(babelHelpers.typeof(t)==="object"){if(d.Type.isDomNode(t)||d.Type.isNumber(t.top)&&d.Type.isNumber(t.left)){this.bindElement=t}else if(d.Type.isNumber(t.clientX)&&d.Type.isNumber(t.clientY)){this.bindElement={left:t.pageX,top:t.pageY,bottom:t.pageY}}}}},{key:"getBindElementPos",value:function e(t){if(d.Type.isDomNode(t)){return d.Dom.getPosition(t)}else if(t&&babelHelpers.typeof(t)==="object"){if(!d.Type.isNumber(t.bottom)){t.bottom=t.top}return t}else{var n={innerWidth:window.innerWidth,innerHeight:window.innerHeight};var i={scrollLeft:window.pageXOffset,scrollTop:window.pageYOffset};var s=this.getPopupContainer().offsetWidth;var o=this.getPopupContainer().offsetHeight;this.bindOptions.forceTop=true;return{left:n.innerWidth/2-s/2+i.scrollLeft,top:n.innerHeight/2-o/2+i.scrollTop,bottom:n.innerHeight/2-o/2+i.scrollTop,windowSize:n,windowScroll:i,popupWidth:s,popupHeight:o}}}},{key:"setAngle",value:function e(t){if(t===false){if(this.angle!==null){d.Dom.remove(this.angle.element)}this.angle=null;return}var n="popup-window-angly";if(this.angle===null){var i=this.bindOptions.position&&this.bindOptions.position==="top"?"bottom":"top";var s=p.getOption(i==="top"?"angleMinTop":"angleMinBottom");var o=d.Type.isNumber(t.offset)?t.offset:0;var a=p.getOption("angleLeftOffset",null);if(o>0&&d.Type.isNumber(a)){o+=a-p.defaultOptions.angleLeftOffset}this.angle={element:d.Tag.render(h(),n,n,i),position:i,offset:0,defaultOffset:Math.max(o,s)};this.getPopupContainer().appendChild(this.angle.element)}if(babelHelpers.typeof(t)==="object"&&t.position&&["top","right","bottom","left","hide"].includes(t.position)){d.Dom.removeClass(this.angle.element,n+"-"+this.angle.position);d.Dom.addClass(this.angle.element,n+"-"+t.position);this.angle.position=t.position}if(babelHelpers.typeof(t)==="object"&&d.Type.isNumber(t.offset)){var l=t.offset;var u,r;if(this.angle.position==="top"){u=p.getOption("angleMinTop");r=this.getPopupContainer().offsetWidth-p.getOption("angleMaxTop");r=r<u?Math.max(u,l):r;this.angle.offset=Math.min(Math.max(u,l),r);this.angle.element.style.left=this.angle.offset+"px";this.angle.element.style.marginLeft=0;this.angle.element.style.removeProperty("top")}else if(this.angle.position==="bottom"){u=p.getOption("angleMinBottom");r=this.getPopupContainer().offsetWidth-p.getOption("angleMaxBottom");r=r<u?Math.max(u,l):r;this.angle.offset=Math.min(Math.max(u,l),r);this.angle.element.style.marginLeft=this.angle.offset+"px";this.angle.element.style.left=0;this.angle.element.style.removeProperty("top")}else if(this.angle.position==="right"){u=p.getOption("angleMinRight");r=this.getPopupContainer().offsetHeight-p.getOption("angleMaxRight");r=r<u?Math.max(u,l):r;this.angle.offset=Math.min(Math.max(u,l),r);this.angle.element.style.top=this.angle.offset+"px";this.angle.element.style.removeProperty("left");this.angle.element.style.removeProperty("margin-left")}else if(this.angle.position==="left"){u=p.getOption("angleMinLeft");r=this.getPopupContainer().offsetHeight-p.getOption("angleMaxLeft");r=r<u?Math.max(u,l):r;this.angle.offset=Math.min(Math.max(u,l),r);this.angle.element.style.top=this.angle.offset+"px";this.angle.element.style.removeProperty("left");this.angle.element.style.removeProperty("margin-left")}}}},{key:"getWidth",value:function e(){return this.width}},{key:"setWidth",value:function e(t){this.setWidthProperty("width",t)}},{key:"getHeight",value:function e(){return this.height}},{key:"setHeight",value:function e(t){this.setHeightProperty("height",t)}},{key:"getMinWidth",value:function e(){return this.minWidth}},{key:"setMinWidth",value:function e(t){this.setWidthProperty("minWidth",t)}},{key:"getMinHeight",value:function e(){return this.minHeight}},{key:"setMinHeight",value:function e(t){this.setHeightProperty("minHeight",t)}},{key:"getMaxWidth",value:function e(){return this.maxWidth}},{key:"setMaxWidth",value:function e(t){this.setWidthProperty("maxWidth",t)}},{key:"getMaxHeight",value:function e(){return this.maxHeight}},{key:"setMaxHeight",value:function e(t){this.setHeightProperty("maxHeight",t)}},{key:"setWidthProperty",value:function e(t,n){var i=["width","minWidth","maxWidth"];if(i.indexOf(t)===-1){return}if(d.Type.isNumber(n)&&n>=0){this[t]=n;this.getResizableContainer().style[t]=n+"px";this.getContentContainer().style.overflowX="auto";this.getPopupContainer().classList.add("popup-window-fixed-width");if(this.getTitleContainer()&&d.Browser.isIE11()){this.getTitleContainer().style[t]=n+"px"}}else if(n===null||n===false){this[t]=null;this.getResizableContainer().style.removeProperty(d.Text.toKebabCase(t));var s=i.some(function(e){return this.getResizableContainer().style.getPropertyValue(d.Text.toKebabCase(e))!==""},this);if(!s){this.getContentContainer().style.removeProperty("overflow-x");this.getPopupContainer().classList.remove("popup-window-fixed-width")}if(this.getTitleContainer()&&d.Browser.isIE11()){this.getTitleContainer().style.removeProperty(d.Text.toKebabCase(t))}}}},{key:"setHeightProperty",value:function e(t,n){var i=["height","minHeight","maxHeight"];if(i.indexOf(t)===-1){return}if(d.Type.isNumber(n)&&n>=0){this[t]=n;this.getResizableContainer().style[t]=n+"px";this.getContentContainer().style.overflowY="auto";this.getPopupContainer().classList.add("popup-window-fixed-height")}else if(n===null||n===false){this[t]=null;this.getResizableContainer().style.removeProperty(d.Text.toKebabCase(t));var s=i.some(function(e){return this.getResizableContainer().style.getPropertyValue(d.Text.toKebabCase(e))!==""},this);if(!s){this.getContentContainer().style.removeProperty("overflow-y");this.getPopupContainer().classList.remove("popup-window-fixed-height")}}}},{key:"setPadding",value:function e(t){if(d.Type.isNumber(t)&&t>=0){this.padding=t;this.getPopupContainer().style.padding=t+"px"}else if(t===null){this.padding=null;this.getPopupContainer().style.removeProperty("padding")}}},{key:"getPadding",value:function e(){return this.padding}},{key:"setContentPadding",value:function e(t){if(d.Type.isNumber(t)&&t>=0){this.contentPadding=t;this.getContentContainer().style.padding=t+"px"}else if(t===null){this.contentPadding=null;this.getContentContainer().style.removeProperty("padding")}}},{key:"getContentPadding",value:function e(){return this.contentPadding}},{key:"setBackground",value:function e(t){if(d.Type.isStringFilled(t)){this.background=t;this.getPopupContainer().style.background=t}else if(t===null){this.background=null;this.getPopupContainer().style.removeProperty("background")}}},{key:"getBackground",value:function e(){return this.background}},{key:"setContentBackground",value:function e(t){if(d.Type.isStringFilled(t)){this.contentBackground=t;this.getContentContainer().style.background=t}else if(t===null){this.contentBackground=null;this.getContentContainer().style.removeProperty("background")}}},{key:"getContentBackground",value:function e(){return this.contentBackground}},{key:"isDestroyed",value:function e(){return this.destroyed}},{key:"setCacheable",value:function e(t){this.cacheable=t!==false}},{key:"isCacheable",value:function e(){return this.cacheable}},{key:"setResizeMode",value:function e(t){if(t===true||d.Type.isPlainObject(t)){if(!this.resizeIcon){this.resizeIcon=d.Tag.render(i(),this.handleResizeMouseDown.bind(this));this.getPopupContainer().appendChild(this.resizeIcon)}this.setMinWidth(t.minWidth);this.setMinHeight(t.minHeight)}else if(t===false&&this.resizeIcon){d.Dom.remove(this.resizeIcon);this.resizeIcon=null}}},{key:"getPopupContainer",value:function e(){return this.popupContainer}},{key:"getContentContainer",value:function e(){return this.contentContainer}},{key:"getResizableContainer",value:function e(){return d.Browser.isIE11()?this.getContentContainer():this.getPopupContainer()}},{key:"getTitleContainer",value:function e(){return this.titleBar}},{key:"onTitleMouseDown",value:function e(t){this._startDrag(t,{cursor:"move",callback:this.handleMove,eventName:"Drag"})}},{key:"handleResizeMouseDown",value:function e(t){this._startDrag(t,{cursor:"nwse-resize",eventName:"Resize",callback:this.handleResize});this.resizeContentPos=d.Dom.getPosition(this.getResizableContainer());this.resizeContentOffset=this.resizeContentPos.left-d.Dom.getPosition(this.getPopupContainer()).left}},{key:"handleResize",value:function e(t,n,i,s){var o=i-this.resizeContentPos.left;var a=s-this.resizeContentPos.top;var l=document.documentElement.scrollWidth;if(this.resizeContentPos.left+o+this.resizeContentOffset>=l){o=l-this.resizeContentPos.left-this.resizeContentOffset}o=Math.max(o,this.getMinWidth());a=Math.max(a,this.getMinHeight());if(this.getMaxWidth()!==null){o=Math.min(o,this.getMaxWidth())}if(this.getMaxHeight()!==null){a=Math.min(a,this.getMaxHeight())}this.setWidth(o);this.setHeight(a)}},{key:"isTopAngle",value:function e(){return this.angle!==null&&this.angle.position==="top"}},{key:"isBottomAngle",value:function e(){return this.angle!==null&&this.angle.position==="bottom"}},{key:"isTopOrBottomAngle",value:function e(){return this.angle!==null&&(this.angle.position==="top"||this.angle.position==="bottom")}},{key:"getAngleHeight",value:function e(){return this.isTopOrBottomAngle()?p.getOption("angleTopOffset"):0}},{key:"setOffset",value:function e(t){if(!d.Type.isPlainObject(t)){return}if(d.Type.isNumber(t.offsetLeft)){this.offsetLeft=t.offsetLeft+p.getOption("offsetLeft")}if(d.Type.isNumber(t.offsetTop)){this.offsetTop=t.offsetTop+p.getOption("offsetTop")}}},{key:"setTitleBar",value:function e(t){if(!this.titleBar){return}if(babelHelpers.typeof(t)==="object"&&d.Type.isDomNode(t.content)){this.titleBar.innerHTML="";this.titleBar.appendChild(t.content)}else if(typeof t==="string"){this.titleBar.innerHTML="";this.titleBar.appendChild(d.Dom.create("span",{props:{className:"popup-window-titlebar-text"},text:t}))}if(this.params.draggable){this.titleBar.style.cursor="move";d.Event.bind(this.titleBar,"mousedown",this.onTitleMouseDown)}}},{key:"setClosingByEsc",value:function e(t){t=d.Type.isBoolean(t)?t:true;if(t){this.closeByEsc=true;this.bindClosingByEsc()}else{this.closeByEsc=false;this.unbindClosingByEsc()}}},{key:"bindClosingByEsc",value:function e(){if(this.closeByEsc&&!this.isCloseByEscBinded){d.Event.bind(document,"keyup",this.handleDocumentKeyUp);this.isCloseByEscBinded=true}}},{key:"unbindClosingByEsc",value:function e(){if(this.isCloseByEscBinded){d.Event.unbind(document,"keyup",this.handleDocumentKeyUp);this.isCloseByEscBinded=false}}},{key:"setAutoHide",value:function e(t){t=d.Type.isBoolean(t)?t:true;if(t){this.autoHide=true;this.bindAutoHide()}else{this.autoHide=false;this.unbindAutoHide()}}},{key:"bindAutoHide",value:function e(){if(this.autoHide&&!this.isAutoHideBinded&&this.isShown()){this.isAutoHideBinded=true;if(this.isCompatibleMode()){d.Event.bind(this.getPopupContainer(),"click",this.handleContainerClick)}if(this.overlay&&this.overlay.element){d.Event.bind(this.overlay.element,"click",this.handleOverlayClick)}else{if(this.isCompatibleMode()){d.Event.bind(document,"click",this.handleAutoHide)}else{document.addEventListener("click",this.handleAutoHide,true)}}}}},{key:"unbindAutoHide",value:function e(){if(this.isAutoHideBinded){this.isAutoHideBinded=false;if(this.isCompatibleMode()){d.Event.unbind(this.getPopupContainer(),"click",this.handleContainerClick)}if(this.overlay&&this.overlay.element){d.Event.unbind(this.overlay.element,"click",this.handleOverlayClick)}else{if(this.isCompatibleMode()){d.Event.unbind(document,"click",this.handleAutoHide)}else{document.removeEventListener("click",this.handleAutoHide,true)}}}}},{key:"handleAutoHide",value:function e(t){if(this.isDestroyed()){return}if(this.autoHideHandler!==null){if(this.autoHideHandler(t)){this._tryCloseByEvent(t)}}else if(t.target!==this.getPopupContainer()&&!this.getPopupContainer().contains(t.target)){this._tryCloseByEvent(t)}}},{key:"_tryCloseByEvent",value:function e(t){var n=this;if(this.isCompatibleMode()){this.tryCloseByEvent(t)}else{setTimeout(function(){n.tryCloseByEvent(t)},0)}}},{key:"tryCloseByEvent",value:function e(t){if(t.button===0){this.close()}}},{key:"handleOverlayClick",value:function e(t){this.tryCloseByEvent(t);t.stopPropagation()}},{key:"setOverlay",value:function e(t){if(this.overlay===null){this.overlay={element:d.Tag.render(n(),this.getId())};this.adjustOverlayZindex();this.resizeOverlay();this.appendContainer.appendChild(this.overlay.element)}if(t&&d.Type.isNumber(t.opacity)&&t.opacity>=0&&t.opacity<=100){this.overlay.element.style.opacity=parseFloat(t.opacity/100).toPrecision(3)}if(t&&t.backgroundColor){this.overlay.element.style.backgroundColor=t.backgroundColor}}},{key:"removeOverlay",value:function e(){if(this.overlay!==null&&this.overlay.element!==null){d.Dom.remove(this.overlay.element)}if(this.overlayTimeout){clearInterval(this.overlayTimeout);this.overlayTimeout=null}this.overlay=null}},{key:"hideOverlay",value:function e(){if(this.overlay!==null&&this.overlay.element!==null){if(this.overlayTimeout){clearInterval(this.overlayTimeout);this.overlayTimeout=null}this.overlay.element.style.display="none"}}},{key:"showOverlay",value:function e(){var t=this;if(this.overlay!==null&&this.overlay.element!==null){this.overlay.element.style.display="block";var n=this.getPopupContainer().offsetHeight;this.overlayTimeout=setInterval(function(){if(n!==t.getPopupContainer().offsetHeight){t.resizeOverlay();n=t.getPopupContainer().offsetHeight}},1e3)}}},{key:"resizeOverlay",value:function e(){if(this.overlay!==null&&this.overlay.element!==null){var t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);this.overlay.element.style.width=document.documentElement.scrollWidth+"px";this.overlay.element.style.height=t+"px"}}},{key:"getZindex",value:function e(){if(this.overlay!==null){return this.params.zIndexAbsolute>0?this.params.zIndexAbsolute:p.getOption("popupOverlayZindex")+this.params.zIndex}else{return this.params.zIndexAbsolute>0?this.params.zIndexAbsolute:p.getOption("popupZindex")+this.params.zIndex}}},{key:"adjustOverlayZindex",value:function e(){if(this.overlay!==null&&this.overlay.element!==null){this.overlay.element.style.zIndex=parseInt(this.getPopupContainer().style.zIndex)-1}}},{key:"show",value:function e(){var t=this;if(this.isShown()||this.isDestroyed()){return}if(!this.firstShow){this.emit("onFirstShow",new u.BaseEvent({compatData:[this]}));this.firstShow=true}this.emit("onShow",new u.BaseEvent({compatData:[this]}));this.showOverlay();this.getPopupContainer().style.display="block";this.adjustPosition();this.animateOpening(function(){if(t.isDestroyed()){return}d.Dom.removeClass(t.getPopupContainer(),t.animationShowClassName);t.emit("onAfterShow",new u.BaseEvent({compatData:[t]}))});this.bindClosingByEsc();if(this.isCompatibleMode()){setTimeout(function(){t.bindAutoHide()},100)}else{this.bindAutoHide()}}},{key:"close",value:function e(){var t=this;if(this.isDestroyed()||!this.isShown()){return}this.emit("onClose",new u.BaseEvent({compatData:[this]}));if(this.isDestroyed()){return}this.animateClosing(function(){if(t.isDestroyed()){return}t.hideOverlay();t.getPopupContainer().style.display="none";d.Dom.removeClass(t.getPopupContainer(),t.animationCloseClassName);t.unbindClosingByEsc();if(t.isCompatibleMode()){setTimeout(function(){t.unbindAutoHide()},0)}else{t.unbindAutoHide()}t.emit("onAfterClose",new u.BaseEvent({compatData:[t]}));if(!t.isCacheable()){t.destroy()}})}},{key:"toggle",value:function e(){this.isShown()?this.close():this.show()}},{key:"animateOpening",value:function e(t){d.Dom.removeClass(this.getPopupContainer(),this.animationCloseClassName);if(this.animationShowClassName!==null){d.Dom.addClass(this.getPopupContainer(),this.animationShowClassName);if(this.animationCloseEventType!==null){var n=this.animationCloseEventType+"end";this.getPopupContainer().addEventListener(n,function e(){this.removeEventListener(n,e);t()})}else{t()}}else{t()}}},{key:"animateClosing",value:function e(t){d.Dom.removeClass(this.getPopupContainer(),this.animationShowClassName);if(this.animationCloseClassName!==null){d.Dom.addClass(this.getPopupContainer(),this.animationCloseClassName);if(this.animationCloseEventType!==null){var n=this.animationCloseEventType+"end";this.getPopupContainer().addEventListener(n,function e(){this.removeEventListener(n,e);t()})}else{t()}}else{t()}}},{key:"setAnimation",value:function e(t){if(d.Type.isPlainObject(t)){this.animationShowClassName=d.Type.isStringFilled(t.showClassName)?t.showClassName:null;this.animationCloseClassName=d.Type.isStringFilled(t.closeClassName)?t.closeClassName:null;this.animationCloseEventType=t.closeAnimationType==="animation"||t.closeAnimationType==="transition"?t.closeAnimationType:null}else if(d.Type.isStringFilled(t)){var n=t;if(n==="fading"){this.animationShowClassName="popup-window-show-animation-opacity";this.animationCloseClassName="popup-window-close-animation-opacity";this.animationCloseEventType="animation"}else if(n==="fading-slide"){this.animationShowClassName="popup-window-show-animation-opacity-transform";this.animationCloseClassName="popup-window-close-animation-opacity";this.animationCloseEventType="animation"}else if(n==="scale"){this.animationShowClassName="popup-window-show-animation-scale";this.animationCloseClassName="popup-window-close-animation-opacity";this.animationCloseEventType="animation"}}else if(t===false||t===null){this.animationShowClassName=null;this.animationCloseClassName=null;this.animationCloseEventType=null}}},{key:"isShown",value:function e(){return!this.isDestroyed()&&this.getPopupContainer().style.display==="block"}},{key:"destroy",value:function e(){var t=this;if(this.destroyed){return}this.destroyed=true;this.emit("onDestroy",new u.BaseEvent({compatData:[this]}));this.unbindClosingByEsc();if(this.isCompatibleMode()){setTimeout(function(){t.unbindAutoHide()},0)}else{this.unbindAutoHide()}d.Event.unbindAll(this);d.Event.unbind(document,"mousemove",this.handleDocumentMouseMove);d.Event.unbind(document,"mouseup",this.handleDocumentMouseUp);d.Event.unbind(window,"resize",this.handleResizeWindow);d.Dom.remove(this.popupContainer);this.removeOverlay();this.popupContainer=null;this.contentContainer=null;this.closeIcon=null;this.titleBar=null;this.buttonsContainer=null;this.angle=null;this.resizeIcon=null}},{key:"adjustPosition",value:function e(t){if(t&&babelHelpers.typeof(t)==="object"){this.bindOptions=t}var n=this.getBindElementPos(this.bindElement);if(!this.bindOptions.forceBindPosition&&this.bindElementPos!==null&&n.top===this.bindElementPos.top&&n.left===this.bindElementPos.left){return}this.bindElementPos=n;var i=n.windowSize?n.windowSize:{innerWidth:window.innerWidth,innerHeight:window.innerHeight};var s=n.windowScroll?n.windowScroll:{scrollLeft:window.pageXOffset,scrollTop:window.pageYOffset};var o=n.popupWidth?n.popupWidth:this.popupContainer.offsetWidth;var a=n.popupHeight?n.popupHeight:this.popupContainer.offsetHeight;var l=p.getOption("angleTopOffset");var u=this.bindElementPos.left+this.offsetLeft-(this.isTopOrBottomAngle()?p.getOption("angleLeftOffset"):0);if(!this.bindOptions.forceLeft&&u+o+this.bordersWidth>=i.innerWidth+s.scrollLeft&&i.innerWidth+s.scrollLeft-o-this.bordersWidth>0){var r=u;u=i.innerWidth+s.scrollLeft-o-this.bordersWidth;if(this.isTopOrBottomAngle()){this.setAngle({offset:r-u+this.angle.defaultOffset})}}else if(this.isTopOrBottomAngle()){this.setAngle({offset:this.angle.defaultOffset+(u<0?u:0)})}if(u<0){u=0}var h=0;if(this.bindOptions.position&&this.bindOptions.position==="top"){h=this.bindElementPos.top-a-this.offsetTop-(this.isBottomAngle()?l:0);if(h<0||!this.bindOptions.forceTop&&h<s.scrollTop){h=this.bindElementPos.bottom+this.offsetTop;if(this.angle!==null){h+=l;this.setAngle({position:"top"})}}else if(this.isTopAngle()){h=h-l+p.getOption("positionTopXOffset");this.setAngle({position:"bottom"})}else{h+=p.getOption("positionTopXOffset")}}else{h=this.bindElementPos.bottom+this.offsetTop+this.getAngleHeight();if(!this.bindOptions.forceTop&&h+a>i.innerHeight+s.scrollTop&&this.bindElementPos.top-a-this.getAngleHeight()>=0){h=this.bindElementPos.top-a;if(this.isTopOrBottomAngle()){h-=l;this.setAngle({position:"bottom"})}h+=p.getOption("positionTopXOffset")}else if(this.isBottomAngle()){h+=l;this.setAngle({position:"top"})}}if(h<0){h=0}d.Dom.adjust(this.popupContainer,{style:{top:h+"px",left:u+"px",zIndex:this.getZindex()}});this.adjustOverlayZindex()}},{key:"enterFullScreen",value:function e(){if(p.fullscreenStatus){if(document.cancelFullScreen){document.cancelFullScreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}}else{if(this.contentContainer.requestFullScreen){this.contentContainer.requestFullScreen();d.Event.bind(window,"fullscreenchange",this.handleFullScreen)}else if(this.contentContainer.mozRequestFullScreen){this.contentContainer.mozRequestFullScreen();d.Event.bind(window,"mozfullscreenchange",this.handleFullScreen)}else if(this.contentContainer.webkitRequestFullScreen){this.contentContainer.webkitRequestFullScreen();d.Event.bind(window,"webkitfullscreenchange",this.handleFullScreen)}else{console.log("fullscreen mode is not supported")}}}},{key:"handleFullScreen",value:function e(t){if(p.fullscreenStatus){d.Event.unbind(window,"fullscreenchange",this.handleFullScreen);d.Event.unbind(window,"webkitfullscreenchange",this.handleFullScreen);d.Event.unbind(window,"mozfullscreenchange",this.handleFullScreen);p.fullscreenStatus=false;if(!this.isDestroyed()){d.Dom.removeClass(this.contentContainer,"popup-window-fullscreen");this.emit("onFullscreenLeave");this.adjustPosition()}}else{p.fullscreenStatus=true;if(!this.isDestroyed()){d.Dom.addClass(this.contentContainer,"popup-window-fullscreen");this.emit("onFullscreenEnter");this.adjustPosition()}}}},{key:"handleCloseIconClick",value:function e(t){this.tryCloseByEvent(t);t.stopPropagation()}},{key:"handleContainerClick",value:function e(t){t.stopPropagation()}},{key:"handleDocumentKeyUp",value:function e(t){var n=this;if(t.keyCode===27){v(this.getZindex(),function(){n.close()})}}},{key:"handleResizeWindow",value:function e(){if(this.isShown()){this.adjustPosition();if(this.overlay!==null){this.resizeOverlay()}}}},{key:"handleMove",value:function e(t,n,i,s){var o=parseInt(this.popupContainer.style.left)+t;var a=parseInt(this.popupContainer.style.top)+n;if(babelHelpers.typeof(this.params.draggable)==="object"&&this.params.draggable.restrict){if(o<0){o=0}var l=document.documentElement.scrollWidth;var u=document.documentElement.scrollHeight;var r=this.popupContainer.offsetWidth;var h=this.popupContainer.offsetHeight;if(o>l-r){o=l-r}if(a>u-h){a=u-h}if(a<0){a=0}}this.popupContainer.style.left=o+"px";this.popupContainer.style.top=a+"px"}},{key:"_startDrag",value:function e(t,n){n=n||{};if(d.Type.isStringFilled(n.cursor)){this.dragOptions.cursor=n.cursor}if(d.Type.isStringFilled(n.eventName)){this.dragOptions.eventName=n.eventName}if(d.Type.isFunction(n.callback)){this.dragOptions.callback=n.callback}this.dragPageX=t.pageX;this.dragPageY=t.pageY;this.dragged=false;d.Event.bind(document,"mousemove",this.handleDocumentMouseMove);d.Event.bind(document,"mouseup",this.handleDocumentMouseUp);if(document.body.setCapture){document.body.setCapture()}document.body.ondrag=function(){return false};document.body.onselectstart=function(){return false};document.body.style.cursor=this.dragOptions.cursor;document.body.style.MozUserSelect="none";this.popupContainer.style.MozUserSelect="none";t.preventDefault()}},{key:"handleDocumentMouseMove",value:function e(t){if(this.dragPageX===t.pageX&&this.dragPageY===t.pageY){return}this.dragOptions.callback(t.pageX-this.dragPageX,t.pageY-this.dragPageY,t.pageX,t.pageY);this.dragPageX=t.pageX;this.dragPageY=t.pageY;if(!this.dragged){this.emit("on".concat(this.dragOptions.eventName,"Start"),new u.BaseEvent({compatData:[this]}));this.dragged=true}this.emit("on".concat(this.dragOptions.eventName),new u.BaseEvent({compatData:[this]}))}},{key:"handleDocumentMouseUp",value:function e(t){if(document.body.releaseCapture){document.body.releaseCapture()}d.Event.unbind(document,"mousemove",this.handleDocumentMouseMove);d.Event.unbind(document,"mouseup",this.handleDocumentMouseUp);document.body.ondrag=null;document.body.onselectstart=null;document.body.style.cursor="";document.body.style.MozUserSelect="";this.popupContainer.style.MozUserSelect="";this.emit("on".concat(this.dragOptions.eventName,"End"),new u.BaseEvent({compatData:[this]}));this.dragged=false;t.preventDefault()}}]);return p}(u.EventEmitter);babelHelpers.defineProperty(p,"options",{});babelHelpers.defineProperty(p,"defaultOptions",{angleLeftOffset:40,positionTopXOffset:-11,angleTopOffset:10,popupZindex:1e3,popupOverlayZindex:1100,angleMinLeft:10,angleMaxLeft:30,angleMinRight:10,angleMaxRight:30,angleMinBottom:23,angleMaxBottom:25,angleMinTop:23,angleMaxTop:25,offsetLeft:0,offsetTop:0});var o=-1;var g=null;function v(e,t){if(e===false){if(g&&g.length>0){for(var n=0;n<g.length;n++){g[n]()}g=null;o=-1}}else{if(g===null){g=[];o=-1;setTimeout(function(){v(false)},10)}if(e>o){o=e;g=[t]}else if(e===o){g.push(t)}}}var t=function(){function e(){babelHelpers.classCallCheck(this,e);throw new Error("You cannot make an instance of PopupManager.")}babelHelpers.createClass(e,null,[{key:"create",value:function e(t){var n=Array.prototype.slice.call(arguments),i=n[0],s=n[1],o=n[2];var a=i;var l=true;if(d.Type.isPlainObject(i)&&!s&&!o){l=false;a=i.id;if(!d.Type.isStringFilled(a)){throw new Error('BX.Main.Popup.Manager: "id" parameter is required.')}}var u=this.getPopupById(a);if(u===null){u=l?new p(i,s,o):new p(t);u.subscribe("onShow",this.handlePopupShow);u.subscribe("onClose",this.handlePopupClose)}return u}},{key:"handleOnAfterInit",value:function e(t){t.getTarget().subscribeOnce("onDestroy",this.handlePopupDestroy);this._popups.forEach(function(e){if(e.getId()===t.getTarget().getId()){console.error("Duplicate id (".concat(e.getId(),") for the BX.Main.Popup instance."))}});this._popups.push(t.getTarget())}},{key:"handlePopupDestroy",value:function e(t){this._popups=this._popups.filter(function(e){return e!==t.getTarget()})}},{key:"handlePopupShow",value:function e(t){if(this._currentPopup!==null){this._currentPopup.close()}this._currentPopup=t.getTarget()}},{key:"handlePopupClose",value:function e(){this._currentPopup=null}},{key:"getCurrentPopup",value:function e(){return this._currentPopup}},{key:"isPopupExists",value:function e(t){return this.getPopupById(t)!==null}},{key:"isAnyPopupShown",value:function e(){for(var t=0,n=this._popups.length;t<n;t++){if(this._popups[t].isShown()){return true}}return false}},{key:"getPopupById",value:function e(t){for(var n=0;n<this._popups.length;n++){if(this._popups[n].getId()===t){return this._popups[n]}}return null}},{key:"getMaxZIndex",value:function e(){var t=0;for(var n=0;n<this._popups.length;n++){t=Math.max(t,this._popups[n].params.zIndex)}return t}}]);return e}();babelHelpers.defineProperty(t,"_popups",[]);babelHelpers.defineProperty(t,"_currentPopup",null);t.handlePopupDestroy=t.handlePopupDestroy.bind(t);t.handlePopupShow=t.handlePopupShow.bind(t);t.handlePopupClose=t.handlePopupClose.bind(t);t.handleOnAfterInit=t.handleOnAfterInit.bind(t);u.EventEmitter.subscribe("BX.Main.Popup:onAfterInit",t.handleOnAfterInit);function b(){var t=babelHelpers.taggedTemplateLiteral(['<span class="popup-window-delimiter">']);b=function e(){return t};return t}var y={onSubMenuShow:{namespace:"BX.Main.Menu.Item",eventName:"SubMenu:onShow"},onSubMenuClose:{namespace:"BX.Main.Menu.Item",eventName:"SubMenu:onClose"}};u.EventEmitter.registerAliases(y);var C=function(e){babelHelpers.inherits(i,e);function i(e){var t;babelHelpers.classCallCheck(this,i);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));t.setEventNamespace("BX.Main.Menu.Item");e=e||{};t.options=e;t.id=e.id||d.Text.getRandom();t.text=d.Type.isStringFilled(e.text)?e.text:"";t.title=d.Type.isStringFilled(e.title)?e.title:"";t.delimiter=e.delimiter===true;t.href=d.Type.isStringFilled(e.href)?e.href:null;t.target=d.Type.isStringFilled(e.target)?e.target:null;t.dataset=d.Type.isPlainObject(e.dataset)?e.dataset:null;t.className=d.Type.isStringFilled(e.className)?e.className:null;t.menuShowDelay=d.Type.isNumber(e.menuShowDelay)?e.menuShowDelay:300;t.subMenuOffsetX=d.Type.isNumber(e.subMenuOffsetX)?e.subMenuOffsetX:4;t._items=d.Type.isArray(e.items)?e.items:[];t.disabled=e.disabled===true;t.cacheable=e.cacheable===true;t.onclick=d.Type.isStringFilled(e.onclick)||d.Type.isFunction(e.onclick)?e.onclick:null;t.subscribeFromOptions(e.events,y);t.menuWindow=null;t.subMenuWindow=null;t.layout={item:null,text:null};t.getLayout();t.events={};t.items=[];for(var n in e){if(e.hasOwnProperty(n)&&typeof t[n]==="undefined"){t[n]=e[n]}}return t}babelHelpers.createClass(i,[{key:"getLayout",value:function e(){if(this.layout.item){return this.layout}if(this.delimiter){if(d.Type.isStringFilled(this.text)){this.layout.item=d.Dom.create("span",{props:{className:"popup-window-delimiter-section"},children:[this.layout.text=d.Dom.create("span",{props:{className:"popup-window-delimiter-text"},html:this.text})]})}else{this.layout.item=d.Tag.render(b())}}else{this.layout.item=d.Dom.create(this.href?"a":"span",{props:{className:["menu-popup-item",this.className?this.className:"menu-popup-no-icon",this.hasSubMenu()?"menu-popup-item-submenu":""].join(" ")},attrs:{title:this.title,onclick:d.Type.isString(this.onclick)?this.onclick:"",target:this.target?this.target:""},dataset:this.dataset,events:d.Type.isFunction(this.onclick)?{click:this.onItemClick.bind(this)}:null,children:[d.Dom.create("span",{props:{className:"menu-popup-item-icon"}}),this.layout.text=d.Dom.create("span",{props:{className:"menu-popup-item-text"},html:this.text})]});if(this.href){this.layout.item.href=this.href}if(this.isDisabled()){this.disable()}d.Event.bind(this.layout.item,"mouseenter",this.onItemMouseEnter.bind(this));d.Event.bind(this.layout.item,"mouseleave",this.onItemMouseLeave.bind(this))}return this.layout}},{key:"getContainer",value:function e(){return this.getLayout().item}},{key:"getTextContainer",value:function e(){return this.getLayout().text}},{key:"getText",value:function e(){return this.text}},{key:"setText",value:function e(t){if(d.Type.isString(t)){this.text=t;this.getTextContainer().innerHTML=t}}},{key:"hasSubMenu",value:function e(){return this.subMenuWindow!==null||this._items.length}},{key:"showSubMenu",value:function e(){this.addSubMenu(this._items);if(this.subMenuWindow){d.Dom.addClass(this.layout.item,"menu-popup-item-open");this.closeSiblings();this.closeChildren();var t=this.subMenuWindow.getPopupWindow();if(!t.isShown()){this.emit("SubMenu:onShow");t.show()}this.adjustSubMenu()}}},{key:"addSubMenu",value:function e(t){if(this.subMenuWindow!==null||!d.Type.isArray(t)||!t.length){return}var n=this.getMenuWindow().getRootMenuWindow()||this.getMenuWindow();var i=n.params;i.autoHide=false;i.menuShowDelay=this.menuShowDelay;i.cacheable=this.isCacheable();i.zIndexAbsolute=this.getMenuWindow().getPopupWindow().getZindex()+2;i.bindOptions={forceTop:true,forceLeft:true,forceBindPosition:true};delete i.zIndex;delete i.events;delete i.angle;delete i.overlay;this.subMenuWindow=new P("popup-submenu-"+this.id,this.layout.item,t,i);this.subMenuWindow.setParentMenuWindow(this.getMenuWindow());this.subMenuWindow.setParentMenuItem(this);this.subMenuWindow.getPopupWindow().subscribe("onDestroy",this.handleSubMenuDestroy.bind(this));d.Dom.addClass(this.layout.item,"menu-popup-item-submenu");return this.subMenuWindow}},{key:"closeSubMenu",value:function e(){this.clearSubMenuTimeout();if(this.subMenuWindow){d.Dom.removeClass(this.layout.item,"menu-popup-item-open");this.closeChildren();var t=this.subMenuWindow.getPopupWindow();if(t.isShown()){this.emit("SubMenu:onClose")}this.subMenuWindow.close()}}},{key:"closeSiblings",value:function e(){var t=this.menuWindow.getMenuItems();for(var n=0;n<t.length;n++){if(t[n]!==this){t[n].closeSubMenu()}}}},{key:"closeChildren",value:function e(){if(this.subMenuWindow){var t=this.subMenuWindow.getMenuItems();for(var n=0;n<t.length;n++){t[n].closeSubMenu()}}}},{key:"destroySubMenu",value:function e(){if(this.subMenuWindow){d.Dom.removeClass(this.layout.item,"menu-popup-item-open menu-popup-item-submenu");this.destroyChildren();this.subMenuWindow.destroy();this.subMenuWindow=null;this._items=[]}}},{key:"destroyChildren",value:function e(){if(this.subMenuWindow){var t=this.subMenuWindow.getMenuItems();for(var n=0;n<t.length;n++){t[n].destroySubMenu()}}}},{key:"adjustSubMenu",value:function e(){if(!this.subMenuWindow||!this.layout.item){return}var t=this.subMenuWindow.getPopupWindow();var n=this.layout.item.getBoundingClientRect();var i=n.width+this.subMenuOffsetX;var s=n.height+this.getPopupPadding();var o=n.height/2-this.getPopupPadding();var a="left";var l=t.getPopupContainer().offsetWidth;var u=t.getPopupContainer().offsetHeight;var r=n.top+u;var h=document.documentElement.clientWidth;var p=document.documentElement.clientHeight;var d=r-p;if(d>0){var c=Math.ceil(d/n.height)*n.height;if(c>n.top){c-=Math.ceil((c-n.top)/n.height)*n.height}if(n.bottom>r-c){c-=n.bottom-(r-c)+this.getPopupPadding()}s+=c;o+=c}if(n.left+i+l>h){var f=n.left-l-this.subMenuOffsetX;if(f>0){i=-l-this.subMenuOffsetX;a="right"}}t.setBindElement(this.layout.item);t.setOffset({offsetLeft:i,offsetTop:-s});t.setAngle({position:a,offset:o});t.adjustPosition()}},{key:"getPopupPadding",value:function e(){if(!d.Type.isNumber(this.popupPadding)){if(this.subMenuWindow){var t=this.subMenuWindow.layout.menuContainer;this.popupPadding=parseInt(d.Dom.style(t,"paddingTop"),10)}else{this.popupPadding=0}}return this.popupPadding}},{key:"getSubMenu",value:function e(){return this.subMenuWindow}},{key:"getId",value:function e(){return this.id}},{key:"setMenuWindow",value:function e(t){this.menuWindow=t}},{key:"getMenuWindow",value:function e(){return this.menuWindow}},{key:"getMenuShowDelay",value:function e(){return this.menuShowDelay}},{key:"enable",value:function e(){this.disabled=false;this.getContainer().classList.remove("menu-popup-item-disabled")}},{key:"disable",value:function e(){this.disabled=true;this.closeSubMenu();this.getContainer().classList.add("menu-popup-item-disabled")}},{key:"isDisabled",value:function e(){return this.disabled}},{key:"setCacheable",value:function e(t){this.cacheable=t!==false}},{key:"isCacheable",value:function e(){return this.cacheable}},{key:"onItemClick",value:function e(t){this.onclick.call(this.menuWindow,t,this)}},{key:"onItemMouseEnter",value:function e(t){if(this.isDisabled()){return}u.EventEmitter.emit(this,"onMouseEnter",undefined,{thisArg:this});this.clearSubMenuTimeout();if(this.hasSubMenu()){this.subMenuTimeout=setTimeout(function(){this.showSubMenu()}.bind(this),this.menuShowDelay)}else{this.subMenuTimeout=setTimeout(function(){this.closeSiblings()}.bind(this),this.menuShowDelay)}}},{key:"onItemMouseLeave",value:function e(t){if(this.isDisabled()){return}u.EventEmitter.emit(this,"onMouseLeave",undefined,{thisArg:this});this.clearSubMenuTimeout()}},{key:"clearSubMenuTimeout",value:function e(){if(this.subMenuTimeout){clearTimeout(this.subMenuTimeout)}this.subMenuTimeout=null}},{key:"handleSubMenuDestroy",value:function e(){this.subMenuWindow=null}}]);return i}(u.EventEmitter);function w(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="menu-popup">',"</div>\n\t\t"]);w=function e(){return t};return t}function M(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="menu-popup-items">',"</div>\n\t\t"]);M=function e(){return t};return t}var P=function(){function l(e){babelHelpers.classCallCheck(this,l);var t=Array.prototype.slice.call(arguments),n=t[0],i=t[1],s=t[2],o=t[3];if(d.Type.isPlainObject(e)&&!i&&!s&&!o){o=e;o.compatibleMode=false;n=e.id;i=e.bindElement;s=e.items;if(!d.Type.isStringFilled(n)){n="menu-popup-"+d.Text.getRandom()}}this.id=n;this.bindElement=i;this.menuItems=[];this.itemsContainer=null;this.params=o&&babelHelpers.typeof(o)==="object"?o:{};this.parentMenuWindow=null;this.parentMenuItem=null;if(s&&d.Type.isArray(s)){for(var a=0;a<s.length;a++){this.addMenuItemInternal(s[a],null)}}this.layout={menuContainer:null,itemsContainer:null};this.popupWindow=this.__createPopup()}babelHelpers.createClass(l,[{key:"__createPopup",value:function e(){var t=[];for(var n=0;n<this.menuItems.length;n++){var i=this.menuItems[n];var s=i.getLayout();t.push(s.item)}var o={closeByEsc:false,angle:false,autoHide:true,offsetTop:1,offsetLeft:0,animation:"fading"};var a=Object.assign(o,this.params);a.noAllPaddings=true;a.darkMode=false;a.autoHideHandler=this.handleAutoHide.bind(this);this.layout.itemsContainer=d.Tag.render(M(),t);this.layout.menuContainer=d.Tag.render(w(),this.layout.itemsContainer);this.itemsContainer=this.layout.itemsContainer;a.content=this.layout.menuContainer;a.events={onClose:this.handlePopupClose.bind(this),onDestroy:this.handlePopupDestroy.bind(this)};var l=a.compatibleMode===false?this.getId():"menu-popup-"+this.getId();var u=new p(l,this.bindElement,a);if(this.params&&this.params.events){u.subscribeFromOptions(this.params.events)}return u}},{key:"getPopupWindow",value:function e(){return this.popupWindow}},{key:"show",value:function e(){this.getPopupWindow().show()}},{key:"close",value:function e(){this.getPopupWindow().close()}},{key:"destroy",value:function e(){this.getPopupWindow().destroy()}},{key:"toggle",value:function e(){if(this.getPopupWindow().isShown()){this.close()}else{this.show()}}},{key:"getId",value:function e(){return this.id}},{key:"handlePopupClose",value:function e(){for(var t=0;t<this.menuItems.length;t++){var n=this.menuItems[t];n.closeSubMenu()}}},{key:"handlePopupDestroy",value:function e(){for(var t=0;t<this.menuItems.length;t++){var n=this.menuItems[t];n.destroySubMenu()}}},{key:"handleAutoHide",value:function e(t){return!this.containsTarget(t.target)}},{key:"containsTarget",value:function e(t){var n=this.getPopupWindow().getPopupContainer();if(this.getPopupWindow().isShown()&&(t===n||n.contains(t))){return true}return this.getMenuItems().some(function(e){return e.getSubMenu()&&e.getSubMenu().containsTarget(t)})}},{key:"setParentMenuWindow",value:function e(t){if(t instanceof l){this.parentMenuWindow=t}}},{key:"getParentMenuWindow",value:function e(){return this.parentMenuWindow}},{key:"getRootMenuWindow",value:function e(){var t=null;var n=this.getParentMenuWindow();while(n!==null){t=n;n=n.getParentMenuWindow()}return t}},{key:"setParentMenuItem",value:function e(t){if(t instanceof C){this.parentMenuItem=t}}},{key:"getParentMenuItem",value:function e(){return this.parentMenuItem}},{key:"addMenuItem",value:function e(t,n){var i=this.addMenuItemInternal(t,n);if(!i){return null}var s=i.getLayout();var o=this.getMenuItem(n);if(o!==null){var a=o.getLayout();this.itemsContainer.insertBefore(s.item,a.item)}else{this.itemsContainer.appendChild(s.item)}return i}},{key:"addMenuItemInternal",value:function e(t,n){if(!t||!t.delimiter&&!d.Type.isStringFilled(t.text)||t.id&&this.getMenuItem(t.id)!==null){return null}if(d.Type.isNumber(this.params.menuShowDelay)){t.menuShowDelay=this.params.menuShowDelay}var i=new C(t);i.setMenuWindow(this);var s=this.getMenuItemPosition(n);if(s>=0){this.menuItems.splice(s,0,i)}else{this.menuItems.push(i)}return i}},{key:"removeMenuItem",value:function e(t){var n=this.getMenuItem(t);if(!n){return}for(var i=0;i<this.menuItems.length;i++){if(this.menuItems[i]===n){n.destroySubMenu();this.menuItems.splice(i,1);break}}if(!this.menuItems.length){var s=n.getMenuWindow();if(s){var o=s.getParentMenuItem();if(o){o.destroySubMenu()}else{s.destroy()}}}n.layout.item.parentNode.removeChild(n.layout.item);n.layout={item:null,text:null}}},{key:"getMenuItem",value:function e(t){for(var n=0;n<this.menuItems.length;n++){if(this.menuItems[n].id&&this.menuItems[n].id===t){return this.menuItems[n]}}return null}},{key:"getMenuItems",value:function e(){return this.menuItems}},{key:"getMenuItemPosition",value:function e(t){if(t){for(var n=0;n<this.menuItems.length;n++){if(this.menuItems[n].id&&this.menuItems[n].id===t){return n}}}return-1}},{key:"getMenuContainer",value:function e(){return this.getPopupWindow().getPopupContainer()}}]);return l}();var k=function(){function l(){babelHelpers.classCallCheck(this,l);throw new Error("You cannot make an instance of MenuManager.")}babelHelpers.createClass(l,null,[{key:"show",value:function e(){if(this.currentItem!==null){this.currentItem.popupWindow.close()}for(var t=arguments.length,n=new Array(t),i=0;i<t;i++){n[i]=arguments[i]}this.currentItem=this.create.apply(this,n);this.currentItem.popupWindow.show()}},{key:"create",value:function e(t){var n=null;var i=arguments[1];var s=arguments[2];var o=arguments[3];if(d.Type.isPlainObject(t)&&!i&&!s&&!o){n=t.id;if(!d.Type.isStringFilled(n)){throw new Error('BX.Main.Menu.create: "id" parameter is required.')}}else{n=t}if(!this.Data[n]){var a=new P(t,i,s,o);a.getPopupWindow().subscribe("onDestroy",function(){l.destroy(n)});this.Data[n]=a}return this.Data[n]}},{key:"getCurrentMenu",value:function e(){return this.currentItem}},{key:"getMenuById",value:function e(t){return this.Data[t]?this.Data[t]:null}},{key:"onPopupDestroy",value:function e(t){this.destroy(t.id)}},{key:"destroy",value:function e(t){var n=this.getMenuById(t);if(n){if(this.currentItem===n){this.currentItem=null}delete this.Data[t];n.getPopupWindow().destroy()}}}]);return l}();babelHelpers.defineProperty(k,"Data",{});babelHelpers.defineProperty(k,"currentItem",null);var T=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(p);var I=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(a);var H=function(e){babelHelpers.inherits(n,e);function n(e){var t;babelHelpers.classCallCheck(this,n);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this,e));t.buttonNode=d.Dom.create("span",{props:{className:"popup-window-button popup-window-button-link"+(t.className.length>0?" "+t.className:""),id:t.id},text:t.text,events:t.contextEvents});return t}return n}(a);var E=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(H);var S=function(e){babelHelpers.inherits(n,e);function n(e){var t;babelHelpers.classCallCheck(this,n);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this,e));t.buttonNode=d.Dom.create("span",{props:{className:t.className.length>0?t.className:"",id:t.id},events:t.contextEvents,text:t.text});return t}return n}(a);var N=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(S);var B=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(P);var D=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return t}(C);var x=function(){function n(e){babelHelpers.classCallCheck(this,n);this.id=e.id||"bx-inp-popup-"+Math.round(Math.random()*1e6);this.handler=e.handler||false;this.values=e.values||false;this.pInput=e.input;this.bValues=!!this.values;this.defaultValue=e.defaultValue||"";this.openTitle=e.openTitle||"";this.className=e.className||"";this.noMRclassName=e.noMRclassName||"ec-no-rm";this.emptyClassName=e.noMRclassName||"ec-label";var t=this;this.curInd=false;if(this.bValues){this.pInput.onfocus=this.pInput.onclick=function(e){if(this.value==t.defaultValue){this.value="";this.className=t.className}t.ShowPopup();return e.preventDefault()};this.pInput.onblur=function(){if(t.bShowed){setTimeout(function(){t.ClosePopup(true)},200)}t.OnChange()}}else{this.pInput.className=this.noMRclassName;this.pInput.onblur=this.OnChange.bind(this)}}babelHelpers.createClass(n,[{key:"ShowPopup",value:function e(){if(this.bShowed){return}var n=this;if(!this.oPopup){var t=d.Dom.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}});for(var i=0,s=this.values.length;i<s;i++){var o=t.appendChild(d.Dom.create("DIV",{props:{id:"bxecmr_"+i},text:this.values[i].NAME,events:{mouseover:function e(){d.Dom.addClass(this,"bxecplloc-over")},mouseout:function e(){d.Dom.removeClass(this,"bxecplloc-over")},click:function e(){var t=this.id.substr("bxecmr_".length);n.pInput.value=n.values[t].NAME;n.curInd=t;n.OnChange();n.ClosePopup(true)}}}));if(this.values[i].DESCRIPTION){o.title=this.values[i].DESCRIPTION}if(this.values[i].CLASS_NAME){d.Dom.addClass(o,this.values[i].CLASS_NAME)}if(this.values[i].URL){o.appendChild(d.Dom.create("a",{props:{href:this.values[i].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}))}}this.oPopup=new p(this.id,this.pInput,{autoHide:true,offsetTop:1,offsetLeft:0,lightShadow:true,closeByEsc:true,content:t,events:{onClose:this.ClosePopup.bind(this)}})}this.oPopup.show();this.pInput.select();this.bShowed=true;u.EventEmitter.emit(this,"onInputPopupShow",new u.BaseEvent({compatData:[this]}))}},{key:"ClosePopup",value:function e(t){this.bShowed=false;if(this.pInput.value===""){this.OnChange()}u.EventEmitter.emit(this,"onInputPopupClose",new u.BaseEvent({compatData:[this]}));if(t===true){this.oPopup.close()}}},{key:"OnChange",value:function e(){var t=this.pInput.value;if(this.bValues){if(this.pInput.value==""||this.pInput.value==this.defaultValue){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName;t=""}else{this.pInput.className=""}}if(isNaN(parseInt(this.curInd))||this.curInd!==false&&t!=this.values[this.curInd].NAME){this.curInd=false}else{this.curInd=parseInt(this.curInd)}u.EventEmitter.emit(this,"onInputPopupChanged",new u.BaseEvent({compatData:[this,this.curInd,t]}));if(this.handler&&typeof this.handler=="function"){this.handler({ind:this.curInd,value:t})}}},{key:"Set",value:function e(t,n,i){this.curInd=t;if(this.curInd!==false){this.pInput.value=this.values[this.curInd].NAME}else{this.pInput.value=n}if(i!==false){this.OnChange()}}},{key:"Get",value:function e(t){var n=false;if(typeof t=="undefined"){t=this.curInd}if(t!==false&&this.values[t]){n=this.values[t].ID}return n}},{key:"GetIndex",value:function e(t){for(var n=0,i=this.values.length;n<i;n++){if(this.values[n].ID==t){return n}}return false}},{key:"Deactivate",value:function e(t){if(this.pInput.value==""||this.pInput.value==this.defaultValue){if(t){this.pInput.value="";this.pInput.className=this.noMRclassName}else if(this.oEC.bUseMR){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName}}this.pInput.disabled=t}}]);return n}();var O=d.Reflection.namespace("BX");O.PopupWindow=p;O.PopupWindowManager=t;O.PopupMenuWindow=P;O.PopupMenu=k;O.PopupMenuItem=C;O.PopupWindowButton=a;O.PopupWindowButtonLink=H;O.PopupWindowCustomButton=S;window.BXInputPopup=x;e.Popup=p;e.Menu=P;e.MenuItem=C;e.PopupManager=t;e.MenuManager=k;e.PopupWindow=T;e.PopupMenuWindow=B;e.PopupMenuItem=D;e.PopupWindowManager=t;e.PopupMenu=k;e.PopupWindowButton=I;e.PopupWindowButtonLink=E;e.PopupWindowCustomButton=N})(this.BX.Main=this.BX.Main||{},BX.Event,BX);
/* Ammina JS file original /bitrix/js/currency/core_currency.js */
(function(r){BX.namespace("BX.Currency");if(BX.Currency.defaultFormat){return}BX.mergeEx(BX.Currency,{currencyList:[],defaultFormat:{FORMAT_STRING:"#",DEC_POINT:".",THOUSANDS_SEP:" ",DECIMALS:2,HIDE_ZERO:"N"},setCurrencyFormat:function(r,t,e){var n=this.getCurrencyIndex(r),c=BX.clone(this.defaultFormat,true),i;e=!!e;if(n>-1&&!e){return}if(n===-1){n=this.currencyList.length}for(i in c){if(c.hasOwnProperty(i)&&typeof t[i]!=="undefined"){c[i]=t[i]}}this.currencyList[n]={currency:r,format:BX.clone(c,true)}},setCurrencies:function(r,t){var e;if(!!r&&BX.type.isArray(r)){for(e=0;e<r.length;e++){if(!!r[e].CURRENCY&&!!r[e].FORMAT){this.setCurrencyFormat(r[e].CURRENCY,r[e].FORMAT,t)}}}},getCurrencyFormat:function(r){var t=this.getCurrencyIndex(r);return t>-1?this.currencyList[t].format:false},getCurrencyIndex:function(r){var t,e=-1;if(this.currencyList.length===0){return e}for(t=0;t<this.currencyList.length;t++){if(this.currencyList[t].currency===r){e=t;break}}return e},clearCurrency:function(r){var t=this.getCurrencyIndex(r);if(t>-1)this.currencyList=BX.util.deleteFromArray(this.currencyList,t)},clean:function(){this.currencyList=[]},currencyFormat:function(r,t,e){var n="",c;e=!!e;c=this.getCurrencyFormat(t);if(!!c&&typeof c==="object"){c.CURRENT_DECIMALS=c.DECIMALS;if(c.HIDE_ZERO==="Y"&&r==parseInt(r,10))c.CURRENT_DECIMALS=0;n=BX.util.number_format(r,c.CURRENT_DECIMALS,c.DEC_POINT,c.THOUSANDS_SEP);if(e)n=c.FORMAT_STRING.replace(/(^|[^&])#/,"$1"+n)}return n},loadCurrencyFormat:function(n){return new Promise(function(e,t){var r=this.getCurrencyIndex(n);if(r>-1){e(this.currencyList[r].format)}else{BX.ajax.runAction("currency.format.get",{data:{currencyId:n}}).then(function(r){var t=r.data;this.setCurrencyFormat(n,t);e(t)}.bind(this)).catch(function(r){t(r.errors)})}}.bind(this))}})})(window);
/* Ammina JS file original /bitrix/js/socialservices/ss.js */
function BxShowAuthService(e,t){var u="";if(window["bxCurrentAuthId"+t])u=window["bxCurrentAuthId"+t];BX("bx_auth_serv"+t).style.display="";if(u!=""&&u!=e){BX("bx_auth_href_"+t+u).className="";BX("bx_auth_serv_"+t+u).style.display="none"}BX("bx_auth_href_"+t+e).className="bx-ss-selected";BX("bx_auth_href_"+t+e).blur();BX("bx_auth_serv_"+t+e).style.display="";var a=BX.findChild(BX("bx_auth_serv_"+t+e),{tag:"input",attribute:{type:"text"}},true);if(a)try{a.focus()}catch(e){}window["bxCurrentAuthId"+t]=e;if(document.forms["bx_auth_services"+t])document.forms["bx_auth_services"+t].auth_service_id.value=e;else if(document.forms["bx_user_profile_form"+t])document.forms["bx_user_profile_form"+t].auth_service_id.value=e}var bxAuthWnd=false;function BxShowAuthFloat(e,t){var u=false;if(!bxAuthWnd){bxAuthWnd=new BX.CDialog({content:'<div id="bx_auth_float_container"></div>',width:640,height:400,resizable:false});u=true}bxAuthWnd.Show();if(u)BX("bx_auth_float_container").appendChild(BX("bx_auth_float"));BxShowAuthService(e,t)}
/* Ammina JS file original /bitrix/js/main/pageobject/pageobject.js */
window.BX=BX||{};BX.PageObject={getRootWindow:function(){return BX.PageObject.getTopWindowOfCurrentHost(window)},isCrossOriginObject:function(t){try{void t.location.host}catch(t){return true}return false},getTopWindowOfCurrentHost:function(t){if(!BX.PageObject.isCrossOriginObject(t.parent)&&t.parent!==t&&t.parent.location.host===t.location.host){return BX.PageObject.getTopWindowOfCurrentHost(t.parent)}return t},getParentWindowOfCurrentHost:function(t){if(BX.PageObject.isCrossOriginObject(t.parent)){return t}return t.parent}};
/* Ammina JS file original /bitrix/js/main/core/core_window.js */
(function(window){if(BX.WindowManager)return;BX.WindowManager={_stack:[],_runtime_resize:{},_delta:2,_delta_start:1e3,currently_loaded:null,settings_category:"BX.WindowManager.9.5",register:function(t){this.currently_loaded=null;var e=t.Get();e.style.zIndex=t.zIndex=this.GetZIndex();t.WM_REG_INDEX=this._stack.length;this._stack.push(t);if(this._stack.length<2){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))}},unregister:function(t){if(null==t.WM_REG_INDEX)return null;var e;if(this._stack.length>0){while((e=this.__pop_stack())!=t){if(!e){e=null;break}}if(this._stack.length<=0){this.enableKeyCheck()}return e}else{return null}},__pop_stack:function(t){if(this._stack.length>0){var e=this._stack.pop();e.WM_REG_INDEX=null;BX.onCustomEvent(e,"onWindowUnRegister",[t===true]);return e}else return null},clean:function(){while(this.__pop_stack(true)){}this._stack=null;this.disableKeyCheck()},Get:function(){if(this.currently_loaded)return this.currently_loaded;else if(this._stack.length>0)return this._stack[this._stack.length-1];else return null},setStartZIndex:function(t){this._delta_start=t},restoreStartZIndex:function(){this._delta_start=1e3},GetZIndex:function(){var t;return null!=(t=this._stack[this._stack.length-1])?parseInt(t.Get().style.zIndex)+this._delta:this._delta_start},__get_check_url:function(t){var e=t.indexOf("?");return e==-1?t:t.substring(0,e)},saveWindowSize:function(t,e){var i=this.__get_check_url(t);if(BX.userOptions){BX.userOptions.save(this.settings_category,"size_"+i,"width",e.width);BX.userOptions.save(this.settings_category,"size_"+i,"height",e.height)}this._runtime_resize[i]=e},saveWindowOptions:function(t,e){if(BX.userOptions){for(var i in e){if(e.hasOwnProperty(i)){BX.userOptions.save(this.settings_category,"options_"+t,i,e[i])}}}},getRuntimeWindowSize:function(t){return this._runtime_resize[this.__get_check_url(t)]},disableKeyCheck:function(){BX.unbind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},enableKeyCheck:function(){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},__checkKeyPress:function(t){if(null==t)t=window.event;if(t.keyCode==27){var e=BX.WindowManager.Get();if(e&&!e.unclosable)e.Close()}}};BX.garbage(BX.WindowManager.clean,BX.WindowManager);BX.CWindowButton=function(t){if(t.btn){this.btn=t.btn;this.parentWindow=t.parentWindow;if(/save|apply/i.test(this.btn.name)){BX.bind(this.btn,"click",BX.delegate(this.disableUntilError,this))}}else{this.title=t.title;this.hint=t.hint;this.id=t.id;this.name=t.name;this.className=t.className;this.action=t.action;this.onclick=t.onclick;if(t.Button&&BX.type.isFunction(t.Button))this.Button=t.Button;this.btn=null}};BX.CWindowButton.prototype.disable=function(){if(this.btn)this.parentWindow.showWait(this.btn)};BX.CWindowButton.prototype.enable=function(){if(this.btn)this.parentWindow.closeWait(this.btn)};BX.CWindowButton.prototype.emulate=function(){if(this.btn&&this.btn.disabled)return;var t=this.action?BX.delegate(this.action,this):this.onclick?this.onclick:this.btn?this.btn.getAttribute("onclick"):"";if(t){setTimeout(t,50);if(this.btn&&/save|apply/i.test(this.btn.name)&&!this.action){this.disableUntilError()}}};BX.CWindowButton.prototype.Button=function(parentWindow){this.parentWindow=parentWindow;var btn={props:{type:"button",name:this.id?this.id:this.name,value:this.title?this.title:this.name,id:this.id}};if(this.hint)btn.props.title=this.hint;if(!!this.className)btn.props.className=this.className;if(this.action){btn.events={click:BX.delegate(this.action,this)}}else if(this.onclick){if(BX.browser.IsIE()){btn.events={click:BX.delegate(function(){eval(this.onclick)},this)}}else{btn.attrs={onclick:this.onclick}}}this.btn=BX.create("INPUT",btn);return this.btn};BX.CWindowButton.prototype.disableUntilError=function(){this.disable();if(!this.__window_error_handler_set){BX.addCustomEvent(this.parentWindow,"onWindowError",BX.delegate(this.enable,this));this.__window_error_handler_set=true}};BX.CWindow=function(t,e){this.DIV=t||document.createElement("DIV");this.SETTINGS={resizable:false,min_height:0,min_width:0,top:0,left:0,draggable:false,drag_restrict:true,resize_restrict:true};this.ELEMENTS={draggable:[],resizer:[],close:[]};this.type=e=="float"?"float":"dialog";BX.adjust(this.DIV,{props:{className:"bx-core-window"},style:{zIndex:0,position:"absolute",display:"none",top:this.SETTINGS.top+"px",left:this.SETTINGS.left+"px",height:"100px",width:"100px"}});this.isOpen=false;BX.addCustomEvent(this,"onWindowRegister",BX.delegate(this.onRegister,this));BX.addCustomEvent(this,"onWindowUnRegister",BX.delegate(this.onUnRegister,this));this.MOUSEOVER=null;BX.bind(this.DIV,"mouseover",BX.delegate(this.__set_msover,this));BX.bind(this.DIV,"mouseout",BX.delegate(this.__unset_msover,this));BX.ready(BX.delegate(function(){document.body.appendChild(this.DIV)},this))};BX.CWindow.prototype.Get=function(){return this.DIV};BX.CWindow.prototype.visible=function(){return this.isOpen};BX.CWindow.prototype.Show=function(t){this.DIV.style.display="block";if(!t){BX.WindowManager.register(this);BX.onCustomEvent(this,"onWindowRegister")}};BX.CWindow.prototype.Hide=function(){BX.WindowManager.unregister(this);this.DIV.style.display="none"};BX.CWindow.prototype.onRegister=function(){this.isOpen=true};BX.CWindow.prototype.onUnRegister=function(t){this.isOpen=false;if(t||this.PARAMS&&this.PARAMS.content_url){if(t){BX.onCustomEvent(this,"onWindowClose",[this,true])}if(this.DIV.parentNode)this.DIV.parentNode.removeChild(this.DIV)}else{this.DIV.style.display="none"}};BX.CWindow.prototype.CloseDialog=BX.CWindow.prototype.Close=function(t){BX.onCustomEvent(this,"onBeforeWindowClose",[this]);if(t!==true){if(this.denyClose)return false}BX.onCustomEvent(this,"onWindowClose",[this]);if(this.bExpanded){var e=BX.GetDocElement();BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));e.style.overflow=this.__expand_settings.overflow}BX.WindowManager.unregister(this);return true};BX.CWindow.prototype.SetResize=function(t){t.style.cursor="se-resize";BX.bind(t,"mousedown",BX.proxy(this.__startResize,this));this.ELEMENTS.resizer.push(t);this.SETTINGS.resizable=true};BX.CWindow.prototype.SetExpand=function(t,e){e=e||"click";BX.bind(t,e,BX.proxy(this.__expand,this))};BX.CWindow.prototype.__expand_onresize=function(){var t=BX.GetWindowInnerSize();this.DIV.style.width=t.innerWidth+"px";this.DIV.style.height=t.innerHeight+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__expand=function(){var t=BX.GetDocElement();if(!this.bExpanded){var e=BX.GetWindowScrollPos(),i=BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.DIV.style.width,height:this.DIV.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;window.scrollTo(0,0);t.style.overflow="hidden";this.DIV.style.top="0px";this.DIV.style.left="0px";this.DIV.style.width=i.innerWidth+"px";this.DIV.style.height=i.innerHeight+"px";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;t.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.DIV.style.width=this.__expand_settings.width;this.DIV.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize")}};BX.CWindow.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width);var s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();if(this.pos.left+i>o.scrollWidth-this.dw)i=o.scrollWidth-this.pos.left-this.dw}this.DIV.style.width=i+"px";this.DIV.style.height=s+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return false;if(!t)t=window.event;this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.DIV);this.x=t.clientX+this.wndSize.scrollLeft;this.y=t.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.DIV.style.width);BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture)document.body.setCapture();document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CWindow.prototype.__moveResize=function(t){if(!t)t=window.event;var e=BX.GetWindowScrollPos();var i=t.clientX+e.scrollLeft;var s=t.clientY+e.scrollTop;if(this.x==i&&this.y==s)return;this.Resize(i,s);this.x=i;this.y=s};BX.CWindow.prototype.__stopResize=function(){if(document.body.releaseCapture)document.body.releaseCapture();BX.unbind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopResize,this));document.onmousedown=null;var t=document.body;t.ondrag=t.onselectstart=null;t.style.MozUserSelect=this.DIV.style.MozUserSelect="";t.style.cursor="";BX.onCustomEvent(this,"onWindowResizeFinished")};BX.CWindow.prototype.SetClose=function(t){BX.bind(t,"click",BX.proxy(this.Close,this));this.ELEMENTS.close.push(t)};BX.CWindow.prototype.SetDraggable=function(t){BX.bind(t,"mousedown",BX.proxy(this.__startDrag,this));t.style.cursor="move";this.ELEMENTS.draggable.push(t);this.SETTINGS.draggable=true};BX.CWindow.prototype.Move=function(t,e){var i=1;var s=parseInt(this.DIV.style.left)+t;var o=parseInt(this.DIV.style.top)+e;if(this.SETTINGS.drag_restrict){if(s<0)s=0;var n=BX.GetWindowScrollSize();var r=this.DIV.offsetWidth;var h=this.DIV.offsetHeight;if(s>n.scrollWidth-r-i)s=n.scrollWidth-r-i;var a=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight,n.scrollHeight);if(o>a-h-i)o=a-h-i;if(o<0)o=0}this.DIV.style.left=s+"px";this.DIV.style.top=o+"px"};BX.CWindow.prototype.__startDrag=function(t){if(!this.SETTINGS.draggable)return false;if(!t)t=window.event;this.x=t.clientX+document.body.scrollLeft;this.y=t.clientY+document.body.scrollTop;this.__bWasDragged=false;BX.bind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.bind(document,"mouseup",BX.proxy(this.__stopDrag,this));if(document.body.setCapture)document.body.setCapture();document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="move";return BX.PreventDefault(t)};BX.CWindow.prototype.__moveDrag=function(t){if(!t)t=window.event;var e=t.clientX+document.body.scrollLeft;var i=t.clientY+document.body.scrollTop;if(this.x==e&&this.y==i)return;this.Move(e-this.x,i-this.y);this.x=e;this.y=i;if(!this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragStart");this.__bWasDragged=true;BX.bind(BX.proxy_context,"click",BX.PreventDefault)}BX.onCustomEvent(this,"onWindowDrag")};BX.CWindow.prototype.__stopDrag=function(t){if(document.body.releaseCapture)document.body.releaseCapture();BX.unbind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopDrag,this));document.onmousedown=null;var e=document.body;e.ondrag=e.onselectstart=null;e.style.MozUserSelect=this.DIV.style.MozUserSelect="";e.style.cursor="";if(this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragFinished");var i=BX.proxy_context;setTimeout(function(){BX.unbind(i,"click",BX.PreventDefault)},100);this.__bWasDragged=false}return BX.PreventDefault(t)};BX.CWindow.prototype.DenyClose=function(){this.denyClose=true};BX.CWindow.prototype.AllowClose=function(){this.denyClose=false};BX.CWindow.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]);if(this._wait)BX.closeWait(this._wait);window.alert(t)};BX.CWindow.prototype.__set_msover=function(){this.MOUSEOVER=true};BX.CWindow.prototype.__unset_msover=function(){this.MOUSEOVER=false};BX.CWindowDialog=function(){var t=arguments;t[1]="dialog";BX.CWindowDialog.superclass.constructor.apply(this,t);this.DIV.style.top="10px";this.OVERLAY=null};BX.extend(BX.CWindowDialog,BX.CWindow);BX.CWindowDialog.prototype.__resizeOverlay=function(){var t=BX.GetWindowScrollSize();this.OVERLAY.style.width=t.scrollWidth+"px"};BX.CWindowDialog.prototype.CreateOverlay=function(t){if(null==this.OVERLAY){var e=BX.GetWindowScrollSize();var i=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight,e.scrollHeight);this.OVERLAY=document.body.appendChild(BX.create("DIV",{style:{position:"absolute",top:"0px",left:"0px",zIndex:t||parseInt(this.DIV.style.zIndex)-2,width:e.scrollWidth+"px",height:i+"px"}}))}return this.OVERLAY};BX.CWindowDialog.prototype.Show=function(){BX.CWindowDialog.superclass.Show.apply(this,arguments);this.CreateOverlay();this.OVERLAY.style.display="block";this.OVERLAY.style.zIndex=parseInt(this.DIV.style.zIndex)-2;BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this));BX.bind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CWindowDialog.prototype.onUnRegister=function(t){BX.CWindowDialog.superclass.onUnRegister.apply(this,arguments);if(this.clean){if(this.OVERLAY.parentNode)this.OVERLAY.parentNode.removeChild(this.OVERLAY)}else{this.OVERLAY.style.display="none"}BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CDialog=function(t){BX.CDialog.superclass.constructor.apply(this);this._sender="core_window_cdialog";this.PARAMS=t||{};for(var e in this.defaultParams){if(typeof this.PARAMS[e]=="undefined")this.PARAMS[e]=this.defaultParams[e]}this.PARAMS.width=!isNaN(parseInt(this.PARAMS.width))?this.PARAMS.width:this.defaultParams["width"];this.PARAMS.height=!isNaN(parseInt(this.PARAMS.height))?this.PARAMS.height:this.defaultParams["height"];if(this.PARAMS.resize_id||this.PARAMS.content_url){var i=BX.WindowManager.getRuntimeWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url);if(i){this.PARAMS.width=i.width;this.PARAMS.height=i.height}}BX.addClass(this.DIV,"bx-core-adm-dialog");this.DIV.id="bx-admin-prefix";this.PARTS={};this.DIV.style.height=null;this.DIV.style.width=null;this.PARTS.TITLEBAR=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head"}}));this.PARTS.TITLE_CONTAINER=this.PARTS.TITLEBAR.appendChild(BX.create("SPAN",{props:{className:"bx-core-adm-dialog-head-inner"},text:this.PARAMS.title}));this.PARTS.TITLEBAR_ICONS=this.PARTS.TITLEBAR.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-icons"},children:this.PARAMS.resizable?[BX.create("SPAN",{props:{className:"bx-core-adm-icon-expand",title:BX.message("JS_CORE_WINDOW_EXPAND")}}),BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]:[BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]}));this.PARTS.CONTENT=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap adm-workarea"}}));this.PARTS.CONTENT_DATA=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content"},style:{height:this.PARAMS.height+"px",width:this.PARAMS.width+"px"}}));this.PARTS.HEAD=this.PARTS.CONTENT_DATA.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-block"+(this.PARAMS.icon?" "+this.PARAMS.icon:"")}}));this.SetHead(this.PARAMS.head);this.SetContent(this.PARAMS.content);this.SetTitle(this.PARAMS.title);this.SetClose(this.PARTS.TITLEBAR_ICONS.lastChild);if(this.PARAMS.resizable){this.SetExpand(this.PARTS.TITLEBAR_ICONS.firstChild);this.SetExpand(this.PARTS.TITLEBAR,"dblclick");BX.addCustomEvent(this,"onWindowExpand",BX.proxy(this.__onexpand,this));BX.addCustomEvent(this,"onWindowNarrow",BX.proxy(this.__onexpand,this))}this.PARTS.FOOT=this.PARTS.BUTTONS_CONTAINER=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-buttons"},children:this.ShowButtons()}));if(this.PARAMS.draggable)this.SetDraggable(this.PARTS.TITLEBAR);if(this.PARAMS.resizable){this.PARTS.RESIZER=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-resizer"}}));this.SetResize(this.PARTS.RESIZER);this.SETTINGS.min_width=this.PARAMS.min_width;this.SETTINGS.min_height=this.PARAMS.min_height}this.auth_callback=BX.delegate(function(){this.PARAMS.content="";this.hideNotify();this.Show()},this)};BX.extend(BX.CDialog,BX.CWindowDialog);BX.CDialog.prototype.defaultParams={width:700,height:400,min_width:500,min_height:300,resizable:true,draggable:true,title:"",icon:""};BX.CDialog.prototype.showWait=function(t){if(BX.type.isElementNode(t)&&(t.type=="button"||t.type=="submit")){BX.defer(function(){t.disabled=true})();var e=BX.hasClass(t,"adm-btn-save")||BX.hasClass(t,"adm-btn-save"),i=BX.pos(t,true);t.bxwaiter=this.PARTS.FOOT.appendChild(BX.create("DIV",{props:{className:"adm-btn-load-img"+(e?"-green":"")},style:{top:parseInt((i.bottom+i.top)/2-10)+"px",left:parseInt((i.right+i.left)/2-10)+"px"}}));BX.addClass(t,"adm-btn-load");this.lastWaitElement=t;return t.bxwaiter}return null};BX.CDialog.prototype.closeWait=function(t){t=t||this.lastWaitElement;if(BX.type.isElementNode(t)){if(t.bxwaiter){if(t.bxwaiter.parentNode){t.bxwaiter.parentNode.removeChild(t.bxwaiter)}t.bxwaiter=null}t.disabled=false;BX.removeClass(t,"adm-btn-load");if(this.lastWaitElement==t)this.lastWaitElement=null}};BX.CDialog.prototype.Authorize=function(t){this.bSkipReplaceContent=true;this.ShowError(BX.message("JSADM_AUTH_REQ"));BX.onCustomEvent(this,"onWindowError",[]);BX.closeWait();new BX.CAuthDialog({content_url:this.PARAMS.content_url,auth_result:t,callback:BX.delegate(function(){if(this.auth_callback)this.auth_callback()},this)}).Show()};BX.CDialog.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]);this.closeWait();if(this._wait)BX.closeWait(this._wait);this.Notify(t,true)};BX.CDialog.prototype.__expandGetSize=function(){var t=BX.GetDocElement();t.style.overflow="hidden";var e=BX.GetWindowInnerSize();t.scrollTop=0;this.DIV.style.top="-"+this.dxShadow+"px";this.DIV.style.left="-"+this.dxShadow+"px";return{width:e.innerWidth-parseInt(BX.style(this.PARTS.CONTENT,"padding-right"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-left"))+this.dxShadow,height:e.innerHeight-this.PARTS.TITLEBAR.offsetHeight-this.PARTS.FOOT.offsetHeight-parseInt(BX.style(this.PARTS.CONTENT,"padding-top"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-bottom"))+this.dxShadow}};BX.CDialog.prototype.__expand=function(){var t=BX.GetDocElement();this.dxShadow=2;if(!this.bExpanded){var e=BX.GetWindowScrollPos();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.PARTS.CONTENT_DATA.style.width,height:this.PARTS.CONTENT_DATA.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;var i=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=i.width+"px";this.PARTS.CONTENT_DATA.style.height=i.height+"px";window.scrollTo(0,0);t.style.overflow="hidden";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:i.width,height:i.height}]);BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;t.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.PARTS.CONTENT_DATA.style.width=this.__expand_settings.width;this.PARTS.CONTENT_DATA.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:parseInt(this.__expand_settings.width),height:parseInt(this.__expand_settings.height)}])}};BX.CDialog.prototype.__expand_onresize=function(){var t=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=t.width+"px";this.PARTS.CONTENT_DATA.style.height=t.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[t])};BX.CDialog.prototype.__onexpand=function(){var t=this.PARTS.TITLEBAR_ICONS.firstChild;t.className=BX.toggle(t.className,["bx-core-adm-icon-expand","bx-core-adm-icon-narrow"]);t.title=BX.toggle(t.title,[BX.message("JS_CORE_WINDOW_EXPAND"),BX.message("JS_CORE_WINDOW_NARROW")]);if(this.PARTS.RESIZER){this.PARTS.RESIZER.style.display=this.bExpanded?"none":"block"}};BX.CDialog.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return false;if(!t)t=window.event;this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.PARTS.CONTENT_DATA);this.x=t.clientX+this.wndSize.scrollLeft;this.y=t.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.PARTS.CONTENT_DATA.style.width)+parseInt(BX.style(this.PARTS.CONTENT,"padding-right"));BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture)document.body.setCapture();document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CDialog.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width);var s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();if(this.pos.left+i>o.scrollWidth-this.dw)i=o.scrollWidth-this.pos.left-this.dw}this.PARTS.CONTENT_DATA.style.width=i+"px";this.PARTS.CONTENT_DATA.style.height=s+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{height:s,width:i}])};BX.CDialog.prototype.SetSize=function(t){this.PARTS.CONTENT_DATA.style.width=t.width+"px";this.PARTS.CONTENT_DATA.style.height=t.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[t])};BX.CDialog.prototype.GetParameters=function(t){var e=this.GetForm();if(!e)return"";var i,s="";var o=e.elements.length;var n="";for(i=0;i<o;i++){if(s!="")n="&";var r=e.elements[i];if(r.disabled)continue;switch(r.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==t&&r.name.substr(r.name.length-4)=="_alt"&&e.elements[r.name.substr(0,r.name.length-4)])break;s+=n+r.name+"="+BX.util.urlencode(r.value);break;case"radio":if(r.checked)s+=n+r.name+"="+BX.util.urlencode(r.value);break;case"checkbox":s+=n+r.name+"="+BX.util.urlencode(r.checked?"Y":"N");break;case"select-one":var h="";if(null==t&&e.elements[r.name+"_alt"]&&r.selectedIndex==0)h=e.elements[r.name+"_alt"].value;else h=r.value;s+=n+r.name+"="+BX.util.urlencode(h);break;case"select-multiple":var a,l=false;var d=r.options.length;for(a=0;a<d;a++){if(r.options[a].selected){s+=n+r.name+"="+BX.util.urlencode(r.options[a].value);l=true}}if(!l)s+=n+r.name+"=";break;default:break}}return s};BX.CDialog.prototype.PostParameters=function(t){var e=this.PARAMS.content_url;if(null==t)t="";t+=(t==""?"":"&")+"bxsender="+this._sender;var i=e.indexOf("?");if(i==-1)e+="?"+t;else e=e.substring(0,i)+"?"+t+"&"+e.substring(i+1);BX.showWait();this.auth_callback=BX.delegate(function(){this.hideNotify();this.PostParameters(t)},this);BX.ajax.Setup({skipAuthCheck:true},true);BX.ajax.post(e,this.GetParameters(),BX.delegate(function(t){BX.closeWait();if(!this.bSkipReplaceContent){this.ClearButtons();this.SetContent(t);this.Show(true)}this.bSkipReplaceContent=false},this))};BX.CDialog.prototype.Submit=function(t,e){var i=this.GetForm();if(i){i.onsubmit=null;i.method="POST";if(!i.action||e){e=e||this.PARAMS.content_url;if(null!=t){var s=e.indexOf("?");if(s==-1)e+="?"+t;else e=e.substring(0,s)+"?"+t+"&"+e.substring(s+1)}i.action=e}if(!i._bxsender){i._bxsender=i.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:"bxsender",value:this._sender}}))}this._wait=BX.showWait();this.auth_callback=BX.delegate(function(){this.hideNotify();this.Submit(t)},this);BX.ajax.submit(i,BX.delegate(function(){this.closeWait()},this))}else{window.alert("no form registered!")}};BX.CDialog.prototype.GetForm=function(){if(null==this.__form){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__form=t[0]?t[0]:null}return this.__form};BX.CDialog.prototype.GetRealForm=function(){if(null==this.__rform){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__rform=t[1]?t[1]:t[0]?t[0]:null}return this.__rform};BX.CDialog.prototype._checkButton=function(t){var e=["btnSave","btnCancel","btnClose"];for(var i=0;i<e.length;i++){if(this[e[i]]&&t==this[e[i]])return e[i]}return false};BX.CDialog.prototype.ShowButtons=function(){var t=[];if(this.PARAMS.buttons){if(this.PARAMS.buttons.title)this.PARAMS.buttons=[this.PARAMS.buttons];for(var e=0,i=this.PARAMS.buttons.length;e<i;e++){if(BX.type.isNotEmptyString(this.PARAMS.buttons[e])){t.push(this.PARAMS.buttons[e])}else if(BX.type.isElementNode(this.PARAMS.buttons[e])){t.push(this.PARAMS.buttons[e])}else if(this.PARAMS.buttons[e]){if(!BX.is_subclass_of(this.PARAMS.buttons[e],BX.CWindowButton)){var s=this._checkButton(this.PARAMS.buttons[e]);this.PARAMS.buttons[e]=new BX.CWindowButton(this.PARAMS.buttons[e]);if(s)this[s]=this.PARAMS.buttons[e]}t.push(this.PARAMS.buttons[e].Button(this))}}}return t};BX.CDialog.prototype.setAutosave=function(){if(!this.bSetAutosaveDelay){this.bSetAutosaveDelay=true;setTimeout(BX.proxy(this.setAutosave,this),10)}};BX.CDialog.prototype.SetTitle=function(t){this.PARAMS.title=t;BX.cleanNode(this.PARTS.TITLE_CONTAINER).appendChild(document.createTextNode(this.PARAMS.title))};BX.CDialog.prototype.SetHead=function(t){this.PARAMS.head=BX.util.trim(t);this.PARTS.HEAD.innerHTML=this.PARAMS.head||"&nbsp;";this.PARTS.HEAD.style.display=this.PARAMS.head?"block":"none";this.adjustSize()};BX.CDialog.prototype.Notify=function(t,e,i){if(!this.PARTS.NOTIFY){this.PARTS.NOTIFY=this.DIV.insertBefore(BX.create("DIV",{props:{className:"adm-warning-block"},children:[BX.create("SPAN",{props:{className:"adm-warning-text"}}),BX.create("SPAN",{props:{className:"adm-warning-icon"}}),BX.create("SPAN",{props:{className:"adm-warning-close"},events:{click:BX.proxy(this.hideNotify,this)}})]}),this.DIV.firstChild)}if(e)BX.addClass(this.PARTS.NOTIFY,"adm-warning-block-red");else BX.removeClass(this.PARTS.NOTIFY,"adm-warning-block-red");if(i!==true){t=BX.util.htmlspecialchars(t)}this.PARTS.NOTIFY.firstChild.innerHTML=t||"&nbsp;";this.PARTS.NOTIFY.firstChild.style.width=this.PARAMS.width-50+"px";BX.removeClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.hideNotify=function(){BX.addClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.__adjustHeadToIcon=function(){if(!this.PARTS.HEAD.offsetHeight){setTimeout(BX.delegate(this.__adjustHeadToIcon,this),50)}else{if(this.icon_image&&this.icon_image.height&&this.icon_image.height>this.PARTS.HEAD.offsetHeight-5){this.PARTS.HEAD.style.height=this.icon_image.height+5+"px";this.adjustSize()}this.icon_image.onload=null;this.icon_image=null}};BX.CDialog.prototype.SetIcon=function(t){if(this.PARAMS.icon!=t){if(this.PARAMS.icon)BX.removeClass(this.PARTS.HEAD,this.PARAMS.icon);this.PARAMS.icon=t;if(this.PARAMS.icon){BX.addClass(this.PARTS.HEAD,this.PARAMS.icon);var e=BX.style(this.PARTS.HEAD,"background-image")||BX.style(this.PARTS.HEAD,"backgroundImage");if(BX.type.isNotEmptyString(e)&&e!="none"){var i=e.match(new RegExp("url\\s*\\(\\s*('|\"|)(.+?)(\\1)\\s*\\)"));if(i){e=i[2];if(BX.type.isNotEmptyString(e)){this.icon_image=new Image;this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=e}}}}}this.adjustSize()};BX.CDialog.prototype.SetIconFile=function(t){this.icon_image=new Image;this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=t;BX.adjust(this.PARTS.HEAD,{style:{backgroundImage:"url("+t+")",backgroundPosition:"right 9px"}});this.adjustSize()};BX.CDialog.prototype.SetButtons=function(t){if(BX.type.isString(t)){if(t.length>0){this.PARTS.BUTTONS_CONTAINER.innerHTML+=t;var e=this.PARTS.BUTTONS_CONTAINER.getElementsByTagName("INPUT");if(e.length>0){this.PARAMS.buttons=[];for(var i=0;i<e.length;i++){this.PARAMS.buttons.push(new BX.CWindowButton({btn:e[i],parentWindow:this}))}}}}else{this.PARAMS.buttons=t;BX.adjust(this.PARTS.BUTTONS_CONTAINER,{children:this.ShowButtons()})}this.adjustSize()};BX.CDialog.prototype.ClearButtons=function(){BX.cleanNode(this.PARTS.BUTTONS_CONTAINER);this.adjustSize()};BX.CDialog.prototype.SetContent=function(t){this.__form=null;if(BX.type.isElementNode(t)){if(t.parentNode)t.parentNode.removeChild(t)}else if(BX.type.isString(t)){t=BX.create("DIV",{html:t})}this.PARAMS.content=t;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARTS.HEAD,BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap-inner"},children:[this.PARAMS.content]})]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.submitbtn=this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CDialog.prototype.__submit=function(t){for(var e=0,i=this.PARAMS.buttons.length;e<i;e++){if(this.PARAMS.buttons[e]&&(this.PARAMS.buttons[e].name&&/save|apply/i.test(this.PARAMS.buttons[e].name)||this.PARAMS.buttons[e].btn&&this.PARAMS.buttons[e].btn.name&&/save|apply/i.test(this.PARAMS.buttons[e].btn.name))){this.PARAMS.buttons[e].emulate();break}}return BX.PreventDefault(t)};BX.CDialog.prototype.SwapContent=function(t){t=BX(t);BX.cleanNode(this.PARTS.CONTENT_DATA);t.parentNode.removeChild(t);this.PARTS.CONTENT_DATA.appendChild(t);t.style.display="block";this.SetContent(t.innerHTML)};BX.CDialog.prototype.adjustSize=function(){};BX.CDialog.prototype.__adjustSize=function(){};BX.CDialog.prototype.adjustSizeEx=function(){BX.defer(this.__adjustSizeEx,this)()};BX.CDialog.prototype.__adjustSizeEx=function(){var t=this.PARTS.CONTENT_DATA.firstChild,e=0,i,s;while(t){if(BX.type.isElementNode(t)){i=parseInt(BX.style(t,"margin-top"),10);if(isNaN(i))i=0;s=parseInt(BX.style(t,"margin-bottom"),10);if(isNaN(s))s=0;e+=t.offsetHeight+i+s}t=BX.nextSibling(t)}if(e)this.PARTS.CONTENT_DATA.style.height=e+"px"};BX.CDialog.prototype.__onResizeFinished=function(){BX.WindowManager.saveWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url,{height:parseInt(this.PARTS.CONTENT_DATA.style.height),width:parseInt(this.PARTS.CONTENT_DATA.style.width)})};BX.CDialog.prototype.Show=function(t){if(!this.PARAMS.content&&this.PARAMS.content_url&&BX.ajax&&!t){var e=BX.showWait();BX.WindowManager.currently_loaded=this;var i=this.PARAMS.zIndex?this.PARAMS.zIndex:parseInt(BX.style(e,"z-index"))-1;this.CreateOverlay(i);this.OVERLAY.style.display="block";this.OVERLAY.className="bx-core-dialog-overlay";var s="",o="GET";if(this.PARAMS.content_post){s=this.PARAMS.content_post;o="POST"}var n=this.PARAMS.content_url+(this.PARAMS.content_url.indexOf("?")<0?"?":"&")+"bxsender="+this._sender;this.auth_callback=BX.delegate(function(){this.PARAMS.content="";this.hideNotify();this.Show()},this);BX.ajax({method:o,dataType:"html",url:n,data:s,skipAuthCheck:true,onsuccess:BX.delegate(function(t){BX.closeWait(null,e);this.SetContent(t||"&nbsp;");this.Show()},this)})}else{BX.WindowManager.currently_loaded=null;BX.CDialog.superclass.Show.apply(this,arguments);this.adjustPos();this.OVERLAY.className="bx-core-dialog-overlay";this.__adjustSize();BX.removeCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this));BX.addCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this));if(this.PARAMS.resizable&&(this.PARAMS.content_url||this.PARAMS.resize_id)){BX.removeCustomEvent(this,"onWindowResizeFinished",BX.proxy(this.__onResizeFinished,this));BX.addCustomEvent(this,"onWindowResizeFinished",BX.proxy(this.__onResizeFinished,this))}}};BX.CDialog.prototype.GetInnerPos=function(){return{width:parseInt(this.PARTS.CONTENT_DATA.style.width),height:parseInt(this.PARTS.CONTENT_DATA.style.height)}};BX.CDialog.prototype.adjustPos=function(){if(!this.bExpanded){var t=window;var e=BX.PageObject.getRootWindow();if(e.BX.SidePanel&&e.BX.SidePanel.Instance&&e.BX.SidePanel.Instance.getTopSlider()){t=e.BX.SidePanel.Instance.getTopSlider().getWindow()}var i=t.BX.GetWindowInnerSize();var s=t.BX.GetWindowScrollPos();var o={left:parseInt(s.scrollLeft+i.innerWidth/2-parseInt(this.DIV.offsetWidth)/2)+"px",top:Math.max(parseInt(s.scrollTop+i.innerHeight/2-parseInt(this.DIV.offsetHeight)/2),0)+"px"};if(this.PARAMS.zIndex){o["z-index"]=this.PARAMS.zIndex}BX.adjust(this.DIV,{style:o})}};BX.CDialog.prototype.GetContent=function(){return this.PARTS.CONTENT_DATA};BX.CDialog.prototype.btnSave=BX.CDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:BX.browser.IsIE()&&BX.browser.IsDoctype()&&!BX.browser.IsIE10()?"":"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.PostParameters()}};BX.CDialog.prototype.btnCancel=BX.CDialog.btnCancel={title:BX.message("JS_CORE_WINDOW_CANCEL"),id:"cancel",name:"cancel",action:function(){this.parentWindow.Close()}};BX.CDialog.prototype.btnClose=BX.CDialog.btnClose={title:BX.message("JS_CORE_WINDOW_CLOSE"),id:"close",name:"close",action:function(){this.parentWindow.Close()}};BX.CAdminDialog=function(t){BX.CAdminDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cadmindialog";BX.addClass(this.DIV,"bx-core-adm-admin-dialog");this.PARTS.CONTENT.insertBefore(this.PARTS.HEAD,this.PARTS.CONTENT.firstChild);this.PARTS.HEAD.className="bx-core-adm-dialog-tabs"};BX.extend(BX.CAdminDialog,BX.CDialog);BX.CAdminDialog.prototype.SetHead=function(){BX.CAdminDialog.superclass.SetHead.apply(this,arguments);if(this.PARTS.HEAD.firstChild&&BX.type.isElementNode(this.PARTS.HEAD.firstChild)){var t=this.PARTS.HEAD.firstChild,e=0,i=0,s=0;while(t){if(BX.type.isElementNode(t)){i=parseInt(BX.style(t,"margin-left"),10);if(isNaN(i))i=0;s=parseInt(BX.style(t,"margin-right"),10);if(isNaN(s))s=0;e+=t.offsetWidth+i+s}t=BX.nextSibling(t)}this.SETTINGS.min_width=Math.max(e,this.SETTINGS.min_width)-2;if(this.PARAMS.width<this.SETTINGS.min_width){BX.adjust(this.PARTS.CONTENT_DATA,{style:{width:this.SETTINGS.min_width+"px"}})}}};BX.CAdminDialog.prototype.SetContent=function(t){this.__form=null;if(BX.type.isElementNode(t)){if(t.parentNode)t.parentNode.removeChild(t)}this.PARAMS.content=t;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARAMS.content||"&nbsp;"]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CAdminDialog.prototype.__expandGetSize=function(){var t=BX.CAdminDialog.superclass.__expandGetSize.apply(this,arguments);t.width-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-right"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-left"));t.height-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-top"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-bottom"));t.height-=this.PARTS.HEAD.offsetHeight;return t};BX.CAdminDialog.prototype.Submit=function(){var t=this.GetForm();if(t&&!t["bxpublic"]&&!/bxpublic=/.test(t.action)){t.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"bxpublic",value:"Y"}}))}return BX.CAdminDialog.superclass.Submit.apply(this,arguments)};BX.CAdminDialog.prototype.btnSave=BX.CAdminDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit()}};BX.CAdminDialog.btnCancel=BX.CAdminDialog.superclass.btnCancel;BX.CAdminDialog.btnClose=BX.CAdminDialog.superclass.btnClose;BX.CDebugDialog=function(t){BX.CDebugDialog.superclass.constructor.apply(this,arguments)};BX.extend(BX.CDebugDialog,BX.CDialog);BX.CDebugDialog.prototype.ShowDetails=function(t){var e=BX(t);if(e){if(this.div_detail_current)this.div_detail_current.style.display="none";e.style.display="block";this.div_detail_current=e}};BX.CDebugDialog.prototype.SetContent=function(t){if(!t)return;var e=t.split("#DIVIDER#");if(e.length>1){this.PARAMS.content=e[1];this.PARTS.CONTENT_DATA.style.overflow="hidden";BX.CDebugDialog.superclass.SetContent.apply(this,[e[1]]);this.PARTS.CONTENT_INNER=this.PARTS.CONTENT_DATA.firstChild.nextSibling;this.PARTS.CONTENT_TOP=this.PARTS.CONTENT_DATA.insertBefore(BX.create("DIV",{props:{className:"bx-debug-content-top"},html:e[0]}),this.PARTS.CONTENT_INNER);this.PARTS.CONTENT_INNER.style.overflow="auto"}else{BX.CDebugDialog.superclass.SetContent.apply(this,arguments)}};BX.CDebugDialog.prototype.__adjustSize=function(){BX.CDebugDialog.superclass.__adjustSize.apply(this,arguments);if(this.PARTS.CONTENT_TOP){var t=this.PARTS.CONTENT_DATA.offsetHeight-this.PARTS.HEAD.offsetHeight-this.PARTS.CONTENT_TOP.offsetHeight-38;if(t>0){this.PARTS.CONTENT_INNER.style.height=t+"px"}}};BX.CEditorDialog=function(t){BX.CEditorDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-editor-dialog-content-wrap");BX.addClass(this.PARTS.CONTENT_DATA,"bx-core-editor-dialog-content");BX.addClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-editor-dialog-buttons")};BX.extend(BX.CEditorDialog,BX.CDialog);BX.CEditorDialog.prototype.SetContent=function(){BX.CEditorDialog.superclass.SetContent.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner")};BX.CWizardDialog=function(t){BX.CWizardDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-wizard-dialog-content-wrap")};BX.extend(BX.CWizardDialog,BX.CDialog);BX.CAuthDialog=function(t){t.resizable=false;t.width=350;t.height=200;t.buttons=[this.btnSave];BX.CAuthDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cauthdialog";BX.addClass(this.DIV,"bx-core-auth-dialog");BX.AUTHAGENT=this};BX.extend(BX.CAuthDialog,BX.CDialog);BX.CAuthDialog.prototype.btnSave=BX.CAuthDialog.btnSave={title:BX.message("JS_CORE_WINDOW_AUTH"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit("",this.parentWindow.PARAMS.content_url)}};BX.CAuthDialog.prototype.SetError=function(t){BX.closeWait();if(!!t)this.ShowError(t.MESSAGE||t)};BX.CAuthDialog.prototype.setAuthResult=function(t){BX.closeWait();if(t===false){this.Close();if(this.PARAMS.callback)this.PARAMS.callback()}else{this.SetError(t)}};BX.CWindowFloat=function(t){BX.CWindowFloat.superclass.constructor.apply(this,[t,"float"]);this.SETTINGS.resizable=false};BX.extend(BX.CWindowFloat,BX.CWindow);BX.CWindowFloat.prototype.adjustPos=function(){if(this.PARAMS.parent)this.adjustToNode();else if(this.PARAMS.x&&this.PARAMS.y)this.adjustToPos([this.PARAMS.x,this.PARAMS.y])};BX.CWindowFloat.prototype.adjustToPos=function(t){this.DIV.style.left=parseInt(t[0])+"px";this.DIV.style.top=parseInt(t[1])+"px"};BX.CWindowFloat.prototype.adjustToNodeGetPos=function(){return BX.pos(this.PARAMS.parent)};BX.CWindowFloat.prototype.adjustToNode=function(t){t=t||this.PARAMS.parent;this.PARAMS.parent=BX(t);if(this.PARAMS.parent){var e=this.adjustToNodeGetPos();this.DIV.style.top=e.top+"px";this.DIV.style.left=e.left+"px";this.PARAMS.parent.OPENER=this}};BX.CWindowFloat.prototype.Show=function(){this.adjustToPos([-1e3,-1e3]);BX.CWindowFloat.superclass.Show.apply(this,arguments);this.adjustPos()};BX.COpener=function(t){this.PARAMS=t||{};this.MENU=t.MENU||[];this.DIV=t.DIV;this.ATTACH=t.ATTACH||t.DIV;this.ATTACH_MODE=t.ATTACH_MODE||"bottom";this.ACTIVE_CLASS=t.ACTIVE_CLASS||"";this.PUBLIC_FRAME=t.PUBLIC_FRAME||0;this.LEVEL=t.LEVEL||0;this.CLOSE_ON_CLICK=typeof t.CLOSE_ON_CLICK!="undefined"?!!t.CLOSE_ON_CLICK:true;this.ADJUST_ON_CLICK=typeof t.ADJUST_ON_CLICK!="undefined"?!!t.ADJUST_ON_CLICK:true;this.TYPE=this.PARAMS.TYPE=="hover"?"hover":"click";this._openTimeout=null;if(this.PARAMS.TYPE=="hover"&&t.TIMEOUT!==0)this.TIMEOUT=t.TIMEOUT||1e3;else this.TIMEOUT=0;if(!!this.PARAMS.MENU_URL){this.bMenuLoaded=false;this.bMenuLoading=false;this.MENU=[{TEXT:BX.message("JS_CORE_LOADING"),CLOSE_ON_CLICK:false}];if(this.PARAMS.MENU_PRELOAD){BX.defer(this.Load,this)()}}BX.ready(BX.defer(this.Init,this))};BX.COpener.prototype.Init=function(){this.DIV=BX(this.DIV);switch(this.TYPE){case"hover":BX.bind(this.DIV,"mouseover",BX.proxy(this.Open,this));BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break;case"click":BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break}this.bMenuInit=false};BX.COpener.prototype.Load=function(){if(this.PARAMS.MENU_URL&&!this.bMenuLoaded){if(!this.bMenuLoading){var t=this.PARAMS.MENU_URL;if(t.indexOf("sessid=")<=0)t+=(t.indexOf("?")>0?"&":"?")+"sessid="+BX.bitrix_sessid();this.bMenuLoading=true;BX.ajax.loadJSON(t,BX.proxy(this.SetMenu,this),BX.proxy(this.LoadFailed,this))}}};BX.COpener.prototype.SetMenu=function(t){this.bMenuLoaded=true;this.bMenuLoading=false;if(this.bMenuInit){this.MENU.setItems(t)}else{this.MENU=t}};BX.COpener.prototype.LoadFailed=function(t,e){this.bMenuLoading=false;this.SetMenu([{TEXT:BX.message("JS_CORE_NO_DATA"),CLOSE_ON_CLICK:true}]);BX.debug(arguments)};BX.COpener.prototype.checkAdminMenu=function(){if(document.documentElement.id=="bx-admin-prefix")return true;return!!BX.findParent(this.DIV,{property:{id:"bx-admin-prefix"}})};BX.COpener.prototype.Toggle=function(t){this.__clear_timeout();if(!this.bMenuInit||!this.MENU.visible()){var e=this.TIMEOUT;this.TIMEOUT=0;this.Open(t);this.TIMEOUT=e}else{this.MENU.Close()}return!!(t||window.event)&&BX.PreventDefault(t)};BX.COpener.prototype.GetMenu=function(){if(!this.bMenuInit){if(BX.type.isArray(this.MENU)){this.MENU=new BX.CMenu({ITEMS:this.MENU,ATTACH_MODE:this.ATTACH_MODE,SET_ID:this.checkAdminMenu()?"bx-admin-prefix":"",CLOSE_ON_CLICK:!!this.CLOSE_ON_CLICK,ADJUST_ON_CLICK:!!this.ADJUST_ON_CLICK,PUBLIC_FRAME:!!this.PUBLIC_FRAME,LEVEL:this.LEVEL,parent:BX(this.DIV),parent_attach:BX(this.ATTACH)});if(this.LEVEL>0){BX.bind(this.MENU.DIV,"mouseover",BX.proxy(this._on_menu_hover,this));BX.bind(this.MENU.DIV,"mouseout",BX.proxy(this._on_menu_hout,this))}}BX.addCustomEvent(this.MENU,"onMenuOpen",BX.proxy(this.handler_onopen,this));BX.addCustomEvent(this.MENU,"onMenuClose",BX.proxy(this.handler_onclose,this));BX.addCustomEvent("onMenuItemHover",BX.proxy(this.handler_onover,this));this.bMenuInit=true}return this.MENU};BX.COpener.prototype.Open=function(){this.GetMenu();this.bOpen=true;this.__clear_timeout();if(this.TIMEOUT>0){BX.bind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this));this._openTimeout=setTimeout(BX.proxy(this.__open,this),this.TIMEOUT)}else{this.__open()}if(!!this.PARAMS.MENU_URL&&!this.bMenuLoaded){this._loadTimeout=setTimeout(BX.proxy(this.Load,this),parseInt(this.TIMEOUT/2))}return true};BX.COpener.prototype.__clear_timeout=function(){if(!!this._openTimeout)clearTimeout(this._openTimeout);if(!!this._loadTimeout)clearTimeout(this._loadTimeout);BX.unbind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this))};BX.COpener.prototype._on_menu_hover=function(){this.bMenuHover=true;this.__clear_timeout();if(this.ACTIVE_CLASS)BX.addClass(this.DIV,this.ACTIVE_CLASS)};BX.COpener.prototype._on_menu_hout=function(){this.bMenuHover=false};BX.COpener.prototype.handler_onover=function(t,e){if(this.bMenuHover)return;if(e!=this&&t==this.LEVEL-1&&this.ACTIVE_CLASS){BX.removeClass(this.DIV,this.ACTIVE_CLASS)}if(this.bMenuInit&&t<=this.LEVEL-1&&this.MENU.visible()){if(e!=this){this.__clear_timeout();this._openTimeout=setTimeout(BX.proxy(this.Close,this),this.TIMEOUT)}}};BX.COpener.prototype.handler_onopen=function(){this.bOpen=true;if(this.ACTIVE_CLASS)BX.addClass(this.DIV,this.ACTIVE_CLASS);BX.defer(function(){BX.onCustomEvent(this,"onOpenerMenuOpen")},this)()};BX.COpener.prototype.handler_onclose=function(){this.bOpen=false;BX.onCustomEvent(this,"onOpenerMenuClose");if(this.ACTIVE_CLASS)BX.removeClass(this.DIV,this.ACTIVE_CLASS)};BX.COpener.prototype.Close=function(){if(!this.bMenuInit)return;if(!!this._openTimeout)clearTimeout(this._openTimeout);this.bOpen=false;this.__close()};BX.COpener.prototype.__open=function(){this.__clear_timeout();if(this.bMenuInit&&this.bOpen&&!this.MENU.visible())this.MENU.Show()};BX.COpener.prototype.__close=function(){if(this.bMenuInit&&!this.bOpen&&this.MENU.visible())this.MENU.Hide()};BX.COpener.prototype.__close_immediately=function(){this.bOpen=false;this.__close()};BX.COpener.prototype.isMenuVisible=function(){return null!=this.MENU.visible&&this.MENU.visible()};BX.CMenu=function(t){BX.CMenu.superclass.constructor.apply(this);this.DIV.style.width="auto";this.DIV.style.height="auto";this.PARAMS=t||{};this.PARTS={};this.PARAMS.ATTACH_MODE=this.PARAMS.ATTACH_MODE||"bottom";this.PARAMS.CLOSE_ON_CLICK=typeof this.PARAMS.CLOSE_ON_CLICK=="undefined"?true:this.PARAMS.CLOSE_ON_CLICK;this.PARAMS.ADJUST_ON_CLICK=typeof this.PARAMS.ADJUST_ON_CLICK=="undefined"?true:this.PARAMS.ADJUST_ON_CLICK;this.PARAMS.PUBLIC_FRAME=typeof this.PARAMS.PUBLIC_FRAME=="undefined"?false:this.PARAMS.PUBLIC_FRAME;this.PARAMS.LEVEL=this.PARAMS.LEVEL||0;this.DIV.className="bx-core-popup-menu bx-core-popup-menu-"+this.PARAMS.ATTACH_MODE+" bx-core-popup-menu-level"+this.PARAMS.LEVEL+(typeof this.PARAMS.ADDITIONAL_CLASS!="undefined"?" "+this.PARAMS.ADDITIONAL_CLASS:"");if(!!this.PARAMS.SET_ID)this.DIV.id=this.PARAMS.SET_ID;if(this.PARAMS.LEVEL==0){this.ARROW=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-core-popup-menu-angle"},style:{left:"15px"}}))}if(!!this.PARAMS.CLASS_NAME)this.DIV.className+=" "+this.PARAMS.CLASS_NAME;BX.bind(this.DIV,"click",BX.eventCancelBubble);this.ITEMS=[];this.setItems(this.PARAMS.ITEMS);BX.addCustomEvent("onMenuOpen",BX.proxy(this._onMenuOpen,this));BX.addCustomEvent("onMenuItemSelected",BX.proxy(this.Hide,this))};BX.extend(BX.CMenu,BX.CWindowFloat);BX.CMenu.broadcastCloseEvent=function(){BX.onCustomEvent("onMenuItemSelected")};BX.CMenu._toggleChecked=function(){BX.toggleClass(this,"bx-core-popup-menu-item-checked")};BX.CMenu._itemDblClick=function(){window.location.href=this.href};BX.CMenu.prototype.toggleArrow=function(t){if(!!this.ARROW){if(typeof t=="undefined"){t=this.ARROW.style.visibility=="hidden"}this.ARROW.style.visibility=!!t?"visible":"hidden"}};BX.CMenu.prototype.visible=function(){return this.DIV.style.display!=="none"};BX.CMenu.prototype._onMenuOpen=function(t,e){if(this.visible()){if(e==this.PARAMS.LEVEL&&t!=this){this.Hide()}}};BX.CMenu.prototype.onUnRegister=function(){if(!this.visible())return;this.Hide()};BX.CMenu.prototype.setItems=function(t){this.PARAMS.ITEMS=t;BX.cleanNode(this.DIV);if(!!this.ARROW)this.DIV.appendChild(this.ARROW);if(this.PARAMS.ITEMS){this.PARAMS.ITEMS=BX.util.array_values(this.PARAMS.ITEMS);var e=false;var i=0;for(var s=0,o=this.PARAMS.ITEMS.length;s<o;s++){if((s==0||s==o-1)&&this.PARAMS.ITEMS[s].SEPARATOR)continue;i++;if(!e)e=!!this.PARAMS.ITEMS[s].GLOBAL_ICON;this.addItem(this.PARAMS.ITEMS[s],s)}if(i===1)BX.addClass(this.DIV,"bx-core-popup-menu-single-item");else BX.removeClass(this.DIV,"bx-core-popup-menu-single-item");if(!e)BX.addClass(this.DIV,"bx-core-popup-menu-no-icons");else BX.removeClass(this.DIV,"bx-core-popup-menu-no-icons")}};BX.CMenu.prototype.addItem=function(t){this.ITEMS.push(t);if(t.SEPARATOR){t.NODE=BX.create("DIV",{props:{className:"bx-core-popup-menu-separator"}})}else{var e=!!t.MENU&&(BX.type.isArray(t.MENU)&&t.MENU.length>0||t.MENU instanceof BX.CMenu)||!!t.MENU_URL;if(t.DISABLED){t.CLOSE_ON_CLICK=false;t.LINK=null;t.ONCLICK=null;t.ACTION=null}var i={};if(!!t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()){i.href=t.LINK||"javascript:void(0)"}if(this.PARAMS.PUBLIC_FRAME){i.target="_top"}t.NODE=BX.create(!!t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?"A":"SPAN",{props:{className:"bx-core-popup-menu-item"+(e?" bx-core-popup-menu-item-opener":"")+(!!t.DEFAULT?" bx-core-popup-menu-item-default":"")+(!!t.DISABLED?" bx-core-popup-menu-item-disabled":"")+(!!t.CHECKED?" bx-core-popup-menu-item-checked":""),title:!!BX.message["MENU_ENABLE_TOOLTIP"]||!!t.SHOW_TITLE?t.TITLE||"":"",BXMENULEVEL:this.PARAMS.LEVEL},attrs:i,events:{mouseover:function(){BX.onCustomEvent("onMenuItemHover",[this.BXMENULEVEL,this.OPENER])}},html:'<span class="bx-core-popup-menu-item-icon'+(t.GLOBAL_ICON?" "+t.GLOBAL_ICON:"")+'"></span><span class="bx-core-popup-menu-item-text">'+(t.HTML||(t.TEXT?BX.util.htmlspecialchars(t.TEXT):""))+"</span>"});if(e&&!t.DISABLED){t.NODE.OPENER=new BX.COpener({DIV:t.NODE,ACTIVE_CLASS:"bx-core-popup-menu-item-opened",TYPE:"hover",MENU:t.MENU,MENU_URL:t.MENU_URL,MENU_PRELOAD:!!t.MENU_PRELOAD,LEVEL:this.PARAMS.LEVEL+1,ATTACH_MODE:"right",TIMEOUT:500})}else if(this.PARAMS.CLOSE_ON_CLICK&&(typeof t.CLOSE_ON_CLICK=="undefined"||!!t.CLOSE_ON_CLICK)){BX.bind(t.NODE,"click",BX.CMenu.broadcastCloseEvent)}else if(this.PARAMS.ADJUST_ON_CLICK&&(typeof t.ADJUST_ON_CLICK=="undefined"||!!t.ADJUST_ON_CLICK)){BX.bind(t.NODE,"click",BX.defer(this.adjustPos,this))}if(e&&!!t.LINK){BX.bind(t.NODE,"dblclick",BX.CMenu._itemDblClick)}if(typeof t.CHECKED!="undefined"){BX.bind(t.NODE,"click",BX.CMenu._toggleChecked)}t.ONCLICK=t.ACTION||t.ONCLICK;if(!!t.ONCLICK){if(BX.type.isString(t.ONCLICK)){t.ONCLICK=new Function("event",t.ONCLICK)}BX.bind(t.NODE,"click",t.ONCLICK)}}this.DIV.appendChild(t.NODE)};BX.CMenu.prototype._documentClickBind=function(){this._documentClickUnBind();BX.bind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClickUnBind=function(){BX.unbind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClick=function(t){t=t||window.event;if(!!t&&!(BX.getEventButton(t)&BX.MSLEFT))return;this.Close()};BX.CMenu.prototype.Show=function(){BX.onCustomEvent(this,"onMenuOpen",[this,this.PARAMS.LEVEL]);BX.CMenu.superclass.Show.apply(this,[]);this.bCloseEventFired=false;BX.addCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));BX.defer(this._documentClickBind,this)()};BX.CMenu.prototype.Close=BX.CMenu.prototype.Hide=function(){if(!this.visible())return;BX.removeCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));this._documentClickUnBind();if(!this.bCloseEventFired){BX.onCustomEvent(this,"onMenuClose",[this,this.PARAMS.LEVEL]);this.bCloseEventFired=true}BX.CMenu.superclass.Hide.apply(this,arguments)};BX.CMenu.prototype.__adjustMenuToNode=function(){var t=BX.pos(this.PARAMS.parent_attach),e=!!BX.findParent(this.PARAMS.parent_attach,BX.is_fixed);if(e)this.DIV.style.position="fixed";else this.DIV.style.position="absolute";if(!t.top){this.DIV.style.top="-1000px";this.DIV.style.left="-1000px"}if(this.bTimeoutSet)return;var i=this.DIV.offsetWidth,s=this.DIV.offsetHeight;if(!i){setTimeout(BX.delegate(function(){this.bTimeoutSet=false;this.__adjustMenuToNode()},this),100);this.bTimeoutSet=true;return}var o={},n=BX.GetWindowSize();switch(this.PARAMS.ATTACH_MODE){case"bottom":o.top=t.bottom+9;o.left=t.left;var r=0;if(!!this.ARROW){if(t.width>i)r=parseInt(i/2-7);else r=parseInt(Math.min(i,t.width)/2-7);if(r<7){o.left-=15;r+=15}}if(o.left>n.scrollWidth-i-10){var h=o.left;o.left=n.scrollWidth-i-10;if(!!this.ARROW)r+=h-o.left}if(e){o.left-=n.scrollLeft}if(!!this.ARROW)this.ARROW.style.left=r+"px";break;case"right":o.top=t.top-1;o.left=t.right;if(o.left>n.scrollWidth-i-10){o.left=t.left-i-1}break}if(e){o.top-=n.scrollTop}if(!!this.ARROW)this.ARROW.className="bx-core-popup-menu-angle";if(o.top+s>n.scrollTop+n.innerHeight||o.top+s>n.scrollHeight){var a=this.PARAMS.ATTACH_MODE=="bottom"?t.top-s-9:t.bottom-s+1;if(a>n.scrollTop||o.top+s>n.scrollHeight){if(o.top+s>n.scrollHeight){o.top=Math.max(0,n.scrollHeight-s);this.toggleArrow(false)}else{o.top=a;if(!!this.ARROW)this.ARROW.className="bx-core-popup-menu-angle-bottom"}}}if(o.top+o.left==0){this.Hide()}else{this.DIV.style.top=o.top+"px";this.DIV.style.left=o.left+"px"}};BX.CMenu.prototype.adjustToNode=function(t){this.PARAMS.parent_attach=BX(t)||this.PARAMS.parent_attach||this.PARAMS.parent;this.__adjustMenuToNode()};BX.CMenuOpener=function(t){BX.CMenuOpener.superclass.constructor.apply(this);this.PARAMS=t||{};this.setParent(this.PARAMS.parent);this.PARTS={};this.SETTINGS.drag_restrict=true;this.defaultAction=null;this.timeout=500;this.DIV.className="bx-component-opener";this.DIV.ondblclick=BX.PreventDefault;if(this.PARAMS.component_id){this.PARAMS.transform=!!this.PARAMS.transform}this.OPENERS=[];this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar"+(this.PARAMS.transform?" bx-context-toolbar-vertical-mode":"")}}));this.PARTS.INNER=this.DIV.firstChild.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-inner"},html:'<span class="bx-context-toolbar-drag-icon"></span><span class="bx-context-toolbar-vertical-line"></span><br>'}));this.EXTRA_BUTTONS={};var e=0;for(var i=0,s=this.PARAMS.menu.length;i<s;i++){var o=this.addItem(this.PARAMS.menu[i]);if(null!=o){e++;this.PARTS.INNER.appendChild(o);this.PARTS.INNER.appendChild(BX.create("BR"))}}var n=e>0;this.PARTS.ICONS=this.PARTS.INNER.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-icons"}}));if(this.PARAMS.component_id){this.PARAMS.pin=!!this.PARAMS.pin;if(n)this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-separator"}}));this.PARTS.ICON_PIN=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin"},events:{click:BX.delegate(this.__pin_btn_clicked,this)}}))}if(this.EXTRA_BUTTONS["components2_props"]){var r=this.EXTRA_BUTTONS["components2_props"]||{URL:"javascript:void(0)"};if(null==this.defaultAction){this.defaultAction=r.ONCLICK;this.defaultActionTitle=r.TITLE||r.TEXT}r.URL="javascript:"+BX.util.urlencode(r.ONCLICK);this.ATTACH=this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button bx-context-toolbar-button-settings"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"},children:[BX.create("A",{attrs:{href:r.URL},events:{mouseover:BX.proxy(this.__msover_text,this),mouseout:BX.proxy(this.__msout_text,this),mousedown:BX.proxy(this.__msdown_text,this)},html:'<span class="bx-context-toolbar-button-icon bx-context-toolbar-settings-icon"></span>'}),BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-button-arrow"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},html:'<span class="bx-context-toolbar-button-arrow"></span>'})]})]}));this.OPENER=this.ATTACH.firstChild.lastChild;var h=this.attachMenu(this.EXTRA_BUTTONS["components2_submenu"]["MENU"]);BX.addCustomEvent(h,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(h,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(e>1){this.PARTS.ICONS.appendChild(BX.create("span",{props:{className:"bx-context-toolbar-separator bx-context-toolbar-separator-switcher"}}));this.ICON_TRANSFORM=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-switcher"},events:{click:BX.delegate(this.__trf_btn_clicked,this)}}))}if(this.PARAMS.HINT){this.DIV.BXHINT=this.HINT=new BX.CHint({parent:this.DIV,hint:this.PARAMS.HINT.TEXT||"",title:this.PARAMS.HINT.TITLE||"",hide_timeout:this.timeout/2,preventHide:false})}BX.addCustomEvent(this,"onWindowDragFinished",BX.delegate(this.__onMoveFinished,this));BX.addCustomEvent("onDynamicModeChange",BX.delegate(this.__onDynamicModeChange,this));BX.addCustomEvent("onTopPanelCollapse",BX.delegate(this.__onPanelCollapse,this));BX.addCustomEvent("onMenuOpenerMoved",BX.delegate(this.checkPosition,this));BX.addCustomEvent("onMenuOpenerUnhide",BX.delegate(this.checkPosition,this));if(this.OPENERS){for(i=0,s=this.OPENERS.length;i<s;i++){BX.addCustomEvent(this.OPENERS[i],"onOpenerMenuOpen",BX.proxy(this.__hide_hint,this))}}};BX.extend(BX.CMenuOpener,BX.CWindowFloat);BX.CMenuOpener.prototype.setParent=function(t){t=BX(t);if(t.OPENER&&t.OPENER!=this){t.OPENER.Close();t.OPENER.clearHoverHoutEvents()}if(this.PARAMS.parent&&this.PARAMS.parent!=t){this.clearHoverHoutEvents();this.PARAMS.parent.OPENER=null}this.PARAMS.parent=t;this.PARAMS.parent.OPENER=this};BX.CMenuOpener.prototype.setHoverHoutEvents=function(t,e){if(!this.__opener_events_set){BX.bind(this.Get(),"mouseover",t);BX.bind(this.Get(),"mouseout",e);this.__opener_events_set=true}};BX.CMenuOpener.prototype.clearHoverHoutEvents=function(){if(this.Get()){BX.unbindAll(this.Get());this.__opener_events_set=false}};BX.CMenuOpener.prototype.unclosable=true;BX.CMenuOpener.prototype.__check_intersection=function(t,e){return!(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)};BX.CMenuOpener.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open)BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-hover")};BX.CMenuOpener.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open)BX.removeClass(this.ATTACH,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")};BX.CMenuOpener.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open)BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover")};BX.CMenuOpener.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open)BX.removeClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")};BX.CMenuOpener.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open)BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-active")};BX.CMenuOpener.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open)BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-active")};BX.CMenuOpener.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.ATTACH,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpener.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpener.prototype.checkPosition=function(){if(this.isMenuVisible()||this.DIV.style.display=="none"||this==BX.proxy_context||BX.proxy_context.zIndex>this.zIndex)return;this.correctPosition(BX.proxy_context)};BX.CMenuOpener.prototype.correctPosition=function(t){var e=BX.pos(this.DIV),i=BX.pos(t.Get());if(this.__check_intersection(e,i)){var s=i.top-e.height;if(s<0)s=i.bottom;this.DIV.style.top=s+"px";BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));BX.onCustomEvent(this,"onMenuOpenerMoved")}};BX.CMenuOpener.prototype.restorePosition=function(){if(!this.MOUSEOVER&&!this.isMenuVisible()){if(this.originalPos)this.DIV.style.top=this.originalPos.top+"px";BX.removeCustomEvent(BX.proxy_context,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));if(this.restore_pos_timeout)clearTimeout(this.restore_pos_timeout)}else{this.restore_pos_timeout=setTimeout(BX.proxy(this.restorePosition,this),this.timeout)}};BX.CMenuOpener.prototype.Show=function(){BX.CMenuOpener.superclass.Show.apply(this,arguments);this.SetDraggable(this.PARTS.INNER.firstChild);this.DIV.style.width="auto";this.DIV.style.height="auto";if(!this.PARAMS.pin){this.DIV.style.left="-1000px";this.DIV.style.top="-1000px";this.Hide()}else{this.bPosAdjusted=true;this.bMoved=true;if(this.PARAMS.top)this.DIV.style.top=this.PARAMS.top+"px";if(this.PARAMS.left)this.DIV.style.left=this.PARAMS.left+"px";this.DIV.style.display=!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders?"block":"none";if(this.DIV.style.display=="block"){setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"onMenuOpenerUnhide")},this),50)}}};BX.CMenuOpener.prototype.executeDefaultAction=function(){if(this.defaultAction){if(BX.type.isFunction(this.defaultAction))this.defaultAction();else if(BX.type.isString(this.defaultAction))BX.evalGlobal(this.defaultAction)}};BX.CMenuOpener.prototype.__onDynamicModeChange=function(t){this.DIV.style.display=t?"block":"none"};BX.CMenuOpener.prototype.__onPanelCollapse=function(t,e){this.DIV.style.top=parseInt(this.DIV.style.top)+e+"px";if(this.PARAMS.pin){this.__savePosition()}};BX.CMenuOpener.prototype.__onMoveFinished=function(){BX.onCustomEvent(this,"onMenuOpenerMoved");this.bMoved=true;if(this.PARAMS.pin)this.__savePosition()};BX.CMenuOpener.prototype.__savePosition=function(){var t={};t.pin=this.PARAMS.pin;if(!this.PARAMS.pin){t.top=false;t.left=false;t.transform=false}else{t.transform=this.PARAMS.transform;if(this.bMoved){t.left=parseInt(this.DIV.style.left);t.top=parseInt(this.DIV.style.top)}}BX.WindowManager.saveWindowOptions(this.PARAMS.component_id,t)};BX.CMenuOpener.prototype.__pin_btn_clicked=function(){this.Pin()};BX.CMenuOpener.prototype.Pin=function(t){if(null==t)this.PARAMS.pin=!this.PARAMS.pin;else this.PARAMS.pin=!!t;this.PARTS.ICON_PIN.className=this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin";this.__savePosition()};BX.CMenuOpener.prototype.__trf_btn_clicked=function(){this.Transform()};BX.CMenuOpener.prototype.Transform=function(t){var e={};if(null==t)this.PARAMS.transform=!this.PARAMS.transform;else this.PARAMS.transform=!!t;if(this.bMoved){e=BX.pos(this.DIV)}if(this.PARAMS.transform)BX.addClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode");else BX.removeClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode");if(!this.bMoved){this.adjustPos()}else{this.DIV.style.left=e.right-this.DIV.offsetWidth-(BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0)+"px"}this.__savePosition()};BX.CMenuOpener.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent);var e=BX.GetWindowScrollSize();var i=this.DIV.offsetWidth;t.left-=BX.admin.__border_dx;t.top-=BX.admin.__border_dx;if(true||!this.PARAMS.transform){t.top-=45}if(t.left>e.scrollWidth-i){t.left=e.scrollWidth-i}return t};BX.CMenuOpener.prototype.addItem=function(t){if(t.TYPE){this.EXTRA_BUTTONS[t.TYPE]=t;return null}else{var e=new BX.CMenuOpenerItem(t);if(null==this.defaultAction){if(e.item.ONCLICK){this.defaultAction=t.ONCLICK}else if(e.item.MENU){this.defaultAction=BX.delegate(function(){this.Open()},e.item.OPENER)}this.defaultActionTitle=t.TITLE||t.TEXT;BX.addClass(e.Get(),"bx-content-toolbar-default")}if(e.item.OPENER)this.OPENERS[this.OPENERS.length]=e.item.OPENER;return e.Get()}};BX.CMenuOpener.prototype.attachMenu=function(t){var e=new BX.COpener({DIV:this.OPENER,ATTACH:this.ATTACH,MENU:t,TYPE:"click"});this.OPENERS[this.OPENERS.length]=e;return e};BX.CMenuOpener.prototype.__hide_hint=function(){if(this.HINT)this.HINT.__hide_immediately()};BX.CMenuOpener.prototype.isMenuVisible=function(){for(var t=0,e=this.OPENERS.length;t<e;t++){if(this.OPENERS[t].isMenuVisible())return true}return false};BX.CMenuOpener.prototype.Hide=function(){if(!this.PARAMS.pin){this.DIV.style.display="none";BX.onCustomEvent(this,"onMenuOpenerHide")}};BX.CMenuOpener.prototype.UnHide=function(){this.DIV.style.display="block";if(!this.bPosAdjusted&&!this.PARAMS.pin){this.adjustPos();this.bPosAdjusted=true}if(null==this.originalPos&&!this.bMoved){this.originalPos=BX.pos(this.DIV)}BX.onCustomEvent(this,"onMenuOpenerUnhide")};BX.CMenuOpenerItem=function(t){this.item=t;if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.DIV=BX.create("SPAN");this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-underlay"}}));this.WRAPPER=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-wrapper"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button",title:t.TITLE},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"}})]})]}));var e=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-icon"+(this.item.ICON||this.item.ICONCLASS?" "+(this.item.ICON||this.item.ICONCLASS):"")},attrs:!(this.item.ICON||this.item.ICONCLASS)&&(this.item.SRC||this.item.IMAGE)?{style:"background: scroll transparent url("+(this.item.SRC||this.item.IMAGE)+") no-repeat center center !important;"}:{}}),i=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-text"},text:this.item.TEXT});if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.bHasMenu=!!this.item.MENU;this.bHasAction=!!this.item.ONCLICK;if(this.bHasAction){this.LINK=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:this.bHasMenu?BX.proxy(this.__msover_text,this):BX.proxy(this.__msover,this),mouseout:this.bHasMenu?BX.proxy(this.__msout_text,this):BX.proxy(this.__msout,this),mousedown:this.bHasMenu?BX.proxy(this.__msdown_text,this):BX.proxy(this.__msdown,this)},children:[e,i]}));if(this.bHasMenu){this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{props:{className:"bx-context-toolbar-button-arrow"},attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-arrow"}})]}))}}else if(this.bHasMenu){this.item.ONCLICK=null;this.LINK=this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover,this),mouseout:BX.proxy(this.__msout,this),mousedown:BX.proxy(this.__msdown,this)},children:[e,i]}));this.LINK.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-single-button-arrow"}}))}if(this.bHasMenu){this.item.SUBMENU=new BX.CMenu({ATTACH_MODE:"bottom",ITEMS:this.item["MENU"],parent:this.LINK_MENU,parent_attach:this.WRAPPER.firstChild});this.item.OPENER=new BX.COpener({DIV:this.LINK_MENU,TYPE:"click",MENU:this.item.SUBMENU});BX.addCustomEvent(this.item.OPENER,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(this.item.OPENER,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(this.bHasAction){BX.bind(this.LINK,"click",BX.delegate(this.__click,this))}};BX.CMenuOpenerItem.prototype.Get=function(){return this.DIV};BX.CMenuOpenerItem.prototype.__msover=function(){this.bx_hover=true;if(!this._menu_open)BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover")};BX.CMenuOpenerItem.prototype.__msout=function(){this.bx_hover=false;if(!this._menu_open)BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-active")};BX.CMenuOpenerItem.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open)BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover")};BX.CMenuOpenerItem.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open)BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")};BX.CMenuOpenerItem.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open)BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover")};BX.CMenuOpenerItem.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open)BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")};BX.CMenuOpenerItem.prototype.__msdown=function(){this.bx_active=true;if(!this._menu_open)BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active")};BX.CMenuOpenerItem.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open)BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-active")};BX.CMenuOpenerItem.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open)BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-active")};BX.CMenuOpenerItem.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpenerItem.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpenerItem.prototype.__click=function(){BX.evalGlobal(this.item.ONCLICK)};BX.CPageOpener=function(t){BX.CPageOpener.superclass.constructor.apply(this,arguments);this.timeout=505;window.PAGE_EDIT_CONTROL=this};BX.extend(BX.CPageOpener,BX.CMenuOpener);BX.CPageOpener.prototype.checkPosition=function(){if(this==BX.proxy_context)return;this.correctPosition(BX.proxy_context)};BX.CPageOpener.prototype.correctPosition=function(t){if(this.bPosCorrected)return;var e;if(this.DIV.style.display=="none"){e=this.adjustToNodeGetPos();e.bottom=e.top+30;e.right=e.left+300}else{e=BX.pos(this.DIV)}var i=BX.pos(t.Get());if(this.__check_intersection(e,i)){this.DIV.style.display="none";BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));this.bPosCorrected=true}};BX.CPageOpener.prototype.restorePosition=function(){if(BX.proxy_context&&BX.proxy_context.Get().style.display=="none"){this.bPosCorrected=false;if(this.PARAMS.parent.bx_over||this.PARAMS.pin)this.UnHide();BX.removeCustomEvent("onMenuOpenerHide",BX.proxy(this.restorePosition,this))}};BX.CPageOpener.prototype.UnHide=function(){if(!this.bPosCorrected)BX.CPageOpener.superclass.UnHide.apply(this,arguments)};BX.CPageOpener.prototype.Remove=function(){BX.admin.removeComponentBorder(this.PARAMS.parent);BX.userOptions.save("global","settings","page_edit_control_enable","N");this.DIV.style.display="none"};BX.CHintSimple=function(){BX.CHintSimple.superclass.constructor.apply(this,arguments)};BX.extend(BX.CHintSimple,BX.CHint);BX.CHintSimple.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-tooltip-simple"},style:{display:"none"},children:[this.CONTENT=BX.create("DIV")]}));if(this.HINT_TITLE)this.CONTENT.appendChild(BX.create("B",{text:this.HINT_TITLE}));if(this.HINT)this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV")).appendChild(BX.create("SPAN",{html:this.HINT}));if(this.PARAMS.preventHide){BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))}this.bInited=true};BX.adminInformer={itemsShow:3,Init:function(t){if(t)BX.adminInformer.itemsShow=t;var e=BX("admin-informer");if(e)document.body.appendChild(e);BX.addCustomEvent("onTopPanelCollapse",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},Toggle:function(t){var e=BX("admin-informer");if(!e)return false;var i=BX.pos(t);e.style.top=parseInt(i.top)+parseInt(i.height)+7+"px";e.style.left=i.left+"px";if(!BX.hasClass(e,"adm-informer-active"))BX.adminInformer.Show(e);else BX.adminInformer.Hide(e);return false},Close:function(){BX.adminInformer.Hide(BX("admin-informer"))},OnInnerClick:function(t){var e=t.target||t.srcElement;if(e.nodeName.toLowerCase()!="a"||BX.hasClass(e,"adm-informer-footer")){return BX.PreventDefault(t)}return true},ToggleExtra:function(){var t=BX("adm-informer-footer");if(BX.hasClass(t,"adm-informer-footer-collapsed"))this.ShowAll();else this.HideExtra();return false},ShowAll:function(){var t=BX("admin-informer");for(var e=0;e<t.children.length;e++)if(BX.hasClass(t.children[e],"adm-informer-item")&&t.children[e].style.display=="none"){t.children[e].style.display="block"}var i=BX("adm-informer-footer");if(i.textContent!==undefined)i.textContent=BX.message("JSADM_AI_HIDE_EXTRA");else i.innerText=BX.message("JSADM_AI_HIDE_EXTRA");BX.removeClass(i,"adm-informer-footer-collapsed");return false},HideExtra:function(){var t=BX("admin-informer");var e=0;for(var i=BX.adminInformer.itemsShow+1;i<t.children.length;i++){if(BX.hasClass(t.children[i],"adm-informer-item")&&t.children[i].style.display=="block"){t.children[i].style.display="none";e++}}var s=BX("adm-informer-footer");var o=BX.message("JSADM_AI_ALL_NOTIF")+" ("+(BX.adminInformer.itemsShow+parseInt(e))+")";if(s.textContent!==undefined)s.textContent=o;else s.innerText=o;BX.addClass(s,"adm-informer-footer-collapsed");return false},Show:function(t){var e=BX("adm-header-notif-block");if(e)BX.addClass(e,"adm-header-notif-block-active");BX.onCustomEvent(t,"onBeforeAdminInformerShow");setTimeout(BX.proxy(function(){BX.bind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},BX.adminInformer),0);BX.addClass(t,"adm-informer-active");setTimeout(function(){BX.addClass(t,"adm-informer-animate")},0)},Hide:function(t){var e=BX("adm-header-notif-block");if(e)BX.removeClass(e,"adm-header-notif-block-active");BX.unbind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer));BX.removeClass(t,"adm-informer-animate");if(this.IsAnimationSupported())setTimeout(function(){BX.removeClass(t,"adm-informer-active")},300);else BX.removeClass(t,"adm-informer-active");BX.onCustomEvent(t,"onAdminInformerHide")},IsAnimationSupported:function(){var t=document.body||document.documentElement;if(typeof t.style.transition=="string")return true;else if(typeof t.style.MozTransition=="string")return true;else if(typeof t.style.OTransition=="string")return true;else if(typeof t.style.WebkitTransition=="string")return true;else if(typeof t.style.msTransition=="string")return true;return false},SetItemHtml:function(t,e){var i=BX("adm-informer-item-html-"+t);if(!i)return false;i.innerHTML=e;return true},SetItemFooter:function(t,e){var i=BX("adm-informer-item-footer-"+t);if(!i)return false;i.innerHTML=e;if(e)i.style.display="block";else i.style.display="none";return true}}})(window);
/* Ammina JS file original /bitrix/components/bxmaker/geoip.city/templates/.default/script.js */
if(window.frameCacheVars!==undefined){if(!!window.frameCacheVars.AUTO_UPDATE){BX.addCustomEvent("onFrameDataReceived",function(e){window.BXmakerGeoIPCity.init($(".js-bxmaker__geoip__city"))})}else{BX.ready(function(){window.BXmakerGeoIPCity.init($(".js-bxmaker__geoip__city"),true)})}}else{BX.ready(function(){window.BXmakerGeoIPCity.init($(".js-bxmaker__geoip__city"))})}if(!!window.BXmakerGeoIPCity===false){(function(){var e=function(){var e=this;e.baseParams={};e.params={};e.box=null;e.popup=null;e.bInit=false;e.yandexGeoLibLoaded=false};e.prototype.isUseYandexSearch=function(){return this.params.useYandexSearch};e.prototype.isYandexLibLoaded=function(){return this.yandexGeoLibLoaded};e.prototype.init=function(e,o){var r=this;var o=o||false;if(!e.length)return false;if(e.filter(".js-bxmaker__geoip__city--init").length)return false;r.box=e.eq(0);r.box.addClass("js-bxmaker__geoip__city--init");r.popup=r.box.find(".js-bxmaker__geoip__popup").detach();r.rand=r.box.attr("data-rand");if(!window.BxmakerGeoipCityDataBase||!window.BxmakerGeoipCityDataBase[r.rand]){return false}r.baseParams=window.BxmakerGeoipCityDataBase[r.rand];if(o){var a=r.storageTest()?r.storageGet("jsParams"):{};if(!!a.cookiePrefix){r.params=a;r.execute()}else{$.ajax({type:"POST",url:r.baseParams.ajaxUrl,dataType:"json",data:{method:"getJsParams",parameters:r.baseParams.parameters,template:r.baseParams.template,siteId:r.baseParams.siteId},error:function(e){r.logError("Error connection",e)},success:function(e){if(!!e.response){r.params=e.response.params;r.storageTest()&&r.storageSet("jsParams",r.params);r.execute()}else if(!!e.error){r.logError("Error",e)}}})}}else{r.params=window.BxmakerGeoipCityData[r.rand];r.execute()}};e.prototype.execute=function(){var e=this;if(!!e.getCityId()==false){setTimeout(function(){e.execute()},400);return false}if(this.cookie("debug")=="Y"){e.baseParams.debug=true}e.initEvent();e.bInit=true;$(document).trigger("bxmaker.geoip.city.inited",{});e.showCity();if(e.params.useYandex&&e.isUseYandexSearch()){window.BXmakerGeoIPYandexGeo.init(e.params)}else if(e.params.useYandex&&!e.isUseYandexSearch()){if(e.cookie("yandex_location_defined")=="Y"&&e.cookie("yandex_location_defined_check")=="1"){e.checkRedirect()}else{window.BXmakerGeoIPYandexGeo.init(e.params)}}else if(!e.params.useYandex&&e.isUseYandexSearch()){window.BXmakerGeoIPYandexGeo.init(e.params)}else{e.checkRedirect()}};e.prototype.isInit=function(){return this.bInit};e.prototype.setDebug=function(e){this.params.debug=e;if(e){this.cookie("debug","Y")}else{this.cookie("debug","N")}};e.prototype.log=function(){if(this.params.debug){var e=Array.prototype.slice.call(arguments);e.unshift("bxmaker:geoip.city: ");console.log.apply(console,e)}};e.prototype.logError=function(){if(this.params.debug){var e=Array.prototype.slice.call(arguments);e.unshift("bxmaker:geoip.city: ");console.error.apply(console,e)}};e.prototype.getCookieDomain=function(){var e=this;return e.params.cookieDomain};e.prototype.intval=function(e){if(typeof e=="number"||typeof e=="string"){e=e.toString();var o=e.indexOf(".");if(o>0){e=e.substr(0,o)}if(isNaN(Number(e))){e=parseInt(e)}if(isNaN(e)){return 0}return Number(e)}else if(typeof e=="object"&&e.length!=null&&e.length>0){return 1}else if(typeof e=="boolean"&&e===true){return 1}return 0};e.prototype.cookie=function(e,o,r){var a=this;var t=new Date;var e=a.params.cookiePrefix+e;var r=r||{};var i=[];var n,p;if(o===undefined){p=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));n=p?decodeURIComponent(p[1].replace(/\+/g," ")):undefined;a.log("cookie get: "+e+" = "+n);return n}else{o=encodeURIComponent(o);t.setTime(t.getTime()+(!!r.expires?r.expires:365)*24*60*60*1e3);i.push(e+"="+o);i.push("expires="+t.toUTCString());i.push("path="+(!!r.path?r.path:"/"));i.push("domain="+a.getCookieDomain());document.cookie=i.join("; ");a.log("cookie: "+i.join("; "),i)}};e.prototype.getJsonFromUrl=function(e){var o;if(e){var r=location.href.indexOf("?");if(r==-1)return[];o=location.href.substr(r+1)}else{o=location.search.substr(1)}var p={};o.split("&").forEach(function(e){if(!e)return;e=e.split("+").join(" ");var o=e.indexOf("=");var r=o>-1?e.substr(0,o):e;var a=o>-1?decodeURIComponent(e.substr(o+1)):"";var t=r.indexOf("[");if(t==-1)p[decodeURIComponent(r)]=a;else{var i=r.indexOf("]",t);var n=decodeURIComponent(r.substring(t+1,i));r=decodeURIComponent(r.substring(0,t));if(!p[r])p[r]=[];if(!n)p[r].push(a);else p[r][n]=a}});return p};e.prototype.initEvent=function(){var s=this;var o=false;$(document).on("bxmaker.geoip.city.yandex.defined",function(e,o){s.log("save user location defined by yandex");s.selectLocation(false,o);s.cookie("yandex_location_defined","Y");s.cookie("yandex_location_defined_check","1");s.checkRedirect()});$(document).on("bxmaker.geoip.yandex.geo.loaded",function(){s.yandexGeoLibLoaded=true;if(!s.params.useYandex){s.cookie("yandex_location_defined_check","0");return true}if(s.cookie("yandex_location_defined")=="Y"&&s.cookie("yandex_location_defined_check")=="1"){s.checkRedirect();return true}s.log("Yandex geocoder find user location");window.BXmakerGeoIPYandexGeo.getConnection().geolocation.get({provider:"yandex",timeout:5e3,autoReverseGeocode:true}).then(function(e){s.log("Yandex geocoder success",e);var o=e.geoObjects.get(0).properties.get("boundedBy");var r=e.geoObjects.get(0).properties.get("metaDataProperty").GeocoderMetaData;var a=r.Address.Components;var t={};var i=false;t={location:r.id,city:"",city_id:r.id,country:"",country_id:0,region:"",region_id:0,area:"",zip:"000000",range:0,lng:0,lat:0,yandex:1};for(var n in a){switch(a[n].kind){case"locality":{t["city"]=a[n].name;break}case"area":{t["area"]=a[n].name;break}case"province":{t["region"]=a[n].name;break}case"country":{t["country"]=a[n].name;break}}}i=false;for(var p=0;p<s.params.yandexSearchSkipWords.length;p++){if(s.params.yandexSearchSkipWords[p].replace(/^\s+/,"").replace(/\s+$/).length>0&&t["city"].indexOf(s.params.yandexSearchSkipWords[p].replace(/^\s+/,"").replace(/\s+$/))!=-1){s.log("Skip location "+t["city"]+": skip word = "+s.params.yandexSearchSkipWords[p]);i=true}}t["lng"]=o[1][0]-o[0][0];t["lat"]=o[1][1]-o[0][1];if(r.kind=="locality"||r.kind=="province"&&t["city"]==t["region"]){if(!i){s.log("location is defined");s.log("trigger:bxmaker.geoip.city.yandex.defined",t);$(document).trigger("bxmaker.geoip.city.yandex.defined",t)}}else{s.logError("location is not defined")}},function(e){s.logError("location is not defined")})});$(document).on("bxmaker.geoip.city.search.start",function(){s.popupShow()});$(document).on("click",".js-bxmaker__geoip__city-name-global",function(){s.popupShow()});s.popup.on("click",".js-bxmaker__geoip__popup-close",function(){s.log("click by close popup btn");s.popupHide()});s.popup.on("click",".js-bxmaker__geoip__popup-background",function(){s.log("click by popup background");s.popupHide()});s.popup.on("click",".js-bxmaker__geoip__popup-search-clean",function(){if($(this).hasClass("preloader"))return false;s.log("Search input clean");s.popup.find('input[name="city"]').val("").focus();s.popup.find(".js-bxmaker__geoip__popup-search-options").hide()});s.popup.on("click",".js-bxmaker__geoip__popup-option",function(){var e=$(this);s.popup.find(".js-bxmaker__geoip__popup-search-options").hide();if(s.isUseYandexSearch()){s.popup.find('input[name="city"]').val(e.text()).keyup()}else{s.selectLocation(e.attr("data-id"));s.popupHide()}});s.popup.on("keyup",'input[name="city"]',function(){var e=$(this).val().trim();if(e.length<2)return;if(!!o)clearTimeout(o);o=setTimeout(function(){s.log("Search adress:"+e);s.popup.find(".js-bxmaker__geoip__popup-search-clean").addClass("preloader");s.popup.find(".js-bxmaker__geoip__popup-search-search").hide();s.search(e,function(e){s.log("count search results:"+e.response.count);s.popup.find(".js-bxmaker__geoip__popup-search-clean").removeClass("preloader");var o=s.popup.find(".js-bxmaker__geoip__popup-search-options");o.empty();if(!!e.response){if(e.response.count<=0){o.append($('<div class="bxmaker__geoip__popup-search-option bxmaker__geoip__popup-search-option--empty" >'+s.params.messages.emptyResult+"</div>"))}else{for(var r=0;r<e.response.count;r++){var a=e.response.items[r];var t="<span>"+a.city+"</span>"+(!!a.district?", "+a.district:"")+(!!a.region&&a.region!=a.city?", "+a.region:"")+(!!a.country?", "+a.country:"");var i='<div class="bxmaker__geoip__popup-search-option js-bxmaker__geoip__popup-search-option" ';i+=' data-location="'+a.location+'" ';i+=' data-city="'+a.city+'" ';i+=' data-city_id="'+a.city_id+'" ';i+=' data-country="'+a.country+'" ';i+=' data-country_id="'+a.country_id+'" ';i+=' data-region="'+a.region+'" ';i+=' data-region_id="'+a.region_id+'" ';i+=' data-area="'+a.area+'" ';i+=' data-zip="'+a.zip+'" ';i+=' data-range="'+a.range+'" ';i+=' data-lng="'+a.lng+'" ';i+=' data-lat="'+a.lat+'" ';i+=' data-yandex="'+a.yandex+'" ';i+=" >";i+=t;i+="</div>";o.append($(i))}}}else if(!!e.error){o.append('<div class="bxmaker__geoip__popup-search-option bxmaker__geoip__popup-search-option--empty" >'+e.error.msg+"</div>")}o.show()},function(e){s.logError("Error search adress:",e);s.popup.find(".js-bxmaker__geoip__popup-search-clean").removeClass("preloader");s.popup.find(".js-bxmaker__geoip__popup-search-search").empty().append($('<div class="bxmaker__geoip__popup-search-option bxmaker__geoip__popup-search-option--empty" >'+s.params.messages.emptyResult+"</div>"))})},s.params.searchTimeout)});s.popup.on("click",".js-bxmaker__geoip__popup-search-option",function(){var e=$(this);s.popup.find('input[name="city"]').val(e.find("span").text());s.popup.find(".js-bxmaker__geoip__popup-search-options").hide();if(s.isUseYandexSearch()){s.selectLocation(false,{location:e.attr("data-location"),city:e.attr("data-city"),city_id:e.attr("data-city_id"),region:e.attr("data-region"),region_id:e.attr("data-region_id"),country:e.attr("data-country"),country_id:e.attr("data-country_id"),area:e.attr("data-area"),zip:e.attr("data-zip"),range:e.attr("data-range"),lng:e.attr("data-lng"),lat:e.attr("data-lat"),yandex:e.attr("data-yandex")})}else{s.selectLocation(e.attr("data-location"))}s.popupHide()})};e.prototype.popupHide=function(){var e=this;e.log("trigger:bxmaker.geoip.popup.hide.before");$(document).trigger("bxmaker.geoip.popup.hide.before");e.log("popup hide");e.popup.find(".js-bxmaker__geoip__popup-background").animate({opacity:"0"},e.params.animateTimeout);e.popup.find(".js-bxmaker__geoip__popup-content").animate({opacity:"0"},{duration:e.params.animateTimeout,complete:function(){e.popup.hide();e.popup.detach();e.log("trigger:bxmaker.geoip.popup.hide.after",{popup:e.popup});$(document).trigger("bxmaker.geoip.popup.hide.after",{popup:e.popup})}})};e.prototype.popupShow=function(){var e=this;e.log("trigger:bxmaker.geoip.popup.show.before");$(document).trigger("bxmaker.geoip.popup.show.before");e.log("popup show");$("body").append(e.popup);e.popup.show();e.popup.find(".js-bxmaker__geoip__popup-background").animate({opacity:"1"},e.params.animateTimeout);e.popup.find(".js-bxmaker__geoip__popup-content").animate({opacity:"1"},{duration:e.params.animateTimeout,complete:function(){e.log("trigger:bxmaker.geoip.popup.show.after",{popup:e.popup});$(document).trigger("bxmaker.geoip.popup.show.after",{popup:e.popup})}})};e.prototype.search=function(e,u,o){var g=this;var r=g.getJsonFromUrl();g.log("trigger:bxmaker.geoip.search.before",{query:e,success:u,error:o});$(document).trigger("bxmaker.geoip.search.before",{query:e,success:u,error:o});if(g.isUseYandexSearch()){g.log("search in yandex - "+e);window.BXmakerGeoIPYandexGeo.getConnection().geocode(e,{kind:"locality",results:100,json:true}).then(function(e){g.log("Yandex geocoder success",e);var o=e.GeoObjectCollection;var r=[];var a=e.GeoObjectCollection.featureMember;var t=false;var i=[];var n={};var p=false;var s=[0,0];for(var c in a){t=a[c];i=t.GeoObject.metaDataProperty.GeocoderMetaData.Address.Components;if(t.GeoObject.metaDataProperty.GeocoderMetaData.kind!="locality"&&t.GeoObject.metaDataProperty.GeocoderMetaData.kind!="province")continue;n={location:t.GeoObject.metaDataProperty.GeocoderMetaData.id,city:t.GeoObject.name,city_id:t.GeoObject.metaDataProperty.GeocoderMetaData.id,country:"",country_id:0,region:"",region_id:0,area:"",zip:"000000",range:0,lng:0,lat:0,yandex:1};p=false;for(var d=0;d<g.params.yandexSearchSkipWords.length;d++){if(n["city"].indexOf(g.params.yandexSearchSkipWords[d].replace(/^\s+/,"").replace(/\s+$/))!=-1){g.log("Skip location "+n["city"]+": skip word = "+g.params.yandexSearchSkipWords[d]);p=true}}if(p)continue;s=t.GeoObject.Point.pos.split(" ");n["lng"]=s[0];n["lat"]=s[1];for(var l in i){switch(i[l].kind){case"locality":{n["city"]=i[l].name;break}case"area":{n["area"]=i[l].name;break}case"province":{n["region"]=i[l].name;break}case"country":{n["country"]=i[l].name;break}}}r.push(n)}r.splice(10);u({response:{items:r,count:r.length}});g.log("trigger:bxmaker.geoip.search.after",{response:{items:r,count:r.length}});$(document).trigger("bxmaker.geoip.search.after",{response:{items:r,count:r.length}})},function(e){g.logError("Yandex geocoder error",e);o(e);g.log("trigger:bxmaker.geoip.search.after",{error:{code:"error_ajax",msg:"error response",more:e}});$(document).trigger("bxmaker.geoip.search.after",{error:{code:"error_ajax",msg:"error response",more:e}})})}else{g.log("search in bitrix - "+e);$.ajax({type:"POST",url:g.baseParams.ajaxUrl+(!!r&&!!r.clear_cache?"?clear_cache="+r.clear_cache:""),dataType:"json",data:{method:"search",parameters:g.baseParams.parameters,template:g.baseParams.template,siteId:g.baseParams.siteId,query:e},error:function(e){if(typeof o=="function"){g.logError("Error connection",e);o(e)}g.log("trigger:bxmaker.geoip.search.after",{error:{code:"error_ajax",msg:"error response",more:e}});$(document).trigger("bxmaker.geoip.search.after",{error:{code:"error_ajax",msg:"error response",more:e}})},success:function(e){if(!!e.response){if(typeof u=="function"){g.log("Search success",e);u(e)}}else if(!!e.error){if(typeof o=="function"){g.logError("Error",e);o(e)}}g.log("trigger:bxmaker.geoip.search.after",e);$(document).trigger("bxmaker.geoip.search.after",e)}})}return true};e.prototype.selectLocation=function(e,o){var a=this;var o=o||{};var t=a.getLocation();var i=a.getCity();var r=a.getJsonFromUrl();a.log("trigger:bxmaker.geoip.select.location.before",{id:e,params:o});$(document).trigger("bxmaker.geoip.select.location.before",{id:e,params:o});a.log("select location ",e,o);o["parameters"]=a.baseParams.parameters;o["template"]=a.baseParams.template;o["siteId"]=a.baseParams.siteId;if(e){o["method"]="selectLocation";o["id"]=e}else{o["method"]="selectYandexLocation"}$.ajax({type:"POST",url:a.baseParams.ajaxUrl+(!!r&&!!r.clear_cache?"?clear_cache="+r.clear_cache:""),dataType:"json",data:o,error:function(e){a.logError("error ajax select location",e);a.log("trigger: bxmaker.geoip.select.location.after",{error:{code:"error_ajax",msg:"error response",more:e}});$(document).trigger("bxmaker.geoip.select.location.after",{error:{code:"error_ajax",msg:"error response",more:e}})},success:function(e){if(!!e.response){a.log("success select location",e);if(!!e.response.redirect_src){var o=new Image;o.onerror=function(){location.replace(e.response.redirect)};o.src=e.response.redirect_src;return true}else if(!!e.response.redirect){location.replace(e.response.redirect);return true}if(a.params.reload){a.log("need page reload");if(!!BX.Sale&&!!BX.Sale.OrderAjaxComponent&&!!BX.Sale.OrderAjaxComponent.sendRequest){a.log("order page - send request")}else if(!!BX.saleOrderAjax){a.log("order page old - unknown action")}else{a.log("reload");window.location.reload();return}}if(!!e.response&&!!e.response.city&&!!e.response.location&&(e.response.city!=i||e.response.location!=t)){var r=a.getFullData();r["response"]=e.response;a.log("trigger: bxmaker.geoip.city.change",r);$(document).trigger("bxmaker.geoip.city.change",r)}a.showCity();a.log("trigger: bxmaker.geoip.select.location.after",{response:e.response});$(document).trigger("bxmaker.geoip.select.location.after",{response:e.response})}else if(!!e.error){a.logError("error select location ",e);a.log("trigger: bxmaker.geoip.select.location.after",{error:e.error});$(document).trigger("bxmaker.geoip.select.location.after",{error:e.error})}}});return true};e.prototype.showCity=function(){var e=this;var o=e.getFullData();e.log("show city",o);$(".js-bxmaker__geoip__city-name-global").text(o["city"]);e.log("trigger: bxmaker.geoip.city.show",o);$(document).trigger("bxmaker.geoip.city.show",o)};e.prototype.getFullData=function(){var e=this;return{location:e.getLocation(),location_code:e.getLocationCode(),city:e.getCity(),city_id:e.getLocation(),country:e.getCountry(),country_id:e.getCountryId(),region:e.getRegion(),region_id:e.getRegionId(),area:e.getArea(),zip:e.getZip(),range:e.getRange(),lng:e.getLng(),lat:e.getLat(),yandex:e.getYandex()}};e.prototype.getLocation=function(){var e=this;return e.cookie("location")||0};e.prototype.getLocationCode=function(){var e=this;return e.cookie("location_code")||""};e.prototype.getCity=function(){var e=this;return e.cookie("city")||""};e.prototype.getCityId=function(){var e=this;return e.cookie("city_id")||0};e.prototype.getCountry=function(){var e=this;return e.cookie("country")||false};e.prototype.getCountryId=function(){var e=this;return e.cookie("country_id")||0};e.prototype.getRegion=function(){var e=this;return e.cookie("region")||false};e.prototype.getRegionId=function(){var e=this;return e.cookie("region_id")||0};e.prototype.getArea=function(){var e=this;return e.cookie("area")||false};e.prototype.getZip=function(){var e=this;return e.cookie("zip")||""};e.prototype.getLng=function(){var e=this;return e.cookie("lng")||0};e.prototype.getLat=function(){var e=this;return e.cookie("lat")||0};e.prototype.getRange=function(){var e=this;return e.cookie("range")||false};e.prototype.getYandex=function(){var e=this;return!!(e.cookie("yandex")||e.isUseYandexSearch())};e.prototype.checkRedirect=function(){var r=this;var e=r.getJsonFromUrl();if(r.params.useDomainRedirect){if(r.cookie("checked_redirect")!="Y"){$.ajax({type:"POST",url:r.baseParams.ajaxUrl+(!!e&&!!e.clear_cache?"?clear_cache="+e.clear_cache:""),dataType:"json",data:{method:"checkNeedRedirect",parameters:r.baseParams.parameters,template:r.baseParams.template,siteId:r.baseParams.siteId},error:function(e){r.logError("error ajax checked_redirect",e)},success:function(e){if(!!e.response){r.log("success checked_redirect",e);if(!!e.response.need){r.cookie("checked_redirect","Y");if(!!e.response.redirect_src){var o=new Image;o.onerror=function(){location.replace(e.response.redirect)};o.src=e.response.redirect_src}else if(!!e.response.redirect){location.replace(e.response.redirect)}}}}})}else{if(r.params.locationDomain!=location.hostname){var o=location.protocol;o+="//";o+=r.params.locationDomain;o+=location.pathname;o+=location.search;o+=location.hash;location.href=o}}}};e.prototype.storageTest=function(){try{return"localStorage"in window&&window["localStorage"]!==null}catch(e){return false}};e.prototype.storageSet=function(e,o){var r=this;e=r.baseParams.version+"|"+e;try{if(o===null){return window.localStorage.removeItem(e)}else{return window.localStorage.setItem(e,JSON.stringify({data:o,time:(new Date).getTime()}))}}catch(e){if(e==QUOTA_EXCEEDED_ERR){r.logError("LocalStorage limit exceeded")}else{r.logError("localStorage:",e)}return false}};e.prototype.storageGet=function(e){var o=this;var r=(new Date).getTime();e=o.baseParams.version+"|"+e;try{var a=JSON.parse(window.localStorage.getItem(e));if(!!a){if(!!a["time"]&&a["time"]>r-60*60*24*3){return a["data"]}}return false}catch(e){o.logError("localStorage:",e);return false}};window.BXmakerGeoIPCity=new e})()}if(!!window.BXmakerGeoIPYandexGeo===false){(function(){var e=function(){var e=this;e.bInit=false;e.ymap=false;e.params={};e.debug=false;e.cb=[]};e.prototype.log=function(){if(this.debug){var e=Array.prototype.slice.call(arguments);e.unshift("bxmaker:geoip.city.yandex.geo: ");console.log.apply(console,e)}};e.prototype.logError=function(){if(this.debug){var e=Array.prototype.slice.call(arguments);e.unshift("bxmaker:geoip.city.yandex.geo: ");console.error.apply(console,e)}};e.prototype.init=function(e){var o=this;var r="https://api-maps.yandex.ru/2.1/?lang=ru_RU&load=geolocation,geocode&onload=BXmakerGeoIPYandexGeo.onload&ns=";if(o.bInit)return true;o.params=e;if(!!window.BXmakerGeoIPCity&&window.BXmakerGeoIPCity.cookie("debug")=="Y"){o.debug=true}o.bInit=true;if(o.params.yandexApiKey){r+="&apikey="+o.params.yandexApiKey}else{o.logError("Api key for yandex map is not set")}$("head").append($('<script id="BXmakerGeoIPYandexGeo" type="text/javascript" src="'+r+'" />'))};e.prototype.onload=function(e){var o=this;o.ymap=e;o.log("API is loaded");o.log("trigger: bxmaker.geoip.yandex.geo.loaded");$(document).trigger("bxmaker.geoip.yandex.geo.loaded")};e.prototype.getConnection=function(){var e=this;return e.ymap};window.BXmakerGeoIPYandexGeo=new e})()}
/* Ammina JS file original /bitrix/components/bxmaker/geoip.city.line/templates/.default/script.js */
BX.ready(function(){if(!window.BXmakerGeoIPCityLineCheck){window.BXmakerGeoIPCityLineCheck=true;$(".js-bxmaker__geoip__city__line:not(.js-bxmaker__geoip__city__line--init)").each(function(){new BXmakerGeoIPCityLineConstructor($(this))})}});if(!!window.BXmakerGeoIPCityLineConstructor===false){var BXmakerGeoIPCityLineConstructor=function(o){var e=this;e.params={};e.box=o;e.box.addClass("js-bxmaker__geoip__city__line--init");e.rand=e.box.attr("data-rand");if(!window.BxmakerGeoipCityLineData||!window.BxmakerGeoipCityLineData[e.rand]){return false}e.params=window.BxmakerGeoipCityLineData[e.rand];if(!!window.BXmakerGeoIPCity&&window.BXmakerGeoIPCity.isInit()){e.execute()}else{$(document).on("bxmaker.geoip.city.inited",$.proxy(e.execute,e))}};BXmakerGeoIPCityLineConstructor.prototype.execute=function(){var o=this;if(o.cookie("debug")=="Y"){o.params.debug=true}if(o.params.debug){o.log("debug is on")}o.initEvent()};BXmakerGeoIPCityLineConstructor.prototype.cookie=function(){return window.BXmakerGeoIPCity.cookie.apply(window.BXmakerGeoIPCity,Array.prototype.slice.call(arguments))};BXmakerGeoIPCityLineConstructor.prototype.setDebug=function(o){this.params.debug=o;if(o){this.cookie("debug","Y")}else{this.cookie("debug","N")}};BXmakerGeoIPCityLineConstructor.prototype.log=function(){var o=this;if(o.params.debug){var e=Array.prototype.slice.call(arguments);e.unshift("bxmaker:geoip.city.line: ");console.log.apply(console,e)}};BXmakerGeoIPCityLineConstructor.prototype.initEvent=function(){var i=this;var o=false;var e=false;i.log("init event");if(i.params.questionShow){i.log("question tooltip is on");if(i.cookie("question_hide")=="Y"){i.log("question tooltip is hide");o=false}else{i.log("question tooltip not hide");i.tooltipQuestionShow();o=true}}i.box.on("mouseenter",".js-bxmaker__geoip__city__line-context",function(){if(!!e)clearTimeout(e);i.log("mouseenter");if(o){i.tooltipQuestionShow()}else{i.tooltipInfoShow()}}).on("mouseleave",".js-bxmaker__geoip__city__line-context",function(){if(!!e)clearTimeout(e);i.log("mouseleave");if(o){e=setTimeout($.proxy(i.tooltipQuestionHide,i),i.params.tooltipTimeout)}else{e=setTimeout($.proxy(i.tooltipInfoHide,i),i.params.tooltipTimeout)}}).on("click",".js-bxmaker__geoip__city__line-question-btn-no",function(){i.log("question answer no");i.cookie("question_hide","Y");i.tooltipQuestionHide();i.log("trigger: bxmaker.geoip.city.search.start");$(document).trigger("bxmaker.geoip.city.search.start");o=false}).on("click",".js-bxmaker__geoip__city__line-question-btn-yes",function(){i.log("question answer yes");i.cookie("question_hide","Y");i.tooltipQuestionHide();o=false}).on("click",".js-bxmaker__geoip__city__line-info-btn",function(){i.log("info need city change");i.tooltipInfoHide();i.log("trigger: bxmaker.geoip.city.search.start");$(document).trigger("bxmaker.geoip.city.search.start")}).on("click",".js-bxmaker__geoip__city__line-name",function(){i.log("click by city name");i.cookie("question_hide","Y");i.tooltipQuestionHide();i.tooltipInfoHide();i.log("trigger: bxmaker.geoip.city.search.start");$(document).trigger("bxmaker.geoip.city.search.start")});$(document).on("bxmaker.geoip.city.show",function(o,e){i.log("event: bxmaker.geoip.city.show");i.showCity(e.city)});i.showCity(window.BXmakerGeoIPCity.getCity())};BXmakerGeoIPCityLineConstructor.prototype.tooltipQuestionShow=function(){var o=this;o.log("tooltip question show");o.box.find(".js-bxmaker__geoip__city__line-question").stop().fadeIn(o.params.animateTimeout)};BXmakerGeoIPCityLineConstructor.prototype.tooltipQuestionHide=function(){var o=this;o.log("tooltip question hide");o.box.find(".js-bxmaker__geoip__city__line-question").stop().fadeOut(o.params.animateTimeout)};BXmakerGeoIPCityLineConstructor.prototype.tooltipInfoShow=function(){var o=this;if(o.params.infoShow){o.log("tooltip info show");o.box.find(".js-bxmaker__geoip__city__line-info").stop().fadeIn(o.params.animateTimeout)}};BXmakerGeoIPCityLineConstructor.prototype.tooltipInfoHide=function(){var o=this;o.log("tooltip info hide");o.box.find(".js-bxmaker__geoip__city__line-info").stop().fadeOut(o.params.animateTimeout)};BXmakerGeoIPCityLineConstructor.prototype.showCity=function(o){var e=this;e.log("show city");e.box.find(".js-bxmaker__geoip__city__line-city").text(o)}}
/* Ammina JS file original /bitrix/templates/mostehnika/components/bitrix/sale.basket.basket.line/cart/script.js */
;"use strict";function BitrixSmallCart(){}BitrixSmallCart.prototype={activate:function(){this.cartElement=BX(this.cartId);this.fixedPosition=this.arParams.POSITION_FIXED=="Y";if(this.fixedPosition){this.cartClosed=true;this.maxHeight=false;this.itemRemoved=false;this.verticalPosition=this.arParams.POSITION_VERTICAL;this.horizontalPosition=this.arParams.POSITION_HORIZONTAL;this.topPanelElement=BX("bx-panel");this.fixAfterRender();this.fixAfterRenderClosure=this.closure("fixAfterRender");var t=this.closure("fixCart");this.fixCartClosure=t;if(this.topPanelElement&&this.verticalPosition=="top")BX.addCustomEvent(window,"onTopPanelCollapse",t);var e=null;BX.bind(window,"resize",function(){clearTimeout(e);e=setTimeout(t,200)})}this.setCartBodyClosure=this.closure("setCartBody");BX.addCustomEvent(window,"OnBasketChange",this.closure("refreshCart",{}))},fixAfterRender:function(){this.statusElement=BX(this.cartId+"status");if(this.statusElement){if(this.cartClosed)this.statusElement.innerHTML=this.openMessage;else this.statusElement.innerHTML=this.closeMessage}this.productsElement=BX(this.cartId+"products");this.fixCart()},closure:function(e,t){var i=this;return t?function(){i[e](t)}:function(t){i[e](t)}},toggleOpenCloseCart:function(){if(this.cartClosed){BX.removeClass(this.cartElement,"bx-closed");BX.addClass(this.cartElement,"bx-opener");this.statusElement.innerHTML=this.closeMessage;this.cartClosed=false;this.fixCart()}else{BX.addClass(this.cartElement,"bx-closed");BX.removeClass(this.cartElement,"bx-opener");BX.removeClass(this.cartElement,"bx-max-height");this.statusElement.innerHTML=this.openMessage;this.cartClosed=true;var t=this.cartElement.querySelector("[data-role='basket-item-list']");if(t)t.style.top="auto"}setTimeout(this.fixCartClosure,100)},setVerticalCenter:function(t){var e=t/2-this.cartElement.offsetHeight/2;if(e<5)e=5;this.cartElement.style.top=e+"px"},fixCart:function(){if(this.horizontalPosition=="hcenter"){var t="innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth;var e=t/2-this.cartElement.offsetWidth/2;if(e<5)e=5;this.cartElement.style.left=e+"px"}var i="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight;switch(this.verticalPosition){case"top":if(this.topPanelElement)this.cartElement.style.top=this.topPanelElement.offsetHeight+5+"px";break;case"vcenter":this.setVerticalCenter(i);break}if(this.productsElement){var s=this.cartElement.querySelector("[data-role='basket-item-list']");if(this.cartClosed){if(this.maxHeight){BX.removeClass(this.cartElement,"bx-max-height");if(s)s.style.top="auto";this.maxHeight=false}}else{if(this.maxHeight){if(this.productsElement.scrollHeight==this.productsElement.clientHeight){BX.removeClass(this.cartElement,"bx-max-height");if(s)s.style.top="auto";this.maxHeight=false}}else{if(this.verticalPosition=="top"||this.verticalPosition=="vcenter"){if(this.cartElement.offsetTop+this.cartElement.offsetHeight>=i){BX.addClass(this.cartElement,"bx-max-height");if(s)s.style.top=82+"px";this.maxHeight=true}}else{if(this.cartElement.offsetHeight>=i){BX.addClass(this.cartElement,"bx-max-height");if(s)s.style.top=82+"px";this.maxHeight=true}}}}if(this.verticalPosition=="vcenter")this.setVerticalCenter(i)}},refreshCart:function(t){if(this.itemRemoved){this.itemRemoved=false;return}t.sessid=BX.bitrix_sessid();t.siteId=this.siteId;t.templateName=this.templateName;t.arParams=this.arParams;BX.ajax({url:this.ajaxPath,method:"POST",dataType:"html",data:t,onsuccess:this.setCartBodyClosure})},setCartBody:function(t){if(this.cartElement)this.cartElement.innerHTML=t.replace(/#CURRENT_URL#/g,this.currentUrl);if(this.fixedPosition)setTimeout(this.fixAfterRenderClosure,100)},removeItemFromCart:function(t){this.refreshCart({sbblRemoveItemFromCart:t});this.itemRemoved=true;BX.onCustomEvent("OnBasketChange")}};
/* Ammina JS file original /bitrix/templates/mostehnika/components/bitrix/catalog.products.viewed/.new/script.js */
(function(){"use strict";if(!!window.JCCatalogProductsViewedComponent)return;window.JCCatalogProductsViewedComponent=function(t){this.container=document.querySelector('[data-entity="'+t.container+'"]');if(t.initiallyShowHeader){BX.ready(BX.delegate(this.showHeader,this))}};window.JCCatalogProductsViewedComponent.prototype={showHeader:function(t){var e=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}}),i;if(e&&BX.type.isDomNode(e)){i=e.querySelector('[data-entity="header"]');if(i&&i.getAttribute("data-showed")!="true"){i.style.display="";if(t){new BX.easing({duration:2e3,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){i.style.opacity=t.opacity/100},complete:function(){i.removeAttribute("style");i.setAttribute("data-showed","true")}}).animate()}else{i.style.opacity=100}}}}}})();
/* Ammina JS file original /bitrix/components/bitrix/catalog.item/templates/.default/script.js */
(function(u){"use strict";if(u.JCCatalogItem)return;var a=function(t){a.superclass.constructor.apply(this,arguments);this.buttonNode=BX.create("span",{props:{className:"btn btn-default btn-buy btn-sm",id:this.id},style:typeof t.style==="object"?t.style:{},text:t.text,events:this.contextEvents});if(BX.browser.IsIE()){this.buttonNode.setAttribute("hideFocus","hidefocus")}};BX.extend(a,BX.PopupWindowButton);u.JCCatalogItem=function(t){this.productType=0;this.showQuantity=true;this.showAbsent=true;this.secondPict=false;this.showOldPrice=false;this.showMaxQuantity="N";this.relativeQuantityFactor=5;this.showPercent=false;this.showSkuProps=false;this.basketAction="ADD";this.showClosePopup=false;this.useCompare=false;this.showSubscription=false;this.visual={ID:"",PICT_ID:"",SECOND_PICT_ID:"",PICT_SLIDER_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",PRICE_ID:"",PRICE_OLD_ID:"",DSC_PERC:"",SECOND_DSC_PERC:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:"",SUBSCRIBE_ID:""};this.product={checkQuantity:false,maxQuantity:0,stepQuantity:1,isDblQuantity:false,canBuy:true,name:"",pict:{},id:0,addUrl:"",buyUrl:""};this.basketMode="";this.basketData={useProps:false,emptyProps:false,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""};this.compareData={compareUrl:"",compareDeleteUrl:"",comparePath:""};this.defaultPict={pict:null,secondPict:null};this.defaultSliderOptions={interval:3e3,wrap:true};this.slider={options:{},items:[],active:null,sliding:null,paused:null,interval:null,progress:null};this.touch=null;this.quantityDelay=null;this.quantityTimer=null;this.checkQuantity=false;this.maxQuantity=0;this.minQuantity=0;this.stepQuantity=1;this.isDblQuantity=false;this.canBuy=true;this.precision=6;this.precisionFactor=Math.pow(10,this.precision);this.bigData=false;this.fullDisplayMode=false;this.viewMode="";this.templateTheme="";this.currentPriceMode="";this.currentPrices=[];this.currentPriceSelected=0;this.currentQuantityRanges=[];this.currentQuantityRangeSelected=0;this.offers=[];this.offerNum=0;this.treeProps=[];this.selectedValues={};this.obProduct=null;this.blockNodes={};this.obQuantity=null;this.obQuantityUp=null;this.obQuantityDown=null;this.obQuantityLimit={};this.obPict=null;this.obSecondPict=null;this.obPictSlider=null;this.obPictSliderIndicator=null;this.obPrice=null;this.obTree=null;this.obBuyBtn=null;this.obBasketActions=null;this.obNotAvail=null;this.obSubscribe=null;this.obDscPerc=null;this.obSecondDscPerc=null;this.obSkuProps=null;this.obMeasure=null;this.obCompare=null;this.obPopupWin=null;this.basketUrl="";this.basketParams={};this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch");this.hoverTimer=null;this.hoverStateChangeForbidden=false;this.mouseX=null;this.mouseY=null;this.useEnhancedEcommerce=false;this.dataLayerName="dataLayer";this.brandProperty=false;this.errorCode=0;if(typeof t==="object"){if(t.PRODUCT_TYPE){this.productType=parseInt(t.PRODUCT_TYPE,10)}this.showQuantity=t.SHOW_QUANTITY;this.showAbsent=t.SHOW_ABSENT;this.secondPict=t.SECOND_PICT;this.showOldPrice=t.SHOW_OLD_PRICE;this.showMaxQuantity=t.SHOW_MAX_QUANTITY;this.relativeQuantityFactor=parseInt(t.RELATIVE_QUANTITY_FACTOR);this.showPercent=t.SHOW_DISCOUNT_PERCENT;this.showSkuProps=t.SHOW_SKU_PROPS;this.showSubscription=t.USE_SUBSCRIBE;if(t.ADD_TO_BASKET_ACTION){this.basketAction=t.ADD_TO_BASKET_ACTION}this.showClosePopup=t.SHOW_CLOSE_POPUP;this.useCompare=t.DISPLAY_COMPARE;this.fullDisplayMode=t.PRODUCT_DISPLAY_MODE==="Y";this.bigData=t.BIG_DATA;this.viewMode=t.VIEW_MODE||"";this.templateTheme=t.TEMPLATE_THEME||"";this.useEnhancedEcommerce=t.USE_ENHANCED_ECOMMERCE==="Y";this.dataLayerName=t.DATA_LAYER_NAME;this.brandProperty=t.BRAND_PROPERTY;this.visual=t.VISUAL;switch(this.productType){case 0:case 1:case 2:if(t.PRODUCT&&typeof t.PRODUCT==="object"){this.currentPriceMode=t.PRODUCT.ITEM_PRICE_MODE;this.currentPrices=t.PRODUCT.ITEM_PRICES;this.currentPriceSelected=t.PRODUCT.ITEM_PRICE_SELECTED;this.currentQuantityRanges=t.PRODUCT.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=t.PRODUCT.ITEM_QUANTITY_RANGE_SELECTED;if(this.showQuantity){this.product.checkQuantity=t.PRODUCT.CHECK_QUANTITY;this.product.isDblQuantity=t.PRODUCT.QUANTITY_FLOAT;if(this.product.checkQuantity){this.product.maxQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.MAX_QUANTITY):parseInt(t.PRODUCT.MAX_QUANTITY,10)}this.product.stepQuantity=this.product.isDblQuantity?parseFloat(t.PRODUCT.STEP_QUANTITY):parseInt(t.PRODUCT.STEP_QUANTITY,10);this.checkQuantity=this.product.checkQuantity;this.isDblQuantity=this.product.isDblQuantity;this.stepQuantity=this.product.stepQuantity;this.maxQuantity=this.product.maxQuantity;this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity;if(this.isDblQuantity){this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor}}this.product.canBuy=t.PRODUCT.CAN_BUY;if(t.PRODUCT.MORE_PHOTO_COUNT){this.product.morePhotoCount=t.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=t.PRODUCT.MORE_PHOTO}if(t.PRODUCT.RCM_ID){this.product.rcmId=t.PRODUCT.RCM_ID}this.canBuy=this.product.canBuy;this.product.name=t.PRODUCT.NAME;this.product.pict=t.PRODUCT.PICT;this.product.id=t.PRODUCT.ID;this.product.DETAIL_PAGE_URL=t.PRODUCT.DETAIL_PAGE_URL;if(t.PRODUCT.ADD_URL){this.product.addUrl=t.PRODUCT.ADD_URL}if(t.PRODUCT.BUY_URL){this.product.buyUrl=t.PRODUCT.BUY_URL}if(t.BASKET&&typeof t.BASKET==="object"){this.basketData.useProps=t.BASKET.ADD_PROPS;this.basketData.emptyProps=t.BASKET.EMPTY_PROPS}}else{this.errorCode=-1}break;case 3:if(t.PRODUCT&&typeof t.PRODUCT==="object"){this.product.name=t.PRODUCT.NAME;this.product.id=t.PRODUCT.ID;this.product.DETAIL_PAGE_URL=t.PRODUCT.DETAIL_PAGE_URL;this.product.morePhotoCount=t.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=t.PRODUCT.MORE_PHOTO;if(t.PRODUCT.RCM_ID){this.product.rcmId=t.PRODUCT.RCM_ID}}if(t.OFFERS&&BX.type.isArray(t.OFFERS)){this.offers=t.OFFERS;this.offerNum=0;if(t.OFFER_SELECTED){this.offerNum=parseInt(t.OFFER_SELECTED,10)}if(isNaN(this.offerNum)){this.offerNum=0}if(t.TREE_PROPS){this.treeProps=t.TREE_PROPS}if(t.DEFAULT_PICTURE){this.defaultPict.pict=t.DEFAULT_PICTURE.PICTURE;this.defaultPict.secondPict=t.DEFAULT_PICTURE.PICTURE_SECOND}}break;default:this.errorCode=-1}if(t.BASKET&&typeof t.BASKET==="object"){if(t.BASKET.QUANTITY){this.basketData.quantity=t.BASKET.QUANTITY}if(t.BASKET.PROPS){this.basketData.props=t.BASKET.PROPS}if(t.BASKET.BASKET_URL){this.basketData.basketUrl=t.BASKET.BASKET_URL}if(3===this.productType){if(t.BASKET.SKU_PROPS){this.basketData.sku_props=t.BASKET.SKU_PROPS}}if(t.BASKET.ADD_URL_TEMPLATE){this.basketData.add_url=t.BASKET.ADD_URL_TEMPLATE}if(t.BASKET.BUY_URL_TEMPLATE){this.basketData.buy_url=t.BASKET.BUY_URL_TEMPLATE}if(this.basketData.add_url===""&&this.basketData.buy_url===""){this.errorCode=-1024}}if(this.useCompare){if(t.COMPARE&&typeof t.COMPARE==="object"){if(t.COMPARE.COMPARE_PATH){this.compareData.comparePath=t.COMPARE.COMPARE_PATH}if(t.COMPARE.COMPARE_URL_TEMPLATE){this.compareData.compareUrl=t.COMPARE.COMPARE_URL_TEMPLATE}else{this.useCompare=false}if(t.COMPARE.COMPARE_DELETE_URL_TEMPLATE){this.compareData.compareDeleteUrl=t.COMPARE.COMPARE_DELETE_URL_TEMPLATE}else{this.useCompare=false}}else{this.useCompare=false}}}if(this.errorCode===0){BX.ready(BX.delegate(this.init,this))}};u.JCCatalogItem.prototype={init:function(){var t=0,i=null;this.obProduct=BX(this.visual.ID);if(!this.obProduct){this.errorCode=-1}this.obPict=BX(this.visual.PICT_ID);if(!this.obPict){this.errorCode=-2}if(this.secondPict&&this.visual.SECOND_PICT_ID){this.obSecondPict=BX(this.visual.SECOND_PICT_ID)}this.obPictSlider=BX(this.visual.PICT_SLIDER_ID);this.obPictSliderIndicator=BX(this.visual.PICT_SLIDER_ID+"_indicator");this.obPictSliderProgressBar=BX(this.visual.PICT_SLIDER_ID+"_progress_bar");if(!this.obPictSlider){this.errorCode=-4}this.obPrice=BX(this.visual.PRICE_ID);this.obPriceOld=BX(this.visual.PRICE_OLD_ID);this.obPriceTotal=BX(this.visual.PRICE_TOTAL_ID);if(!this.obPrice){this.errorCode=-16}if(this.showQuantity&&this.visual.QUANTITY_ID){this.obQuantity=BX(this.visual.QUANTITY_ID);this.blockNodes.quantity=this.obProduct.querySelector('[data-entity="quantity-block"]');if(!this.isTouchDevice){BX.bind(this.obQuantity,"focus",BX.proxy(this.onFocus,this));BX.bind(this.obQuantity,"blur",BX.proxy(this.onBlur,this))}if(this.visual.QUANTITY_UP_ID){this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)}if(this.visual.QUANTITY_DOWN_ID){this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID)}}if(this.visual.QUANTITY_LIMIT&&this.showMaxQuantity!=="N"){this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT);if(this.obQuantityLimit.all){this.obQuantityLimit.value=this.obQuantityLimit.all.querySelector('[data-entity="quantity-limit-value"]');if(!this.obQuantityLimit.value){this.obQuantityLimit.all=null}}}if(this.productType===3&&this.fullDisplayMode){if(this.visual.TREE_ID){this.obTree=BX(this.visual.TREE_ID);if(!this.obTree){this.errorCode=-256}}if(this.visual.QUANTITY_MEASURE){this.obMeasure=BX(this.visual.QUANTITY_MEASURE)}}this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID);if(this.obBasketActions){if(this.visual.BUY_ID){this.obBuyBtn=BX(this.visual.BUY_ID)}}this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS);if(this.showSubscription){this.obSubscribe=BX(this.visual.SUBSCRIBE_ID)}if(this.showPercent){if(this.visual.DSC_PERC){this.obDscPerc=BX(this.visual.DSC_PERC)}if(this.secondPict&&this.visual.SECOND_DSC_PERC){this.obSecondDscPerc=BX(this.visual.SECOND_DSC_PERC)}}if(this.showSkuProps){if(this.visual.DISPLAY_PROP_DIV){this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)}}if(this.errorCode===0){if(this.isTouchDevice){BX.bind(this.obPictSlider,"touchstart",BX.proxy(this.touchStartEvent,this));BX.bind(this.obPictSlider,"touchend",BX.proxy(this.touchEndEvent,this));BX.bind(this.obPictSlider,"touchcancel",BX.proxy(this.touchEndEvent,this))}else{if(this.viewMode==="CARD"){BX.bind(this.obProduct,"mouseenter",BX.proxy(this.hoverOn,this));BX.bind(this.obProduct,"mouseleave",BX.proxy(this.hoverOff,this))}BX.bind(this.obProduct,"mouseenter",BX.proxy(this.cycleSlider,this));BX.bind(this.obProduct,"mouseleave",BX.proxy(this.stopSlider,this))}if(this.bigData){var e=BX.findChildren(this.obProduct,{tag:"a"},true);if(e){for(t in e){if(e.hasOwnProperty(t)){if(e[t].getAttribute("href")==this.product.DETAIL_PAGE_URL){BX.bind(e[t],"click",BX.proxy(this.rememberProductRecommendation,this))}}}}}if(this.showQuantity){var s=this.isTouchDevice?"touchstart":"mousedown";var r=this.isTouchDevice?"touchend":"mouseup";if(this.obQuantityUp){BX.bind(this.obQuantityUp,s,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityUp,r,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"click",BX.delegate(this.quantityUp,this))}if(this.obQuantityDown){BX.bind(this.obQuantityDown,s,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityDown,r,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"click",BX.delegate(this.quantityDown,this))}if(this.obQuantity){BX.bind(this.obQuantity,"change",BX.delegate(this.quantityChange,this))}}switch(this.productType){case 0:case 1:case 2:if(parseInt(this.product.morePhotoCount)>1&&this.obPictSlider){this.initializeSlider()}this.checkQuantityControls();break;case 3:if(this.offers.length>0){i=BX.findChildren(this.obTree,{tagName:"li"},true);if(i&&i.length){for(t=0;t<i.length;t++){BX.bind(i[t],"click",BX.delegate(this.selectOfferProp,this))}}this.setCurrent()}else if(parseInt(this.product.morePhotoCount)>1&&this.obPictSlider){this.initializeSlider()}break}if(this.obBuyBtn){if(this.basketAction==="ADD"){BX.bind(this.obBuyBtn,"click",BX.proxy(this.add2Basket,this))}else{BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this))}}if(this.useCompare){this.obCompare=BX(this.visual.COMPARE_LINK_ID);if(this.obCompare){BX.bind(this.obCompare,"click",BX.proxy(this.compare,this))}BX.addCustomEvent("onCatalogDeleteCompare",BX.proxy(this.checkDeletedCompare,this))}}},setAnalyticsDataLayer:function(t){if(!this.useEnhancedEcommerce||!this.dataLayerName)return;var i={},e={},s=[],r,a,o,h,n,l;switch(this.productType){case 0:case 1:case 2:i={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty};break;case 3:for(r in this.offers[this.offerNum].TREE){if(this.offers[this.offerNum].TREE.hasOwnProperty(r)){h=r.substring(5);n=this.offers[this.offerNum].TREE[r];for(a in this.treeProps){if(this.treeProps.hasOwnProperty(a)&&this.treeProps[a].ID==h){for(o in this.treeProps[a].VALUES){l=this.treeProps[a].VALUES[o];if(l.ID==n){s.push(l.NAME);break}}}}}}i={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty,variant:s.join("/")};break}switch(t){case"addToCart":e={event:"addToCart",ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:i.name||"",id:i.id||"",price:i.price||0,brand:i.brand||"",category:i.category||"",variant:i.variant||"",quantity:this.showQuantity&&this.obQuantity?this.obQuantity.value:1}]}}};break}u[this.dataLayerName]=u[this.dataLayerName]||[];u[this.dataLayerName].push(e)},hoverOn:function(t){clearTimeout(this.hoverTimer);this.obProduct.style.height=getComputedStyle(this.obProduct).height;BX.addClass(this.obProduct,"hover");BX.PreventDefault(t)},hoverOff:function(t){if(this.hoverStateChangeForbidden)return;BX.removeClass(this.obProduct,"hover");this.hoverTimer=setTimeout(BX.delegate(function(){this.obProduct.style.height="auto"},this),300);BX.PreventDefault(t)},onFocus:function(){this.hoverStateChangeForbidden=true;BX.bind(document,"mousemove",BX.proxy(this.captureMousePosition,this))},onBlur:function(){this.hoverStateChangeForbidden=false;BX.unbind(document,"mousemove",BX.proxy(this.captureMousePosition,this));var t=document.elementFromPoint(this.mouseX,this.mouseY);if(!t||!this.obProduct.contains(t)){this.hoverOff()}},captureMousePosition:function(t){this.mouseX=t.clientX;this.mouseY=t.clientY},getCookie:function(t){var i=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return i?decodeURIComponent(i[1]):null},rememberProductRecommendation:function(){var t=BX.cookie_prefix+"_RCM_PRODUCT_LOG",i=this.getCookie(t),e=false;var s=[],r;if(i){s=i.split(".")}var a=s.length;while(a--){r=s[a].split("-");if(r[0]==this.product.id){r=s[a].split("-");r[1]=this.product.rcmId;r[2]=BX.current_server_time;s[a]=r.join("-");e=true}else{if(BX.current_server_time-r[2]>3600*24*30){s.splice(a,1)}}}if(!e){s.push([this.product.id,this.product.rcmId,BX.current_server_time].join("-"))}var o=s.join("."),h=new Date((new Date).getTime()+1e3*3600*24*365*10).toUTCString();document.cookie=t+"="+o+"; path=/; expires="+h+"; domain="+BX.cookie_domain},startQuantityInterval:function(){var t=BX.proxy_context;var i=t.id===this.visual.QUANTITY_DOWN_ID?BX.proxy(this.quantityDown,this):BX.proxy(this.quantityUp,this);this.quantityDelay=setTimeout(BX.delegate(function(){this.quantityTimer=setInterval(i,150)},this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay);clearInterval(this.quantityTimer)},quantityUp:function(){var t=0,i=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(t)){t+=this.stepQuantity;if(this.checkQuantity){if(t>this.maxQuantity){i=false}}if(i){if(this.isDblQuantity){t=Math.round(t*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=t;this.setPrice()}}}},quantityDown:function(){var t=0,i=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(t)){t-=this.stepQuantity;this.checkPriceRange(t);if(t<this.minQuantity){i=false}if(i){if(this.isDblQuantity){t=Math.round(t*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=t;this.setPrice()}}}},quantityChange:function(){var t=0,i;if(this.errorCode===0&&this.showQuantity){if(this.canBuy){t=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value);if(!isNaN(t)){if(this.checkQuantity){if(t>this.maxQuantity){t=this.maxQuantity}}this.checkPriceRange(t);i=Math.floor(Math.round(t*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1;t=i<=1?this.stepQuantity:i*this.stepQuantity;t=Math.round(t*this.precisionFactor)/this.precisionFactor;if(t<this.minQuantity){t=this.minQuantity}this.obQuantity.value=t}else{this.obQuantity.value=this.minQuantity}}else{this.obQuantity.value=this.minQuantity}this.setPrice()}},quantitySet:function(t){var i,e;var s=this.offers[t],r=this.offers[this.offerNum];if(this.errorCode===0){this.canBuy=s.CAN_BUY;this.currentPriceMode=s.ITEM_PRICE_MODE;this.currentPrices=s.ITEM_PRICES;this.currentPriceSelected=s.ITEM_PRICE_SELECTED;this.currentQuantityRanges=s.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=s.ITEM_QUANTITY_RANGE_SELECTED;if(this.canBuy){if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","none")}if(this.obSubscribe){BX.style(this.obSubscribe,"display","none")}}else{if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","none")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","none")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","")}if(this.obSubscribe){if(s.CATALOG_SUBSCRIBE==="Y"){BX.style(this.obSubscribe,"display","");this.obSubscribe.setAttribute("data-item",s.ID);BX(this.visual.SUBSCRIBE_ID+"_hidden").click()}else{BX.style(this.obSubscribe,"display","none")}}}this.isDblQuantity=s.QUANTITY_FLOAT;this.checkQuantity=s.CHECK_QUANTITY;if(this.isDblQuantity){this.stepQuantity=Math.round(parseFloat(s.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor;this.maxQuantity=parseFloat(s.MAX_QUANTITY);this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}else{this.stepQuantity=parseInt(s.STEP_QUANTITY,10);this.maxQuantity=parseInt(s.MAX_QUANTITY,10);this.minQuantity=this.currentPriceMode==="Q"?parseInt(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}if(this.showQuantity){var a=r.ITEM_PRICES.length&&r.ITEM_PRICES[r.ITEM_PRICE_SELECTED]&&r.ITEM_PRICES[r.ITEM_PRICE_SELECTED].MIN_QUANTITY!=this.minQuantity;if(this.isDblQuantity){i=Math.round(parseFloat(r.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor!==this.stepQuantity||a||r.MEASURE!==s.MEASURE||this.checkQuantity&&parseFloat(r.MAX_QUANTITY)>this.maxQuantity&&parseFloat(this.obQuantity.value)>this.maxQuantity}else{i=parseInt(r.STEP_QUANTITY,10)!==this.stepQuantity||a||r.MEASURE!==s.MEASURE||this.checkQuantity&&parseInt(r.MAX_QUANTITY,10)>this.maxQuantity&&parseInt(this.obQuantity.value,10)>this.maxQuantity}this.obQuantity.disabled=!this.canBuy;if(i){this.obQuantity.value=this.minQuantity}if(this.obMeasure){if(s.MEASURE){BX.adjust(this.obMeasure,{html:s.MEASURE})}else{BX.adjust(this.obMeasure,{html:""})}}}if(this.obQuantityLimit.all){if(!this.checkQuantity||this.maxQuantity==0){BX.adjust(this.obQuantityLimit.value,{html:""});BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}})}else{if(this.showMaxQuantity==="M"){e=this.maxQuantity/this.stepQuantity>=this.relativeQuantityFactor?BX.message("RELATIVE_QUANTITY_MANY"):BX.message("RELATIVE_QUANTITY_FEW")}else{e=this.maxQuantity;if(s.MEASURE){e+=" "+s.MEASURE}}BX.adjust(this.obQuantityLimit.value,{html:e});BX.adjust(this.obQuantityLimit.all,{style:{display:""}})}}}},initializeSlider:function(){var t=this.obPictSlider.getAttribute("data-slider-wrap");if(t){this.slider.options.wrap=t==="true"}else{this.slider.options.wrap=this.defaultSliderOptions.wrap}if(this.isTouchDevice){this.slider.options.interval=false}else{this.slider.options.interval=parseInt(this.obPictSlider.getAttribute("data-slider-interval"))||this.defaultSliderOptions.interval;if(this.slider.options.interval<700){this.slider.options.interval=700}if(this.obPictSliderIndicator){var i=this.obPictSliderIndicator.querySelectorAll("[data-go-to]");for(var e in i){if(i.hasOwnProperty(e)){BX.bind(i[e],"click",BX.proxy(this.sliderClickHandler,this))}}}if(this.obPictSliderProgressBar){if(this.slider.progress){this.resetProgress();this.cycleSlider()}else{this.slider.progress=new BX.easing({transition:BX.easing.transitions.linear,step:BX.delegate(function(t){this.obPictSliderProgressBar.style.width=t.width/10+"%"},this)})}}}},checkTouch:function(t){if(!t||!t.changedTouches)return false;return t.changedTouches[0].identifier===this.touch.identifier},touchStartEvent:function(t){if(t.touches.length!=1)return;this.touch=t.changedTouches[0]},touchEndEvent:function(t){if(!this.checkTouch(t))return;var i=this.touch.pageX-t.changedTouches[0].pageX,e=this.touch.pageY-t.changedTouches[0].pageY;if(Math.abs(i)>=Math.abs(e)+10){if(i>0){this.slideNext()}if(i<0){this.slidePrev()}}},sliderClickHandler:function(t){var i=BX.getEventTarget(t),e=i.getAttribute("data-go-to");if(e){this.slideTo(e)}BX.PreventDefault(t)},slideNext:function(){if(this.slider.sliding)return;return this.slide("next")},slidePrev:function(){if(this.slider.sliding)return;return this.slide("prev")},slideTo:function(t){this.slider.active=BX.findChild(this.obPictSlider,{className:"item active"},true,false);this.slider.progress&&(this.slider.interval=true);var i=this.getItemIndex(this.slider.active);if(t>this.slider.items.length-1||t<0)return;if(this.slider.sliding)return false;if(i==t){this.stopSlider();this.cycleSlider();return}return this.slide(t>i?"next":"prev",this.eq(this.slider.items,t))},slide:function(t,i){var e=BX.findChild(this.obPictSlider,{className:"item active"},true,false),s=this.slider.interval,r=t==="next"?"left":"right";i=i||this.getItemForDirection(t,e);if(BX.hasClass(i,"active")){return this.slider.sliding=false}this.slider.sliding=true;s&&this.stopSlider();if(this.obPictSliderIndicator){BX.removeClass(this.obPictSliderIndicator.querySelector(".active"),"active");var a=this.obPictSliderIndicator.querySelectorAll("[data-go-to]")[this.getItemIndex(i)];a&&BX.addClass(a,"active")}if(BX.hasClass(this.obPictSlider,"slide")&&!BX.browser.IsIE()){var o=this;BX.addClass(i,t);i.offsetWidth;BX.addClass(e,r);BX.addClass(i,r);setTimeout(function(){BX.addClass(i,"active");BX.removeClass(e,"active");BX.removeClass(e,r);BX.removeClass(i,t);BX.removeClass(i,r);o.slider.sliding=false},700)}else{BX.addClass(i,"active");this.slider.sliding=false}this.obPictSliderProgressBar&&this.resetProgress();s&&this.cycleSlider()},stopSlider:function(t){t||(this.slider.paused=true);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.progress){this.slider.progress.stop();var i=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*i/200;this.slider.progress.options.start={width:i*10};this.slider.progress.options.finish={width:0};this.slider.progress.options.complete=null;this.slider.progress.animate()}},cycleSlider:function(t){t||(this.slider.paused=false);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.options.interval&&!this.slider.paused){if(this.slider.progress){this.slider.progress.stop();var i=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*(100-i)/100;this.slider.progress.options.start={width:i*10};this.slider.progress.options.finish={width:1e3};this.slider.progress.options.complete=BX.delegate(function(){this.slider.interval=true;this.slideNext()},this);this.slider.progress.animate()}else{this.slider.interval=setInterval(BX.proxy(this.slideNext,this),this.slider.options.interval)}}},resetProgress:function(){this.slider.progress&&this.slider.progress.stop();this.obPictSliderProgressBar.style.width=0},getItemForDirection:function(t,i){var e=this.getItemIndex(i),s=t==="prev"&&e===0||t==="next"&&e==this.slider.items.length-1;if(s&&!this.slider.options.wrap)return i;var r=t==="prev"?-1:1,a=(e+r)%this.slider.items.length;return this.eq(this.slider.items,a)},getItemIndex:function(t){this.slider.items=BX.findChildren(t.parentNode,{className:"item"},true);return this.slider.items.indexOf(t||this.slider.active)},eq:function(t,i){var e=t.length,s=+i+(i<0?e:0);return s>=0&&s<e?t[s]:{}},selectOfferProp:function(){var t=0,i="",e="",s=[],r=null,a=BX.proxy_context;if(a&&a.hasAttribute("data-treevalue")){if(BX.hasClass(a,"selected"))return;e=a.getAttribute("data-treevalue");s=e.split("_");if(this.searchOfferPropIndex(s[0],s[1])){r=BX.findChildren(a.parentNode,{tagName:"li"},false);if(r&&0<r.length){for(t=0;t<r.length;t++){i=r[t].getAttribute("data-onevalue");if(i===s[1]){BX.addClass(r[t],"selected")}else{BX.removeClass(r[t],"selected")}}}}}},searchOfferPropIndex:function(t,i){var e="",s=false,r,a,o=[],h=[],n=-1,l={},u=[];for(r=0;r<this.treeProps.length;r++){if(this.treeProps[r].ID===t){n=r;break}}if(-1<n){for(r=0;r<n;r++){e="PROP_"+this.treeProps[r].ID;l[e]=this.selectedValues[e]}e="PROP_"+this.treeProps[n].ID;s=this.getRowValues(l,e);if(!s){return false}if(!BX.util.in_array(i,s)){return false}l[e]=i;for(r=n+1;r<this.treeProps.length;r++){e="PROP_"+this.treeProps[r].ID;s=this.getRowValues(l,e);if(!s){return false}h=[];if(this.showAbsent){o=[];u=[];u=BX.clone(l,true);for(a=0;a<s.length;a++){u[e]=s[a];h[h.length]=s[a];if(this.getCanBuy(u))o[o.length]=s[a]}}else{o=s}if(this.selectedValues[e]&&BX.util.in_array(this.selectedValues[e],o)){l[e]=this.selectedValues[e]}else{if(this.showAbsent)l[e]=o.length>0?o[0]:h[0];else l[e]=o[0]}this.updateRow(r,l[e],s,o)}this.selectedValues=l;this.changeInfo()}return true},updateRow:function(t,i,e,s){var r=0,a="",o=false,h=null;var n=this.obTree.querySelectorAll('[data-entity="sku-line-block"]'),l;if(t>-1&&t<n.length){l=n[t].querySelector("ul");h=BX.findChildren(l,{tagName:"li"},false);if(h&&0<h.length){for(r=0;r<h.length;r++){a=h[r].getAttribute("data-onevalue");o=a===i;if(o){BX.addClass(h[r],"selected")}else{BX.removeClass(h[r],"selected")}if(BX.util.in_array(a,s)){BX.removeClass(h[r],"notallowed")}else{BX.addClass(h[r],"notallowed")}h[r].style.display=BX.util.in_array(a,e)?"":"none";if(o){n[t].style.display=a==0&&s.length==1?"none":""}}}}},getRowValues:function(t,i){var e=0,s,r=[],a=false,o=true;if(0===t.length){for(e=0;e<this.offers.length;e++){if(!BX.util.in_array(this.offers[e].TREE[i],r)){r[r.length]=this.offers[e].TREE[i]}}a=true}else{for(e=0;e<this.offers.length;e++){o=true;for(s in t){if(t[s]!==this.offers[e].TREE[s]){o=false;break}}if(o){if(!BX.util.in_array(this.offers[e].TREE[i],r)){r[r.length]=this.offers[e].TREE[i]}a=true}}}return a?r:false},getCanBuy:function(t){var i,e,s=false,r=true;for(i=0;i<this.offers.length;i++){r=true;for(e in t){if(t[e]!==this.offers[i].TREE[e]){r=false;break}}if(r){if(this.offers[i].CAN_BUY){s=true;break}}}return s},setCurrent:function(){var t,i=0,e=[],s="",r=false,a={},o=[],h=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length;t++){s="PROP_"+this.treeProps[t].ID;r=this.getRowValues(a,s);if(!r){break}if(BX.util.in_array(h[s],r)){a[s]=h[s]}else{a[s]=r[0];this.offerNum=0}if(this.showAbsent){e=[];o=[];o=BX.clone(a,true);for(i=0;i<r.length;i++){o[s]=r[i];if(this.getCanBuy(o)){e[e.length]=r[i]}}}else{e=r}this.updateRow(t,a[s],r,e)}this.selectedValues=a;this.changeInfo()},changeInfo:function(){var t,i,e=-1,s=true,r;for(t=0;t<this.offers.length;t++){s=true;for(i in this.selectedValues){if(this.selectedValues[i]!==this.offers[t].TREE[i]){s=false;break}}if(s){e=t;break}}if(e>-1){if(parseInt(this.offers[e].MORE_PHOTO_COUNT)>1&&this.obPictSlider){if(this.obPict){this.obPict.style.display="none"}if(this.obSecondPict){this.obSecondPict.style.display="none"}BX.cleanNode(this.obPictSlider);for(t in this.offers[e].MORE_PHOTO){if(this.offers[e].MORE_PHOTO.hasOwnProperty(t)){this.obPictSlider.appendChild(BX.create("SPAN",{props:{className:"product-item-image-slide item"+(t==0?" active":"")},style:{backgroundImage:"url('"+this.offers[e].MORE_PHOTO[t].SRC+"')"}}))}}if(this.obPictSliderIndicator){BX.cleanNode(this.obPictSliderIndicator);for(t in this.offers[e].MORE_PHOTO){if(this.offers[e].MORE_PHOTO.hasOwnProperty(t)){this.obPictSliderIndicator.appendChild(BX.create("DIV",{attrs:{"data-go-to":t},props:{className:"product-item-image-slider-control"+(t==0?" active":"")}}));this.obPictSliderIndicator.appendChild(document.createTextNode(" "))}}this.obPictSliderIndicator.style.display=""}if(this.obPictSliderProgressBar){this.obPictSliderProgressBar.style.display=""}this.obPictSlider.style.display="";this.initializeSlider()}else{if(this.obPictSlider){this.obPictSlider.style.display="none"}if(this.obPictSliderIndicator){this.obPictSliderIndicator.style.display="none"}if(this.obPictSliderProgressBar){this.obPictSliderProgressBar.style.display="none"}if(this.obPict){if(this.offers[e].PREVIEW_PICTURE){BX.adjust(this.obPict,{style:{backgroundImage:"url('"+this.offers[e].PREVIEW_PICTURE.SRC+"')"}})}else{BX.adjust(this.obPict,{style:{backgroundImage:"url('"+this.defaultPict.pict.SRC+"')"}})}this.obPict.style.display=""}if(this.secondPict&&this.obSecondPict){if(this.offers[e].PREVIEW_PICTURE_SECOND){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.offers[e].PREVIEW_PICTURE_SECOND.SRC+"')"}})}else if(this.offers[e].PREVIEW_PICTURE.SRC){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.offers[e].PREVIEW_PICTURE.SRC+"')"}})}else if(this.defaultPict.secondPict){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.defaultPict.secondPict.SRC+"')"}})}else{BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.defaultPict.pict.SRC+"')"}})}this.obSecondPict.style.display=""}}if(this.showSkuProps&&this.obSkuProps){if(this.offers[e].DISPLAY_PROPERTIES.length){BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[e].DISPLAY_PROPERTIES})}else{BX.adjust(this.obSkuProps,{style:{display:"none"},html:""})}}this.quantitySet(e);this.setPrice();this.setCompared(this.offers[e].COMPARED);this.offerNum=e}},checkPriceRange:function(t){if(typeof t==="undefined"||this.currentPriceMode!="Q")return;var i,e=false;for(var s in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(s)){i=this.currentQuantityRanges[s];if(parseInt(t)>=parseInt(i.SORT_FROM)&&(i.SORT_TO=="INF"||parseInt(t)<=parseInt(i.SORT_TO))){e=true;this.currentQuantityRangeSelected=i.HASH;break}}}if(!e&&(i=this.getMinPriceRange())){this.currentQuantityRangeSelected=i.HASH}for(var r in this.currentPrices){if(this.currentPrices.hasOwnProperty(r)){if(this.currentPrices[r].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=r;break}}}},getMinPriceRange:function(){var t;for(var i in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(i)){if(!t||parseInt(this.currentQuantityRanges[i].SORT_FROM)<parseInt(t.SORT_FROM)){t=this.currentQuantityRanges[i]}}}return t},checkQuantityControls:function(){if(!this.obQuantity)return;var t=this.checkQuantity&&parseFloat(this.obQuantity.value)+this.stepQuantity>this.maxQuantity,i=parseFloat(this.obQuantity.value)-this.stepQuantity<this.minQuantity;if(t){BX.addClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}else if(BX.hasClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}if(i){BX.addClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}else if(BX.hasClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}if(t&&i){this.obQuantity.setAttribute("disabled","disabled")}else{this.obQuantity.removeAttribute("disabled")}},setPrice:function(){var t,i;if(this.obQuantity){this.checkPriceRange(this.obQuantity.value)}this.checkQuantityControls();i=this.currentPrices[this.currentPriceSelected];if(this.obPrice){if(i){BX.adjust(this.obPrice,{html:BX.Currency.currencyFormat(i.RATIO_PRICE,i.CURRENCY,true)})}else{BX.adjust(this.obPrice,{html:""})}if(this.showOldPrice&&this.obPriceOld){if(i&&i.RATIO_PRICE!==i.RATIO_BASE_PRICE){BX.adjust(this.obPriceOld,{style:{display:""},html:BX.Currency.currencyFormat(i.RATIO_BASE_PRICE,i.CURRENCY,true)})}else{BX.adjust(this.obPriceOld,{style:{display:"none"},html:""})}}if(this.obPriceTotal){if(i&&this.obQuantity&&this.obQuantity.value!=this.stepQuantity){BX.adjust(this.obPriceTotal,{html:BX.message("PRICE_TOTAL_PREFIX")+" <strong>"+BX.Currency.currencyFormat(i.PRICE*this.obQuantity.value,i.CURRENCY,true)+"</strong>",style:{display:""}})}else{BX.adjust(this.obPriceTotal,{html:"",style:{display:"none"}})}}if(this.showPercent){if(i&&parseInt(i.DISCOUNT)>0){t={style:{display:""},html:-i.PERCENT+"%"}}else{t={style:{display:"none"},html:""}}if(this.obDscPerc){BX.adjust(this.obDscPerc,t)}if(this.obSecondDscPerc){BX.adjust(this.obSecondDscPerc,t)}}}},compare:function(t){var i=this.obCompare.querySelector('[data-entity="compare-checkbox"]'),e=BX.getEventTarget(t),s=true;if(i){s=e===i?i.checked:!i.checked}var r=s?this.compareData.compareUrl:this.compareData.compareDeleteUrl,a;if(r){if(e!==i){BX.PreventDefault(t);this.setCompared(s)}switch(this.productType){case 0:case 1:case 2:a=r.replace("#ID#",this.product.id.toString());break;case 3:a=r.replace("#ID#",this.offers[this.offerNum].ID);break}BX.ajax({method:"POST",dataType:s?"json":"html",url:a+(a.indexOf("?")!==-1?"&":"?")+"ajax_action=Y",onsuccess:s?BX.proxy(this.compareResult,this):BX.proxy(this.compareDeleteResult,this)})}},compareResult:function(t){var i,e;if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(t))return;this.initPopupWindow();if(this.offers.length>0){this.offers[this.offerNum].COMPARED=t.STATUS==="OK"}if(t.STATUS==="OK"){BX.onCustomEvent("OnCompareChange");i='<div style="width: 100%; margin: 0; text-align: center;"><p>'+BX.message("COMPARE_MESSAGE_OK")+"</p></div>";if(this.showClosePopup){e=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{e=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)}})]}}else{i='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(t.MESSAGE?t.MESSAGE:BX.message("COMPARE_UNKNOWN_ERROR"))+"</p></div>";e=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(BX.message("COMPARE_TITLE"));this.obPopupWin.setContent(i);this.obPopupWin.setButtons(e);this.obPopupWin.show()},compareDeleteResult:function(){BX.onCustomEvent("OnCompareChange");if(this.offers&&this.offers.length){this.offers[this.offerNum].COMPARED=false}},setCompared:function(t){if(!this.obCompare)return;var i=this.obCompare.querySelector('[data-entity="compare-checkbox"]');if(i){i.checked=t}},setCompareInfo:function(t){if(!BX.type.isArray(t))return;for(var i in this.offers){if(this.offers.hasOwnProperty(i)){this.offers[i].COMPARED=BX.util.in_array(this.offers[i].ID,t)}}},compareRedirect:function(){if(this.compareData.comparePath){location.href=this.compareData.comparePath}else{this.obPopupWin.close()}},checkDeletedCompare:function(t){switch(this.productType){case 0:case 1:case 2:if(this.product.id==t){this.setCompared(false)}break;case 3:var i=this.offers.length;while(i--){if(this.offers[i].ID==t){this.offers[i].COMPARED=false;if(this.offerNum==i){this.setCompared(false)}break}}}},initBasketUrl:function(){this.basketUrl=this.basketMode==="ADD"?this.basketData.add_url:this.basketData.buy_url;switch(this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID);break}this.basketParams={ajax_basket:"Y"};if(this.showQuantity){this.basketParams[this.basketData.quantity]=this.obQuantity.value}if(this.basketData.sku_props){this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props}},fillBasketProps:function(){if(!this.visual.BASKET_PROP_DIV){return}var t=0,i=null,e=false,s=null;if(this.basketData.useProps&&!this.basketData.emptyProps){if(this.obPopupWin&&this.obPopupWin.contentContainer){s=this.obPopupWin.contentContainer}}else{s=BX(this.visual.BASKET_PROP_DIV)}if(s){i=s.getElementsByTagName("select");if(i&&i.length){for(t=0;t<i.length;t++){if(!i[t].disabled){switch(i[t].type.toLowerCase()){case"select-one":this.basketParams[i[t].name]=i[t].value;e=true;break;default:break}}}}i=s.getElementsByTagName("input");if(i&&i.length){for(t=0;t<i.length;t++){if(!i[t].disabled){switch(i[t].type.toLowerCase()){case"hidden":this.basketParams[i[t].name]=i[t].value;e=true;break;case"radio":if(i[t].checked){this.basketParams[i[t].name]=i[t].value;e=true}break;default:break}}}}}if(!e){this.basketParams[this.basketData.props]=[];this.basketParams[this.basketData.props][0]=0}},add2Basket:function(){this.basketMode="ADD";this.basket()},buyBasket:function(){this.basketMode="BUY";this.basket()},sendToBasket:function(){if(!this.canBuy){return}if(this.product&&this.product.id&&this.bigData){this.rememberProductRecommendation()}this.initBasketUrl();this.fillBasketProps();BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)})},basket:function(){var t="";if(!this.canBuy){return}switch(this.productType){case 1:case 2:if(this.basketData.useProps&&!this.basketData.emptyProps){this.initPopupWindow();this.obPopupWin.setTitleBar(BX.message("TITLE_BASKET_PROPS"));if(BX(this.visual.BASKET_PROP_DIV)){t=BX(this.visual.BASKET_PROP_DIV).innerHTML}this.obPopupWin.setContent(t);this.obPopupWin.setButtons([new a({text:BX.message("BTN_MESSAGE_SEND_PROPS"),events:{click:BX.delegate(this.sendToBasket,this)}})]);this.obPopupWin.show()}else{this.sendToBasket()}break;case 3:this.sendToBasket();break}},basketResult:function(t){var i="",e="",s,r=[];if(this.obPopupWin)this.obPopupWin.close();if(!BX.type.isPlainObject(t))return;s=t.STATUS==="OK";if(s){this.setAnalyticsDataLayer("addToCart")}if(s&&this.basketAction==="BUY"){this.basketRedirect()}else{this.initPopupWindow();if(s){BX.onCustomEvent("OnBasketChange");if(BX.findParent(this.obProduct,{className:"bx_sale_gift_main_products"},10)){BX.onCustomEvent("onAddToBasketMainProduct",[this])}switch(this.productType){case 1:case 2:e=this.product.pict.SRC;break;case 3:e=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC;break}i='<div style="width: 100%; margin: 0; text-align: center;"><img src="'+e+'" height="130" style="max-height:130px"><p>'+this.product.name+"</p></div>";if(this.showClosePopup){r=[new a({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{r=[new a({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)}})]}}else{i='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(t.MESSAGE?t.MESSAGE:BX.message("BASKET_UNKNOWN_ERROR"))+"</p></div>";r=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(s?BX.message("TITLE_SUCCESSFUL"):BX.message("TITLE_ERROR"));this.obPopupWin.setContent(i);this.obPopupWin.setButtons(r);this.obPopupWin.show()}},basketRedirect:function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},initPopupWindow:function(){if(this.obPopupWin)return;this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:true,offsetLeft:0,offsetTop:0,overlay:true,closeByEsc:true,titleBar:true,closeIcon:true,contentColor:"white",className:this.templateTheme?"bx-"+this.templateTheme:""})}}})(window);
/* Ammina JS file original /bitrix/templates/mostehnika/components/bitrix/catalog.compare.list/.default/script.js */
(function(t){if(!!t.JCCatalogCompareList){return}t.JCCatalogCompareList=function(t){this.obCompare=null;this.obAdminPanel=null;this.visual=t.VISUAL;this.visual.LIST=this.visual.ID+"_tbl";this.visual.ROW=this.visual.ID+"_row_";this.visual.COUNT=this.visual.ID+"_count";this.ajax=t.AJAX;this.position=t.POSITION;BX.ready(BX.proxy(this.init,this))};t.JCCatalogCompareList.prototype.init=function(){this.obCompare=BX(this.visual.ID);if(!!this.obCompare){BX.addCustomEvent(t,"OnCompareChange",BX.proxy(this.reload,this));BX.bindDelegate(this.obCompare,"click",{tagName:"a"},BX.proxy(this.deleteCompare,this));if(this.position.fixed&&this.position.align.vertical==="top"){this.obAdminPanel=BX("bx-panel");if(!!this.obAdminPanel){this.setVerticalAlign();BX.addCustomEvent(t,"onTopPanelCollapse",BX.proxy(this.setVerticalAlign,this))}}}};t.JCCatalogCompareList.prototype.reload=function(){BX.showWait(this.obCompare);BX.ajax.post(this.ajax.url,this.ajax.params,BX.proxy(this.reloadResult,this))};t.JCCatalogCompareList.prototype.reloadResult=function(t){BX.closeWait();this.obCompare.innerHTML=t;BX.style(this.obCompare,"display","block")};t.JCCatalogCompareList.prototype.deleteCompare=function(){var t=BX.proxy_context,i,a;if(!!t&&t.hasAttribute("data-id")){i=parseInt(t.getAttribute("data-id"),10);if(!isNaN(i)){BX.showWait(this.obCompare);a=this.ajax.url+this.ajax.templates.delete+i.toString();BX.ajax.loadJSON(a,this.ajax.params,BX.proxy(this.deleteCompareResult,this))}}};t.JCCatalogCompareList.prototype.deleteCompareResult=function(t){var i,a,o,e,s;BX.closeWait();if(typeof t==="object"){if(!!t.STATUS&&t.STATUS==="OK"&&!!t.ID){i=BX(this.visual.LIST);if(i){if(i.rows.length>1){o=this.visual.ROW+t.ID;for(a=0;a<i.rows.length;a++){if(i.rows[a].id===o){i.deleteRow(a)}}i=null;if(!!t.COUNT){s=parseInt(t.COUNT,10);if(!isNaN(s)){e=BX(this.visual.COUNT);if(!!e){e.innerHTML=s.toString();e=null}BX.style(this.obCompare,"display",s>0?"block":"none")}}}else{this.reload()}}}}};t.JCCatalogCompareList.prototype.setVerticalAlign=function(){var t;if(!!this.obCompare&&!!this.obAdminPanel){t=parseInt(this.obAdminPanel.offsetHeight,10);if(isNaN(t)){t=0}t+=5;BX.style(this.obCompare,"top",t.toString()+"px")}}})(window);